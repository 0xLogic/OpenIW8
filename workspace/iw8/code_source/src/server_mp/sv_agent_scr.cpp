/*
==============
ScrAgentCmd_RelinquishClaimedNode
==============
*/

void __fastcall ScrAgentCmd_RelinquishClaimedNode(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_RelinquishClaimedNode@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetGoalRadius
==============
*/

void __fastcall ScrAgentCmd_SetGoalRadius(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetGoalRadius@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_SetAgentBounds
==============
*/

void __fastcall AgentCmd_SetAgentBounds(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_SetAgentBounds@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_DoAnimRelative
==============
*/

void __fastcall ScrAgentCmd_DoAnimRelative(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_DoAnimRelative@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_AgentClearScriptVars
==============
*/

void __fastcall AgentCmd_AgentClearScriptVars(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_AgentClearScriptVars@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetMaxTurnSpeed
==============
*/

void __fastcall ScrAgentCmd_SetMaxTurnSpeed(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetMaxTurnSpeed@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_SetCorpseModel
==============
*/

void __fastcall AgentCmd_SetCorpseModel(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_SetCorpseModel@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_GetMaxTurnSpeed
==============
*/

void __fastcall ScrAgentCmd_GetMaxTurnSpeed(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_GetMaxTurnSpeed@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_DeSpawnAgent
==============
*/

void __fastcall AgentCmd_DeSpawnAgent(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_DeSpawnAgent@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_GetPathGoalPos
==============
*/

void __fastcall ScrAgentCmd_GetPathGoalPos(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_GetPathGoalPos@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_FinishAgentDamage
==============
*/

void __fastcall AgentCmd_FinishAgentDamage(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_FinishAgentDamage@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_CloneAgent
==============
*/

void __fastcall AgentCmd_CloneAgent(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_CloneAgent@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetPhysicsMode
==============
*/

void __fastcall ScrAgentCmd_SetPhysicsMode(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetPhysicsMode@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetOrientMode
==============
*/

void __fastcall ScrAgentCmd_SetOrientMode(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetOrientMode@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetUnitType
==============
*/

void __fastcall ScrAgentCmd_SetUnitType(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetUnitType@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_AgentCanSeeSentient
==============
*/

void __fastcall AgentCmd_AgentCanSeeSentient(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_AgentCanSeeSentient@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_GetGoalPos
==============
*/

void __fastcall ScrAgentCmd_GetGoalPos(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_GetGoalPos@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetWallRunCost
==============
*/

void __fastcall ScrAgentCmd_SetWallRunCost(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetWallRunCost@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetClipMode
==============
*/

void __fastcall ScrAgentCmd_SetClipMode(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetClipMode@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetScripted
==============
*/

void __fastcall ScrAgentCmd_SetScripted(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetScripted@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetAnimScale
==============
*/

void __fastcall ScrAgentCmd_SetAnimScale(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetAnimScale@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetGoalEntity
==============
*/

void __fastcall ScrAgentCmd_SetGoalEntity(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetGoalEntity@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_ClaimNode
==============
*/

void __fastcall ScrAgentCmd_ClaimNode(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_ClaimNode@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_SetAgentAttacker
==============
*/

void __fastcall AgentCmd_SetAgentAttacker(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_SetAgentAttacker@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_AgentSetClipMode
==============
*/

void __fastcall AgentCmd_AgentSetClipMode(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_AgentSetClipMode@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_BeginMelee
==============
*/

void __fastcall ScrAgentCmd_BeginMelee(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_BeginMelee@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetGoalPos
==============
*/

void __fastcall ScrAgentCmd_SetGoalPos(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetGoalPos@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetGoalNode
==============
*/

void __fastcall ScrAgentCmd_SetGoalNode(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetGoalNode@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetViewHeight
==============
*/

void __fastcall ScrAgentCmd_SetViewHeight(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetViewHeight@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_AgentSetFavoriteEnemy
==============
*/

void __fastcall AgentCmd_AgentSetFavoriteEnemy(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_AgentSetFavoriteEnemy@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_DoTrajectory
==============
*/

void __fastcall ScrAgentCmd_DoTrajectory(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_DoTrajectory@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_SetWaypoint
==============
*/

void __fastcall ScrAgentCmd_SetWaypoint(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetWaypoint@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_IsStuck
==============
*/

void __fastcall ScrAgentCmd_IsStuck(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_IsStuck@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_GetLookaheadDir
==============
*/

void __fastcall ScrAgentCmd_GetLookaheadDir(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_GetLookaheadDir@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_RequestStopSoonNotify
==============
*/

void __fastcall ScrAgentCmd_RequestStopSoonNotify(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_RequestStopSoonNotify@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_DoAnimLerp
==============
*/

void __fastcall ScrAgentCmd_DoAnimLerp(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_DoAnimLerp@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
ScrAgentCmd_UseModelCollisionBounds
==============
*/

void __fastcall ScrAgentCmd_UseModelCollisionBounds(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_UseModelCollisionBounds@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_SpawnAgent
==============
*/

void __fastcall AgentCmd_SpawnAgent(scrContext_t *scrContext, scr_entref_t entref)
{
  ?AgentCmd_SpawnAgent@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
Scr_GetMaxAgents
==============
*/

void __fastcall Scr_GetMaxAgents(scrContext_t *scrContext)
{
  ?Scr_GetMaxAgents@@YAXAEAUscrContext_t@@@Z(scrContext);
}

/*
==============
ScrAgentCmd_SetAnimMode
==============
*/

void __fastcall ScrAgentCmd_SetAnimMode(scrContext_t *scrContext, scr_entref_t entref)
{
  ?ScrAgentCmd_SetAnimMode@@YAXAEAUscrContext_t@@Uscr_entref_t@@@Z(scrContext, entref);
}

/*
==============
AgentCmd_AgentCanSeeSentient
==============
*/
void AgentCmd_AgentCanSeeSentient(scrContext_t *scrContext, scr_entref_t entref)
{
  const gentity_s *Entity; 
  AICommonInterface *m_pAI; 
  gentity_s *v6; 
  sentient_s *sentient; 
  int CanSeeSentient; 
  AICommonWrapper v9; 

  AIActorInterface::AIActorInterface(&v9.m_actorInterface);
  AIAgentInterface::AIAgentInterface(&v9.m_newAgentInterface);
  v9.m_newAgentInterface.__vftable = (AINewAgentInterface_vtbl *)&AINewAgentInterface::`vftable';
  AICommonInterface::AICommonInterface(&v9.m_botInterface);
  v9.m_botInterface.__vftable = (AIBotInterface_vtbl *)&AIBotInterface::`vftable';
  AICommonInterface::AICommonInterface(&v9.m_botAgentInterface);
  v9.m_pAI = NULL;
  v9.m_botAgentInterface.__vftable = (AIBotAgentInterface_vtbl *)&AIBotAgentInterface::`vftable';
  Entity = GetEntity(entref);
  AICommonWrapper::Setup(&v9, Entity);
  m_pAI = v9.m_pAI;
  if ( !v9.m_pAI && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 1005, ASSERT_TYPE_ASSERT, "(pAI)", (const char *)&queryFormat, "pAI") )
    __debugbreak();
  v6 = GScr_GetEntity(0);
  sentient = v6->sentient;
  if ( !sentient )
  {
    Scr_Error(COM_ERR_3627, scrContext, "AgentCanSeeSentient: entity is not sentient.");
    sentient = v6->sentient;
  }
  CanSeeSentient = AICommonInterface::CanSeeSentient(m_pAI, sentient, 250);
  Scr_AddBool(scrContext, CanSeeSentient);
}

/*
==============
AgentCmd_AgentClearScriptVars
==============
*/
void AgentCmd_AgentClearScriptVars(scrContext_t *scrContext, scr_entref_t entref)
{
  unsigned int entnum; 
  gentity_s *v4; 
  const char *v5; 

  entnum = entref.entnum;
  if ( entref.entclass )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v4 = NULL;
  }
  else
  {
    if ( entref.entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 1027, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v4 = &g_entities[entnum];
    if ( !v4->agent )
    {
      v5 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v5);
    }
  }
  Scr_ClearEntityNum(scrContext, v4->s.number, ENTITY_CLASS_GENTITY);
  Scr_ClearBlackboard(v4->s.number);
}

/*
==============
AgentCmd_AgentSetClipMode
==============
*/
void AgentCmd_AgentSetClipMode(scrContext_t *scrContext, scr_entref_t entref)
{
  unsigned int entnum; 
  gentity_s *v4; 
  const char *v5; 
  scr_string_t ConstString; 

  entnum = entref.entnum;
  if ( entref.entclass )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v4 = NULL;
  }
  else
  {
    if ( entref.entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 1047, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v4 = &g_entities[entnum];
    if ( !v4->agent )
    {
      v5 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v5);
    }
  }
  if ( !SV_IsAgentEntity(v4) && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 1049, ASSERT_TYPE_ASSERT, "( SV_IsAgentEntity( pSelf ) )", (const char *)&queryFormat, "SV_IsAgentEntity( pSelf )") )
    __debugbreak();
  ConstString = Scr_GetConstString(scrContext, 0);
  if ( ConstString == scr_const.player )
  {
    v4->clipmask = 33636369;
  }
  else if ( ConstString == scr_const.ai )
  {
    v4->clipmask = 33685521;
  }
  else
  {
    Scr_Error(COM_ERR_1766, scrContext, "unknown clip mode.");
  }
}

/*
==============
AgentCmd_AgentSetFavoriteEnemy
==============
*/
void AgentCmd_AgentSetFavoriteEnemy(scrContext_t *scrContext, scr_entref_t entref)
{
  sentient_s *sentient; 
  unsigned int entnum; 
  gentity_s *v5; 
  const char *v6; 

  sentient = NULL;
  entnum = entref.entnum;
  if ( entref.entclass )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v5 = NULL;
  }
  else
  {
    if ( entref.entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 1085, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v5 = &g_entities[entnum];
    if ( !v5->agent )
    {
      v6 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v6);
    }
  }
  if ( Scr_GetType(scrContext, 0) )
  {
    sentient = GScr_GetEntity(0)->sentient;
    if ( !sentient )
      Scr_Error(COM_ERR_5655, scrContext, "AgentSetFavoriteEnemy: entity is not sentient.");
  }
  SentientHandle::setSentient(&v5->sentient->ai->threat.pFavoriteEnemy, sentient);
}

/*
==============
AgentCmd_CloneAgent
==============
*/
void AgentCmd_CloneAgent(scrContext_t *scrContext, scr_entref_t entref)
{
  unsigned int entnum; 
  gentity_s *v4; 
  const char *v5; 
  const dvar_t *v6; 
  gagent_s *agent; 
  unsigned int v8; 
  int v9; 
  gentity_s *v10; 
  LerpEntityState *p_lerp; 
  int v12; 
  float v13; 
  XAnimTree *Tree; 
  int AgentCorpseIndex; 
  __int64 v16; 
  __int16 v17; 
  __int16 EntityIndex; 
  bool v19; 
  bool v20; 
  __int64 v21; 
  _DWORD *v22; 
  XAnim_s *Anims; 
  unsigned int Animset; 
  __int64 v25; 
  const XAnimTree *v26; 
  XAnimTree *v27; 
  XAnimTree *v28; 
  bool v29; 
  const Weapon *Weapon; 
  unsigned int eType; 
  int v32; 
  const Weapon *v33; 
  GWeaponMap *Instance; 
  GWeaponMap *v35; 
  unsigned __int16 *attachModelNames; 
  scr_string_t *attachTagNames; 
  AgentAttachModelData *attachModels; 
  const char *v39; 
  unsigned int v40; 
  const playerState_s *v41; 
  int v42; 
  const ScriptableDef *ScriptableDef; 
  unsigned int runtimeInstanceCount; 
  DObj *ServerDObjForEnt; 
  __int64 v46; 
  __int64 v47; 
  playerState_s *ps; 
  __int64 v49; 
  XAnimTree *from; 
  GameScriptDataMP *GameScriptDataMP; 
  DObj *obj; 
  char weaponMap; 
  GWeaponMap *weaponMapa; 
  EntityClass weaponMap_4; 
  GameModeFlagContainer<enum EntityStateFlagsCommon,enum EntityStateFlagsSP,enum EntityStateFlagsMP,32> v56; 
  int Int; 

  weaponMap_4 = entref.entclass;
  entnum = entref.entnum;
  Sys_ProfBeginNamedEvent(0xFFFF0000, "AgentCmd_CloneAgent");
  if ( weaponMap_4 )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v4 = NULL;
  }
  else
  {
    if ( entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 734, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v4 = &g_entities[entnum];
    if ( !v4->agent )
    {
      v5 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v5);
    }
  }
  v6 = DVARBOOL_entityLeakDisableItemsCorpses;
  if ( !DVARBOOL_entityLeakDisableItemsCorpses && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\universal\\dvar.h", 692, ASSERT_TYPE_ASSERT, "(dvar)", "%s\n\tDvar %s accessed after deregistration", "dvar", "entityLeakDisableItemsCorpses") )
    __debugbreak();
  Dvar_CheckFrontendServerThread(v6);
  if ( v6->current.enabled )
  {
    GScr_AddEntityAllowUndefined(NULL);
    return;
  }
  Int = Scr_GetInt(scrContext, 0);
  if ( Scr_GetNumParam(scrContext) < 2 || (weaponMap = 1, !Scr_GetInt(scrContext, 1u)) )
    weaponMap = 0;
  agent = v4->agent;
  ps = &agent->playerState;
  if ( !agent && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 748, ASSERT_TYPE_ASSERT, "(agent)", (const char *)&queryFormat, "agent") )
    __debugbreak();
  if ( !ComCharacterLimits::ms_isGameDataValid && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\qcommon\\com_character_limits.h", 160, ASSERT_TYPE_ASSERT, "(ms_isGameDataValid)", (const char *)&queryFormat, "ms_isGameDataValid") )
    __debugbreak();
  v8 = ComCharacterLimits::ms_gameData.m_characterCount + ComCharacterLimits::ms_gameData.m_clientCorpseCount;
  if ( !ComCharacterLimits::ms_isGameDataValid && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\qcommon\\com_character_limits.h", 137, ASSERT_TYPE_ASSERT, "(ms_isGameDataValid)", (const char *)&queryFormat, "ms_isGameDataValid") )
    __debugbreak();
  v9 = level.currentAgentClone + v8;
  v10 = &level.gentities[level.currentAgentClone + v8];
  p_lerp = &v10->s.lerp;
  level.currentAgentClone = (level.currentAgentClone + 1) % (signed int)ComCharacterLimits::ms_gameData.m_agentCorpseCount;
  if ( v10 == (gentity_s *)-12i64 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\qcommon\\com_gamemode_flags.h", 280, ASSERT_TYPE_ASSERT, "(sourceFlags)", (const char *)&queryFormat, "sourceFlags") )
    __debugbreak();
  v12 = ~p_lerp->eFlags.m_flags[0] & 4;
  if ( G_IsEntityInUse(v9) )
  {
    if ( !GUtils::ms_gUtils && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_utils.h", 112, ASSERT_TYPE_ASSERT, "( ms_gUtils )", (const char *)&queryFormat, "ms_gUtils") )
      __debugbreak();
    GUtils::ms_gUtils->FreeEntity(GUtils::ms_gUtils, v10);
  }
  if ( !GUtils::ms_gUtils && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_utils.h", 112, ASSERT_TYPE_ASSERT, "( ms_gUtils )", (const char *)&queryFormat, "ms_gUtils") )
    __debugbreak();
  GUtils::ms_gUtils->InitGentity(GUtils::ms_gUtils, v10);
  p_lerp->eFlags.m_flags[0] = v12;
  v10->s.clientNum = agent->playerState.clientNum;
  if ( !GameModeFlagContainer<enum POtherFlagsCommon,enum POtherFlagsSP,enum POtherFlagsMP,64>::TestFlagStrict(&agent->playerState.otherFlags, FOG_SCALE|0x20) && agent->playerState.groundEntityNum == 2047 && G_PlayerCorpseMP_RequiresFixedDeathCamera(v4) )
  {
    if ( GameModeFlagValues::ms_mpValue != ACTIVE && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\qcommon\\com_gamemode_flags.h", 201, ASSERT_TYPE_ASSERT, "(IsFlagActive( index ))", "%s\n\tThis function must be used in a MP-only context", "IsFlagActive( index )") )
      __debugbreak();
    GameModeFlagContainer<enum POtherFlagsCommon,enum POtherFlagsSP,enum POtherFlagsMP,64>::SetFlagInternal(&agent->playerState.otherFlags, ACTIVE, 0x32u);
  }
  v56.m_flags[0] = (unsigned int)agent->playerState.eFlags;
  if ( GameModeFlagValues::ms_mpValue != ACTIVE && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\qcommon\\com_gamemode_flags.h", 201, ASSERT_TYPE_ASSERT, "(IsFlagActive( index ))", "%s\n\tThis function must be used in a MP-only context", "IsFlagActive( index )") )
    __debugbreak();
  GameModeFlagContainer<enum EntityStateFlagsCommon,enum EntityStateFlagsSP,enum EntityStateFlagsMP,32>::SetFlagInternal(&v56, ACTIVE, 0x1Bu);
  GameModeFlagContainer<enum EntityStateFlagsCommon,enum EntityStateFlagsSP,enum EntityStateFlagsMP,32>::SetFlagInternal(&v56, ACTIVE, 0x11u);
  if ( v10 == (gentity_s *)-12i64 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\qcommon\\com_gamemode_flags.h", 280, ASSERT_TYPE_ASSERT, "(sourceFlags)", (const char *)&queryFormat, "sourceFlags") )
    __debugbreak();
  p_lerp->eFlags.m_flags[0] = (LOBYTE(v56.m_flags[0]) ^ (unsigned __int8)p_lerp->eFlags.m_flags[0]) & 4 ^ v56.m_flags[0];
  G_SetOriginAndAnglesForClone(&agent->playerState, &agent->playerState.origin, &v4->r.currentAngles, v10);
  v10->s.lerp.pos.trType = TR_GRAVITY;
  v10->s.lerp.pos.trTime = level.time;
  v13 = agent->playerState.velocity.v[0];
  v10->s.lerp.pos.trDelta.v[0] = v13;
  v10->s.lerp.pos.trDelta.v[1] = agent->playerState.velocity.v[1];
  v10->s.lerp.pos.trDelta.v[2] = agent->playerState.velocity.v[2];
  *(float *)v56.m_flags = v13;
  if ( (LODWORD(v13) & 0x7F800000) == 2139095040 || (v56.m_flags[0] = (unsigned int)LODWORD(v10->s.lerp.pos.trDelta.y), (v56.m_flags[0] & 0x7F800000) == 2139095040) || (v56.m_flags[0] = (unsigned int)LODWORD(v10->s.lerp.pos.trDelta.z), (v56.m_flags[0] & 0x7F800000) == 2139095040) )
  {
    if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 779, ASSERT_TYPE_SANITY, "( !IS_NAN( ( body->s.lerp.pos.trDelta )[0] ) && !IS_NAN( ( body->s.lerp.pos.trDelta )[1] ) && !IS_NAN( ( body->s.lerp.pos.trDelta )[2] ) )", (const char *)&queryFormat, "!IS_NAN( ( body->s.lerp.pos.trDelta )[0] ) && !IS_NAN( ( body->s.lerp.pos.trDelta )[1] ) && !IS_NAN( ( body->s.lerp.pos.trDelta )[2] )") )
      __debugbreak();
  }
  *(__m256i *)&v10->s.lerp.apos.trType = *(__m256i *)&v4->s.lerp.apos.trType;
  v10->s.lerp.apos.trDelta.v[2] = v4->s.lerp.apos.trDelta.v[2];
  v10->s.eType = ET_AGENT_CORPSE;
  v10->physicsObject = 1;
  obj = Com_GetServerDObjForEntnum(agent->playerState.clientNum);
  Tree = DObjGetTree(obj);
  v10->c.item[0].clipAmmoCount[0] = level.time;
  from = Tree;
  v10->c.item[0].ammoCount = 2047;
  AgentCorpseIndex = G_PlayerCorpseMP_GetAgentCorpseIndex(v10);
  GameScriptDataMP = GameScriptDataMP::GetGameScriptDataMP();
  v49 = 8i64;
  if ( (unsigned int)AgentCorpseIndex >= 8 )
  {
    LODWORD(v47) = 8;
    LODWORD(v46) = AgentCorpseIndex;
    if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 795, ASSERT_TYPE_ASSERT, "(unsigned)( corpseIndex ) < (unsigned)( ( sizeof( *array_counter( gScrData->agentCorpseInfo ) ) + 0 ) )", "corpseIndex doesn't index ARRAY_COUNT( gScrData->agentCorpseInfo )\n\t%i not in [0, %i)", v46, v47) )
      __debugbreak();
  }
  v16 = AgentCorpseIndex;
  v17 = GameScriptDataMP->agentCorpseInfo[v16].entnum;
  if ( v17 != -1 )
  {
    LODWORD(v47) = -1;
    LODWORD(v46) = v17;
    if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 797, ASSERT_TYPE_ASSERT, "( corpseInfo->entnum ) == ( G_PLAYER_CORPSE_INVALID_ENTNUM )", "corpseInfo->entnum == G_PLAYER_CORPSE_INVALID_ENTNUM\n\t%i, %i", v46, v47) )
      __debugbreak();
  }
  GameScriptDataMP->agentCorpseInfo[v16].entnum = v10->s.number;
  GameScriptDataMP->agentCorpseInfo[v16].time = level.time;
  GameScriptDataMP->agentCorpseInfo[v16].skipDropChecks = weaponMap;
  GameScriptDataMP->agentCorpseInfo[v16].falling = 1;
  EntityIndex = G_GetEntityIndex(v4);
  v19 = SV_IsAgentBot(EntityIndex) && !BG_IsPlayerPositionQuantized(&agent->playerState);
  GameScriptDataMP->agentCorpseInfo[v16].fullPrecisionOrigin = v19;
  GameScriptDataMP->agentCorpseInfo[v16].codeStartRagdollTime = 0;
  if ( SV_Agent_IsScripted(v4->s.number) )
    v20 = BG_AnimationState_GetController(&v4->s) == ANIMCTRL_DOG;
  else
    v20 = 0;
  GameScriptDataMP->agentCorpseInfo[v16].skippedRagdoll = v20;
  if ( !*(_QWORD *)&GStatic::ms_gameStatics && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_static.h", 64, ASSERT_TYPE_ASSERT, "( ms_gameStatics )", (const char *)&queryFormat, "ms_gameStatics") )
    __debugbreak();
  v21 = *(_QWORD *)&GStatic::ms_gameStatics;
  v22 = (_DWORD *)(*(__int64 (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)&GStatic::ms_gameStatics + 224i64))(*(_QWORD *)&GStatic::ms_gameStatics, (unsigned int)agent->playerState.clientNum);
  if ( !v22 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 824, ASSERT_TYPE_ASSERT, "( characterInfo )", (const char *)&queryFormat, "characterInfo") )
    __debugbreak();
  memcpy_0(&GameScriptDataMP->agentCorpseInfo[v16].ci, v22, sizeof(GameScriptDataMP->agentCorpseInfo[v16].ci));
  if ( (AgentCorpseIndex < 0 || (unsigned int)AgentCorpseIndex > 0xFF) && CoreAssert_Handler("c:\\workspace\\iw8\\shared\\codware\\core\\core_assert.h", 385, ASSERT_TYPE_ASSERT, (const char *)&queryFormat.fmt + 3, "%s (SmallType) %s 0x%jx == (BigType) %s 0x%jx", "unsigned char __cdecl truncate_cast_impl<unsigned char,int>(int)", "unsigned", (unsigned __int8)AgentCorpseIndex, "signed", AgentCorpseIndex) )
    __debugbreak();
  agent->playerState.corpseIndex = AgentCorpseIndex;
  if ( v22[642] )
  {
    Anims = BG_AnimationState_GetAnims(&v4->s);
  }
  else if ( PlayerASM_IsEnabled() )
  {
    Animset = BG_PlayerASM_GetAnimset(&v4->s);
    Anims = BG_PlayerASM_GetAnims(Animset);
  }
  else
  {
    v25 = (*(__int64 (__fastcall **)(__int64))(*(_QWORD *)v21 + 16i64))(v21);
    if ( !v25 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 843, ASSERT_TYPE_ASSERT, "( bgameAnim )", (const char *)&queryFormat, "bgameAnim") )
      __debugbreak();
    Anims = *(XAnim_s **)(v25 + 17712);
  }
  v26 = GameScriptDataMP->agentCorpseInfo[v16].tree;
  if ( v26 )
  {
    if ( XAnimGetAnims(v26) == Anims )
      goto LABEL_90;
    v27 = GameScriptDataMP->agentCorpseInfo[v16].tree;
    if ( v27 )
      Com_XAnimFreeSmallTree(v27);
  }
  GameScriptDataMP->agentCorpseInfo[v16].tree = Com_XAnimCreateSmallTree(Anims, MOVEMENT);
LABEL_90:
  v28 = GameScriptDataMP->agentCorpseInfo[v16].tree;
  GameScriptDataMP->agentCorpseInfo[v16].ci.pXAnimTree = v28;
  XAnimCloneAnimTree(from, v28);
  v29 = v10->r.svFlags == 0;
  v10->s.groundEntityNum = 2047;
  v10->s.surfType = v4->s.surfType;
  if ( !v29 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 864, ASSERT_TYPE_ASSERT, "(!body->r.svFlags)", (const char *)&queryFormat, "!body->r.svFlags") )
    __debugbreak();
  v10->r.svFlags = 2;
  *(_OWORD *)v10->r.box.midPoint.v = *(_OWORD *)v4->r.box.midPoint.v;
  *(double *)&v10->r.box.halfSize.y = *(double *)&v4->r.box.halfSize.y;
  *(_OWORD *)v10->r.absBox.midPoint.v = *(_OWORD *)v4->r.absBox.midPoint.v;
  *(double *)&v10->r.absBox.halfSize.y = *(double *)&v4->r.absBox.halfSize.y;
  weaponMapa = GWeaponMap::GetInstance();
  if ( !weaponMapa && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\bgame\\bg_weapons.h", 438, ASSERT_TYPE_ASSERT, "(weaponMap)", (const char *)&queryFormat, "weaponMap") )
    __debugbreak();
  Weapon = BgWeaponMap::GetWeapon(weaponMapa, v4->s.weaponHandle);
  if ( !weaponMapa && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\bgame\\bg_weapons.h", 522, ASSERT_TYPE_ASSERT, "(weaponMap)", (const char *)&queryFormat, "weaponMap") )
    __debugbreak();
  eType = (unsigned __int16)v4->s.eType;
  if ( (unsigned __int16)eType > 0x11u || (v32 = 131111, !_bittest(&v32, eType)) )
  {
    if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\bgame\\bg_weapons.h", 524, ASSERT_TYPE_ASSERT, "(es->eType == ET_GENERAL || es->eType == ET_PLAYER || es->eType == ET_PLAYER_CORPSE || es->eType == ET_AGENT || es->eType == ET_INVISIBLE)", (const char *)&queryFormat, "es->eType == ET_GENERAL || es->eType == ET_PLAYER || es->eType == ET_PLAYER_CORPSE || es->eType == ET_AGENT || es->eType == ET_INVISIBLE") )
      __debugbreak();
  }
  v33 = BgWeaponMap::GetWeapon(weaponMapa, v4->s.staticState.player.stowedWeaponHandle);
  Instance = GWeaponMap::GetInstance();
  BG_SetWeaponForEntity(Instance, &v10->s, Weapon);
  v35 = GWeaponMap::GetInstance();
  if ( !v35 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\bgame\\bg_weapons.h", 757, ASSERT_TYPE_ASSERT, "(weaponMap)", (const char *)&queryFormat, "weaponMap") )
    __debugbreak();
  if ( v10->s.eType != ET_AGENT_CORPSE && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\bgame\\bg_weapons.h", 759, ASSERT_TYPE_ASSERT, "(es->eType == ET_AGENT_CORPSE)", (const char *)&queryFormat, "es->eType == ET_AGENT_CORPSE") )
    __debugbreak();
  v35->SetWeapon(v35, (BgWeaponHandle *)&v10->s.staticState, v33);
  LerpEntityStateAgentCorpse::SetModelIndex((LerpEntityStateAgentCorpse *)&v10->s.lerp.u, v4->model);
  attachModelNames = v4->attachModelNames;
  attachTagNames = v4->attachTagNames;
  attachModels = v10->s.lerp.u.agentCorpse.attachModels;
  do
  {
    if ( *attachModelNames )
    {
      v39 = SL_ConvertToString(*attachTagNames);
      AgentAttachModelData::SetAttachModel(attachModels, *attachModelNames);
      if ( !GConfigStrings::ms_gConfigStrings && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_configstrings.h", 71, ASSERT_TYPE_ASSERT, "( ms_gConfigStrings )", (const char *)&queryFormat, "ms_gConfigStrings") )
        __debugbreak();
      v40 = GConfigStrings::ms_gConfigStrings->GetClientTagIndex(GConfigStrings::ms_gConfigStrings, v39);
      AgentAttachModelData::SetAttachTag(attachModels, v40);
    }
    else
    {
      AgentAttachModelData::Clear(attachModels);
    }
    ++attachModels;
    ++attachTagNames;
    ++attachModelNames;
    --v49;
  }
  while ( v49 );
  v41 = ps;
  v10->s.animInfo.animData = v10->s.animInfo.animData & 0xFFFFFFFE | (GameScriptDataMP->agentCorpseInfo[v16].ci.usingAnimState != 0);
  v10->s.animInfo.animTime = v4->s.animInfo.animTime;
  v10->s.animInfo.animData = v4->s.animInfo.animData;
  if ( !GameScriptDataMP->agentCorpseInfo[v16].ci.usingAnimState )
    BG_AnimationMP_PlayerToEntityAnimation(ps, &v10->s);
  v10->s.un.vehicleXModel = ps->suitIndex;
  v10->clipmask = 65537;
  SV_LinkEntity(v10);
  v10->nextthink = level.time + Int;
  v42 = v10->s.eType;
  v10->handler = 17;
  ScriptableDef = ScriptableBg_GetScriptableDef(v42, obj);
  if ( ScriptableDef )
  {
    ScriptableSv_LinkReservedScriptableEntity(v10, ScriptableDef, 0xFFFFFFFF);
  }
  else
  {
    ScriptableCommon_AssertCountsInitialized();
    runtimeInstanceCount = g_scriptableWorldCounts.runtimeInstanceCount;
    if ( ScriptableSv_GetScriptableIndexForEntity(v10) < runtimeInstanceCount )
      ScriptableSv_UnlinkReservedScriptableEntity(v10);
    v41 = ps;
  }
  if ( GameModeFlagContainer<enum POtherFlagsCommon,enum POtherFlagsSP,enum POtherFlagsMP,64>::TestFlagInternal(&v41->otherFlags, GameModeFlagValues::ms_mpValue, 0x38u) )
  {
    if ( !Com_GameMode_SupportsFeature(WEAPON_LADDER_CLIMB|0x80) && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\bgame\\bg_public.h", 2514, ASSERT_TYPE_ASSERT, "(Com_GameMode_SupportsFeature( Com_GameMode_Feature::MELEE_EXECUTION ))", (const char *)&queryFormat, "Com_GameMode_SupportsFeature( Com_GameMode_Feature::MELEE_EXECUTION )") )
      __debugbreak();
    if ( v41->activeExecutionIsVictim && !G_Execution_InitializeCorpse(v4, v10) )
      G_Execution_Cancel(v4);
  }
  ServerDObjForEnt = Com_GetServerDObjForEnt(v10);
  BG_AnimationMP_UpdateAgentCorpseDObj(LOCAL_CLIENT_INVALID, ServerDObjForEnt, weaponMapa, &v10->s, &GameScriptDataMP->agentCorpseInfo[v16].ci);
  G_TransferLinkedEntities(v4, v10);
  G_PlayerCorpseMP_TransferNonWeaponPartBits(v10, v4);
  GScr_AddEntityAllowUndefined(v10);
  if ( BGMovingPlatforms::IsOnMovingPlatform(v41) )
    G_ClientScrMP_TryToLinkCorpseToMovingPlatform(v10);
  G_PlayerCorpseMP_SnapOrigin(v10);
  Sys_ProfEndNamedEvent();
}

/*
==============
AgentCmd_DeSpawnAgent
==============
*/
void AgentCmd_DeSpawnAgent(scrContext_t *scrContext, scr_entref_t entref)
{
  unsigned int entnum; 
  gentity_s *v4; 
  const char *v5; 

  entnum = entref.entnum;
  if ( entref.entclass )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v4 = NULL;
  }
  else
  {
    if ( entref.entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 250, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v4 = &g_entities[entnum];
    if ( !v4->agent )
    {
      v5 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v5);
    }
  }
  G_CombatMP_AgentDespawn(v4);
}

/*
==============
AgentCmd_FinishAgentDamage
==============
*/
void AgentCmd_FinishAgentDamage(scrContext_t *scrContext, scr_entref_t entref)
{
  unsigned int entnum; 
  gentity_s *v4; 
  const char *v5; 
  const gentity_s *Entity; 
  int Int; 
  meansOfDeath_t v8; 
  __int128 v9; 
  scr_string_t ConstString; 
  hitLocation_t hitLoc; 
  double Float; 
  scr_string_t tagName; 
  playerState_s *p_playerState; 
  const char *v18; 
  ComErrorCode v19; 
  unsigned int v20; 
  int number; 
  __int64 v22; 
  __int64 v23; 
  __int16 otherEntityNum; 
  char v25; 
  char v26; 
  float v27; 
  int v28; 
  gagent_s *agent; 
  int v30; 
  unsigned int v31; 
  int iDamageParts; 
  DamageParts *v33; 
  gentity_s *v34; 
  ai_agent_t *ScriptedAgentInfo; 
  const GEntityHandlerList *EntHandlerList; 
  int health; 
  int v38; 
  const gentity_s *HitCorpseEntity; 
  const gentity_s *v40; 
  GBullet *BulletSystem; 
  bool v42; 
  const gentity_s *v43; 
  __int16 EntityIndex; 
  void (__fastcall *pain)(gentity_s *, gentity_s *, int, const vec3_t *, const int, const vec3_t *, const hitLocation_t, const Weapon *, bool); 
  __int16 v46; 
  __int64 partName; 
  vec3_t *point; 
  BOOL localdir; 
  meansOfDeath_t means; 
  bool outIsAlternate; 
  bool v52; 
  bool v53; 
  unsigned int damageFlags; 
  int v55; 
  int modelIndex; 
  gentity_s *pInflictor; 
  meansOfDeath_t v58; 
  vec3_t *v59; 
  AIAgentInterface v60; 
  AIAgentInterface *v61; 
  vec3_t direction; 
  vec3_t vectorValue; 
  vec3_t v64; 
  Weapon outWeapon; 

  entnum = entref.entnum;
  if ( entref.entclass )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v4 = NULL;
  }
  else
  {
    if ( entref.entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 431, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v4 = &g_entities[entnum];
    if ( !v4->agent )
    {
      v5 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v5);
    }
  }
  pInflictor = g_entities + 2046;
  Entity = g_entities + 2046;
  Int = Scr_GetInt(scrContext, 2u);
  if ( Scr_GetType(scrContext, 0) && Scr_GetPointerType(scrContext, 0) == VAR_ENTITY )
    pInflictor = GScr_GetEntity(0);
  if ( Scr_GetType(scrContext, 1u) && Scr_GetPointerType(scrContext, 1u) == VAR_ENTITY )
    Entity = GScr_GetEntity(1u);
  damageFlags = Scr_GetInt(scrContext, 3u);
  v58 = G_Combat_MeansOfDeathFromScriptParam(scrContext, 4);
  v8 = v58;
  GScr_Main_GetWeaponParam(scrContext, 5u, &outWeapon, &outIsAlternate);
  if ( Scr_GetType(scrContext, 6u) )
  {
    Scr_GetVector(scrContext, 6u, &vectorValue);
  }
  else
  {
    vectorValue.v[0] = 0.0;
    vectorValue.v[1] = 0.0;
    vectorValue.v[2] = 0.0;
  }
  if ( Scr_GetType(scrContext, 7u) )
  {
    Scr_GetVector(scrContext, 7u, &v64);
    v9 = LODWORD(v64.v[0]);
    *(float *)&v9 = fsqrt((float)((float)(*(float *)&v9 * *(float *)&v9) + (float)(v64.v[1] * v64.v[1])) + (float)(v64.v[2] * v64.v[2]));
    _XMM3 = v9;
    __asm
    {
      vcmpless xmm0, xmm3, cs:__real@80000000
      vblendvps xmm0, xmm3, xmm8, xmm0
    }
    direction.v[0] = v64.v[0] * (float)(1.0 / *(float *)&_XMM0);
    direction.v[2] = v64.v[2] * (float)(1.0 / *(float *)&_XMM0);
    direction.v[1] = v64.v[1] * (float)(1.0 / *(float *)&_XMM0);
    v59 = &v64;
  }
  else
  {
    direction.v[0] = 0.0;
    direction.v[1] = 0.0;
    direction.v[2] = 0.0;
    v59 = NULL;
  }
  ConstString = Scr_GetConstString(scrContext, 8u);
  hitLoc = G_Combat_GetHitLocationIndexFromString(ConstString);
  if ( hitLoc != HITLOC_SHIELD )
  {
    v55 = Scr_GetInt(scrContext, 9u);
    Float = Scr_GetFloat(scrContext, 0xAu);
    if ( *(float *)&Float < 0.0 || *(float *)&Float > 1.0 )
    {
      v18 = j_va("Given stun fraction (%.2f) is outside the allowed range (0,1).", *(float *)&Float);
      v19 = COM_ERR_3625;
      goto LABEL_121;
    }
    modelIndex = 0;
    if ( Scr_GetType(scrContext, 0xBu) )
      modelIndex = Scr_GetInt(scrContext, 0xBu);
    tagName = 0;
    if ( Scr_GetType(scrContext, 0xCu) )
      tagName = Scr_GetConstString(scrContext, 0xCu);
    v52 = 0;
    if ( Scr_GetNumParam(scrContext) > 0xD )
      v52 = Scr_GetInt(scrContext, 0xDu) != 0;
    v53 = 0;
    if ( Scr_GetNumParam(scrContext) > 0xE )
      v53 = Scr_GetInt(scrContext, 0xEu) != 0;
    p_playerState = &v4->agent->playerState;
    if ( p_playerState->pm_type == 7 )
    {
      v18 = "Trying to do damage to a client that is already dead";
      v19 = COM_ERR_3626;
LABEL_121:
      Scr_Error(v19, scrContext, v18);
      return;
    }
    v20 = v4->flags.m_flags[0];
    if ( (v20 & 8) == 0 && (damageFlags & 4) == 0 )
    {
      G_CombatMP_DamageKnockback(v4, Int, &direction, p_playerState);
      LOBYTE(v20) = v4->flags.m_flags[0];
    }
    if ( (v20 & 1) == 0 )
    {
      if ( EntHandle::isDefined(&v4->r.ownerNum) )
      {
        number = v4->r.ownerNum.number;
        if ( (unsigned int)(number - 1) >= 0x7FF )
        {
          LODWORD(partName) = number - 1;
          if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_public.h", 223, ASSERT_TYPE_ASSERT, "(unsigned)( number - 1 ) < (unsigned)( ENTITYNUM_NONE )", "number - 1 doesn't index ENTITYNUM_NONE\n\t%i not in [0, %i)", partName, 2047) )
            __debugbreak();
        }
        v22 = v4->r.ownerNum.number;
        if ( (unsigned int)(v22 - 1) >= 0x800 )
        {
          LODWORD(point) = 2048;
          LODWORD(partName) = v22 - 1;
          if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_public.h", 207, ASSERT_TYPE_ASSERT, "(unsigned)( entityIndex ) < (unsigned)( ( 2048 ) )", "entityIndex doesn't index MAX_GENTITIES\n\t%i not in [0, %i)", partName, point) )
            __debugbreak();
        }
        if ( !g_entities && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_public.h", 208, ASSERT_TYPE_ASSERT, "( g_entities != nullptr )", (const char *)&queryFormat, "g_entities != nullptr") )
          __debugbreak();
        v23 = v22 - 1;
        if ( g_entities[v23].r.isInUse != g_entityIsInUse[v23] && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_public.h", 209, ASSERT_TYPE_ASSERT, "( g_entities[entityIndex].r.isInUse == g_entityIsInUse[entityIndex] )", (const char *)&queryFormat, "g_entities[entityIndex].r.isInUse == g_entityIsInUse[entityIndex]") )
          __debugbreak();
        if ( !g_entityIsInUse[v23] )
        {
          LODWORD(point) = v4->r.ownerNum.number - 1;
          if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_public.h", 224, ASSERT_TYPE_ASSERT, "( ( G_IsEntityInUse( number - 1 ) ) )", "%s\n\t( number - 1 ) = %i", "( G_IsEntityInUse( number - 1 ) )", point) )
            __debugbreak();
        }
        if ( (g_entities[v4->r.ownerNum.number - 1].flags.m_flags[0] & 1) != 0 )
          return;
        v8 = v58;
      }
      else
      {
        otherEntityNum = v4->s.otherEntityNum;
        if ( otherEntityNum != 2047 && (g_entities[otherEntityNum].flags.m_flags[0] & 1) != 0 )
          return;
      }
      v25 = v52;
      if ( Int || !v52 )
      {
        v26 = 0;
        if ( Int <= 0 )
        {
          if ( v53 && v4->health > 0 )
            AgentCmd_SendHitEvent(v4, v4, Entity, &outWeapon, outIsAlternate, tagName, &vectorValue, &direction, v8, hitLoc, 0);
          return;
        }
      }
      else
      {
        v26 = 1;
        Int = 1;
      }
      v27 = (float)Int * *(float *)&Float;
      v4->agent->damageStun += (int)v27;
      v28 = Int - (int)v27;
      v4->agent->damageBlood += v28;
      if ( (damageFlags & 0x100) != 0 )
        v4->agent->damageRicochet += v28;
      if ( v25 )
        v4->agent->damageArmor += v28;
      agent = v4->agent;
      if ( v59 )
      {
        agent->damageFrom = direction;
        v4->agent->damageFromWorld = 0;
      }
      else
      {
        agent->damageFrom.v[0] = v4->r.currentOrigin.v[0];
        agent->damageFrom.v[1] = v4->r.currentOrigin.v[1];
        agent->damageFrom.v[2] = v4->r.currentOrigin.v[2];
        v4->agent->damageFromWorld = 1;
      }
      v30 = v28 - 1;
      if ( !v26 )
        v30 = v28;
      if ( v30 > 0 )
      {
        v31 = v30;
        if ( (v4->flags.m_flags[0] & 2) != 0 && v4->health - v30 <= 0 )
          v31 = v4->health - 1;
        iDamageParts = v4->sentient->iDamageParts;
        if ( iDamageParts != -1 && tagName )
        {
          v33 = DamageParts_Get(iDamageParts);
          if ( !v33 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 599, ASSERT_TYPE_ASSERT, "(pParts)", (const char *)&queryFormat, "pParts") )
            __debugbreak();
          v31 = DamageParts::ApplyDamage(v33, pInflictor, Entity, &direction, &vectorValue, v31, damageFlags, v8, &outWeapon, outIsAlternate, hitLoc, modelIndex, tagName);
        }
        BG_SetPlayerDamageFlinch(&v4->agent->playerState, v31);
        v34 = pInflictor;
        G_CombatMP_SetAnimDamageTypeCondition(v4->agent->playerState.clientNum, v4, pInflictor, v8, &outWeapon, outIsAlternate);
        G_CombatMP_SetAnimHitLocationCondition(v4->agent->playerState.clientNum, v4, hitLoc);
        G_CombatMP_SetAnimHitDirectionCondition(v4->agent->playerState.clientNum, v4, &direction, &v4->agent->playerState, v8);
        G_CombatMP_SetAnimMoveDirectionCondition(v4->agent->playerState.clientNum, v4, &v4->agent->playerState);
        if ( v8 == MOD_MELEE )
          G_CombatMP_SetMeleeReactionConditions(v4->agent->playerState.clientNum, v34);
        if ( v31 )
        {
          v4->health -= v31;
          G_Combat_DamageNotifyNoWeapon(scr_const.damage, v4, Entity, v34, NULL, NULL, v31, 0);
          AIAgentInterface::AIAgentInterface(&v60);
          v61 = NULL;
          v60.__vftable = (AIAgentInterface_vtbl *)&AINewAgentInterface::`vftable';
          if ( SV_IsAgentScripted(v4) )
          {
            ScriptedAgentInfo = AIAgentInterface::GetScriptedAgentInfo(v4);
            if ( ScriptedAgentInfo )
            {
              v61 = &v60;
              AINewAgentInterface::SetAgent((AINewAgentInterface *)&v60, ScriptedAgentInfo);
            }
          }
          if ( v61 )
          {
            LOBYTE(means) = outIsAlternate;
            v61->Pain(v61, (gentity_s *)Entity, v31, &vectorValue, v8, &direction, hitLoc, &outWeapon, means);
          }
        }
        EntHandlerList = G_Main_GetEntHandlerList(v4);
        if ( !EntHandlerList->die )
          Com_Printf(1, "No die handler for player entity handler type %i entity(%d)", v4->handler, (unsigned int)v4->s.number);
        health = v4->health;
        if ( health > 0 )
        {
          pain = EntHandlerList->pain;
          if ( pain )
          {
            LOBYTE(means) = outIsAlternate;
            pain(v4, (gentity_s *)Entity, v31, &vectorValue, v8, &direction, hitLoc, &outWeapon, means);
          }
          AgentCmd_SendHitEvent(v4, v4, Entity, &outWeapon, outIsAlternate, tagName, &vectorValue, &direction, v8, hitLoc, 0);
          goto LABEL_116;
        }
        if ( (unsigned int)(health + 999) > 0x3E6 )
          v4->health = -999;
        if ( EntHandlerList->die )
        {
          v38 = v55;
          if ( v55 < 0 )
          {
            if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 641, ASSERT_TYPE_ASSERT, "(timeOffset >= 0)", (const char *)&queryFormat, "timeOffset >= 0") )
              __debugbreak();
            v38 = v55;
          }
          LOBYTE(localdir) = outIsAlternate;
          EntHandlerList->die(v4, pInflictor, (gentity_s *)Entity, v31, damageFlags, v8, &outWeapon, localdir, &direction, hitLoc, v38);
        }
        if ( BG_IsImpalingBullet(&outWeapon, outIsAlternate) && (damageFlags & 1) == 0 )
        {
          if ( tagName )
          {
            HitCorpseEntity = G_CombatMP_GetHitCorpseEntity(v4);
            v40 = HitCorpseEntity;
            if ( HitCorpseEntity )
            {
              if ( HitCorpseEntity->s.eType == ET_AGENT_CORPSE )
              {
                BulletSystem = GBullet::GetBulletSystem();
                if ( !BulletSystem && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 652, ASSERT_TYPE_ASSERT, "(bullet)", (const char *)&queryFormat, "bullet") )
                  __debugbreak();
                GBullet::RegisterImpaledEntity(BulletSystem, Entity, v40, &outWeapon, outIsAlternate, &vectorValue, &direction, hitLoc, tagName);
              }
            }
          }
        }
        v42 = outIsAlternate;
        v43 = G_CombatMP_GetHitCorpseEntity(v4);
        AgentCmd_SendHitEvent(v43, v4, Entity, &outWeapon, v42, tagName, &vectorValue, &direction, v8, hitLoc, 1);
        EntityIndex = G_GetEntityIndex(v4);
        if ( G_IsEntityInUse(EntityIndex) )
        {
LABEL_116:
          v46 = G_GetEntityIndex(v4);
          if ( !G_IsEntityInUse(v46) && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 672, ASSERT_TYPE_ASSERT, "(G_IsEntityInUse( G_GetEntityIndex( pSelf ) ))", (const char *)&queryFormat, "G_IsEntityInUse( G_GetEntityIndex( pSelf ) )") )
            __debugbreak();
          v4->agent->playerState.stats[0] = v4->health;
        }
      }
    }
  }
}

/*
==============
AgentCmd_SendHitEvent
==============
*/
void AgentCmd_SendHitEvent(const gentity_s *body, const gentity_s *victim, const gentity_s *attacker, const Weapon *weapon, const bool isAlternate, const scr_string_t partName, const vec3_t *point, const vec3_t *localdir, const meansOfDeath_t means, const hitLocation_t hitLoc, const bool isFatal)
{
  int v14; 
  GBullet *BulletSystem; 
  int HitEvent; 
  unsigned int v17; 
  gentity_s *v18; 
  GWeaponMap *Instance; 
  ClientBits *p_clientMask; 
  unsigned int m_objIndex; 
  __int64 v22; 
  bool v23; 
  GTurret **v24; 
  GTurret *v25; 
  __int64 v26; 
  __int64 v27; 
  bool v28; 
  BulletHitBoneInfo outHitInfo[2]; 
  BOOL v31; 

  if ( weapon->weaponIdx && BG_GetWeaponType(weapon, isAlternate) == WEAPTYPE_BULLET )
  {
    if ( (unsigned int)means >= MOD_NUM && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\bgame\\bg_public.h", 1114, ASSERT_TYPE_ASSERT, "(unsigned)( mod ) < (unsigned)( MOD_NUM )", "mod doesn't index MOD_NUM\n\t%i not in [0, %i)", means, 25) )
      __debugbreak();
    if ( (unsigned int)means <= MOD_FIRE_BULLET )
    {
      v14 = 1049094;
      if ( _bittest(&v14, means) )
      {
        if ( (unsigned int)(hitLoc - 20) > 1 )
        {
          if ( !body && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 277, ASSERT_TYPE_ASSERT, "( body )", (const char *)&queryFormat, "body") )
            __debugbreak();
          if ( !attacker && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 278, ASSERT_TYPE_ASSERT, "( attacker )", (const char *)&queryFormat, "attacker") )
            __debugbreak();
          if ( !Dvar_GetBool_Internal_DebugName(DVARBOOL_g_useHitLocationFix, "g_useHitLocationFix") || !G_Bullet_BoneHitEncode(body, partName, point, outHitInfo) )
          {
            *(double *)outHitInfo = 0.0;
            v31 = 0;
          }
          BulletSystem = GBullet::GetBulletSystem();
          if ( !BulletSystem && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 286, ASSERT_TYPE_ASSERT, "(bullet)", (const char *)&queryFormat, "bullet") )
            __debugbreak();
          v28 = GBullet::IncrementHitClientEventCount(BulletSystem, body->s.number);
          HitEvent = BG_WeaponBulletFire_GetHitEvent(means, 1);
          if ( !HitEvent && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 291, ASSERT_TYPE_SANITY, "( bulletEvent != EV_NONE )", (const char *)&queryFormat, "bulletEvent != EV_NONE") )
            __debugbreak();
          v17 = 0;
          v31 = v28;
          outHitInfo[1] = (BulletHitBoneInfo)GBullet::CalculateHitImpactSoundDelay(BulletSystem, attacker, victim);
          v18 = G_Utils_SpawnEventEntity(point, HitEvent);
          Instance = GWeaponMap::GetInstance();
          BG_SetWeaponForEntity(Instance, &v18->s, weapon);
          v18->s.inAltWeaponMode = isAlternate;
          v18->s.eventParm = DirToByte(localdir);
          v18->s.eventParm2 = 0;
          v18->s.surfType = body->s.surfType;
          v18->s.otherEntityNum = attacker->s.number;
          v18->s.groundEntityNum = body->s.number;
          *(double *)v18->s.lerp.u.anonymous.data = *(double *)outHitInfo;
          v18->s.lerp.u.anonymous.data[2] = v31;
          p_clientMask = &v18->clientMask;
          while ( !p_clientMask->array[0] )
          {
            ++v17;
            p_clientMask = (ClientBits *)((char *)p_clientMask + 4);
            if ( v17 >= 7 )
              goto LABEL_30;
          }
          if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 308, ASSERT_TYPE_ASSERT, "( eventEnt->clientMask.noBitsOn() )", (const char *)&queryFormat, "eventEnt->clientMask.noBitsOn()") )
            __debugbreak();
LABEL_30:
          if ( hitLoc == HITLOC_HEAD )
          {
            v18->s.eventParm2 |= 1u;
          }
          else if ( (unsigned int)(hitLoc - 6) <= 0xB )
          {
            v18->s.eventParm2 |= 0x40u;
          }
          if ( isFatal )
            v18->s.eventParm2 |= 2u;
          m_objIndex = attacker->turretHandle.m_objIndex;
          if ( m_objIndex )
          {
            v22 = m_objIndex - 1;
            if ( !(_BYTE)GTurret::ms_allocatedType && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_turret.h", 226, ASSERT_TYPE_ASSERT, "( ms_allocatedType != GameModeType::NONE )", (const char *)&queryFormat, "ms_allocatedType != GameModeType::NONE") )
              __debugbreak();
            if ( (unsigned int)v22 >= 0x80 )
            {
              LODWORD(v27) = 128;
              LODWORD(v26) = v22;
              if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_turret.h", 227, ASSERT_TYPE_ASSERT, "(unsigned)( turretIndex ) < (unsigned)( ( sizeof( *array_counter( ms_turretArray ) ) + 0 ) )", "turretIndex doesn't index ARRAY_COUNT( ms_turretArray )\n\t%i not in [0, %i)", v26, v27) )
                __debugbreak();
            }
            v23 = GTurret::ms_turretArray[v22] == NULL;
            v24 = &GTurret::ms_turretArray[v22];
            if ( v23 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_turret.h", 228, ASSERT_TYPE_ASSERT, "( ms_turretArray[turretIndex] )", (const char *)&queryFormat, "ms_turretArray[turretIndex]") )
              __debugbreak();
            v25 = *v24;
            if ( !v25 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 378, ASSERT_TYPE_ASSERT, "(turret)", (const char *)&queryFormat, "turret") )
              __debugbreak();
            v25->m_data.flags |= 0x10000u;
          }
          G_BulletMP_MarkPotentialImpactFixup(v18, v18->s.groundEntityNum, partName);
        }
      }
    }
  }
}

/*
==============
AgentCmd_SetAgentAttacker
==============
*/
void AgentCmd_SetAgentAttacker(scrContext_t *scrContext, scr_entref_t entref)
{
  unsigned int entnum; 
  gentity_s *v4; 
  const char *v5; 
  gentity_s *Entity; 
  bot_data_t *BotDataForEnt; 

  entnum = entref.entnum;
  if ( entref.entclass )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v4 = NULL;
  }
  else
  {
    if ( entref.entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 694, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v4 = &g_entities[entnum];
    if ( !v4->agent )
    {
      v5 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v5);
    }
  }
  Entity = GScr_GetEntity(0);
  if ( SV_IsAgentBot(v4->s.number) )
  {
    BotDataForEnt = Agent_GetBotDataForEnt(v4);
    Bot_SetAttacker(BotDataForEnt, Entity);
  }
}

/*
==============
AgentCmd_SetAgentBounds
==============
*/
void AgentCmd_SetAgentBounds(scrContext_t *scrContext, scr_entref_t entref)
{
  unsigned int entnum; 
  gentity_s *v4; 
  const char *v5; 
  double Float; 
  float v7; 
  double v8; 
  float v9; 

  entnum = entref.entnum;
  if ( entref.entclass )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v4 = NULL;
  }
  else
  {
    if ( entref.entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 127, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v4 = &g_entities[entnum];
    if ( !v4->agent )
    {
      v5 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v5);
    }
  }
  if ( Scr_GetNumParam(scrContext) && Scr_GetType(scrContext, 0) )
  {
    Float = Scr_GetFloat(scrContext, 0);
    v7 = *(float *)&Float;
  }
  else
  {
    v7 = actorBox.halfSize.v[0];
  }
  if ( Scr_GetNumParam(scrContext) > 1 && Scr_GetType(scrContext, 1u) )
  {
    v8 = Scr_GetFloat(scrContext, 1u);
    v9 = *(float *)&v8 * 0.5;
  }
  else
  {
    v9 = actorBox.halfSize.v[2];
  }
  if ( v9 < v7 )
    Scr_Error(COM_ERR_5656, scrContext, "Cannot create capsule with radius larger than half the height");
  v4->r.box.midPoint.v[0] = vec3_origin.v[0];
  v4->r.box.midPoint.v[1] = vec3_origin.v[1];
  v4->r.box.midPoint.v[2] = v9 + 0.0;
  v4->r.box.halfSize.v[0] = v7;
  v4->r.box.halfSize.v[1] = v7;
  v4->r.box.halfSize.v[2] = v9;
}

/*
==============
AgentCmd_SetCorpseModel
==============
*/
void AgentCmd_SetCorpseModel(scrContext_t *scrContext, scr_entref_t entref)
{
  gentity_s *Entity; 
  const char *String; 
  int ModelIndex; 
  AgentAttachModelData *attachModels; 
  __int64 v7; 
  __int64 AgentCorpseIndex; 
  GameScriptDataMP *GameScriptDataMP; 
  GWeaponMap *Instance; 
  DObj *ServerDObjForEnt; 
  __int64 v12; 
  int v13; 

  Entity = GetEntity(entref);
  if ( Entity->s.eType != ET_AGENT_CORPSE )
    Scr_Error(COM_ERR_6326, scrContext, "Function only valid on agent corpses.");
  String = Scr_GetString(scrContext, 0);
  if ( !GConfigStrings::ms_gConfigStrings && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_configstrings.h", 71, ASSERT_TYPE_ASSERT, "( ms_gConfigStrings )", (const char *)&queryFormat, "ms_gConfigStrings") )
    __debugbreak();
  ModelIndex = GConfigStrings::GetModelIndex(GConfigStrings::ms_gConfigStrings, String);
  LerpEntityStateAgentCorpse::SetModelIndex((LerpEntityStateAgentCorpse *)&Entity->s.lerp.u, ModelIndex);
  if ( Scr_GetInt(scrContext, 1u) )
  {
    attachModels = Entity->s.lerp.u.agentCorpse.attachModels;
    v7 = 8i64;
    do
    {
      AgentAttachModelData::Clear(attachModels++);
      --v7;
    }
    while ( v7 );
  }
  AgentCorpseIndex = G_PlayerCorpseMP_GetAgentCorpseIndex(Entity);
  GameScriptDataMP = GameScriptDataMP::GetGameScriptDataMP();
  if ( (unsigned int)AgentCorpseIndex >= 8 )
  {
    v13 = 8;
    LODWORD(v12) = AgentCorpseIndex;
    if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 982, ASSERT_TYPE_ASSERT, "(unsigned)( corpseIndex ) < (unsigned)( ( sizeof( *array_counter( gScrData->agentCorpseInfo ) ) + 0 ) )", "corpseIndex doesn't index ARRAY_COUNT( gScrData->agentCorpseInfo )\n\t%i not in [0, %i)", v12, v13) )
      __debugbreak();
  }
  Instance = GWeaponMap::GetInstance();
  ServerDObjForEnt = Com_GetServerDObjForEnt(Entity);
  BG_AnimationMP_UpdateAgentCorpseDObj(LOCAL_CLIENT_INVALID, ServerDObjForEnt, Instance, &Entity->s, &GameScriptDataMP->agentCorpseInfo[AgentCorpseIndex].ci);
}

/*
==============
AgentCmd_SpawnAgent
==============
*/
void AgentCmd_SpawnAgent(scrContext_t *scrContext, scr_entref_t entref)
{
  const char *String; 
  unsigned int entnum; 
  bool bLegacyAgent; 
  gentity_s *v6; 
  const char *v7; 
  const char *v8; 
  double Float; 
  float v10; 
  double v11; 
  float v12; 
  const gentity_s *Entity; 
  __int16 EntityIndex; 
  unsigned int ownerNum; 
  bool freezeControls; 
  Bounds bounds; 
  vec3_t angles; 
  vec3_t vectorValue; 

  String = NULL;
  entnum = entref.entnum;
  bLegacyAgent = 1;
  if ( entref.entclass )
  {
    Scr_ObjectError(COM_ERR_3618, scrContext, "not an entity");
    v6 = NULL;
  }
  else
  {
    if ( entref.entnum >= 0x800 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\server_mp\\sv_agent_scr.cpp", 176, ASSERT_TYPE_ASSERT, "(entref.entnum < ( 2048 ))", (const char *)&queryFormat, "entref.entnum < MAX_GENTITIES") )
      __debugbreak();
    v6 = &g_entities[entnum];
    if ( !v6->agent )
    {
      v7 = j_va("entity %i is not an agent", entnum);
      Scr_ObjectError(COM_ERR_3617, scrContext, v7);
    }
  }
  Scr_GetVector(scrContext, 0, &vectorValue);
  Scr_GetVector(scrContext, 1u, &angles);
  if ( !*(_QWORD *)&GStatic::ms_gameStatics && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\game\\g_static.h", 64, ASSERT_TYPE_ASSERT, "( ms_gameStatics )", (const char *)&queryFormat, "ms_gameStatics") )
    __debugbreak();
  if ( *(_QWORD *)((*(__int64 (__fastcall **)(_QWORD, _QWORD))(**(_QWORD **)&GStatic::ms_gameStatics + 224i64))(*(_QWORD *)&GStatic::ms_gameStatics, (unsigned int)v6->s.number) + 2040) )
  {
    v8 = j_va(&byte_1440C2820, (unsigned int)v6->s.number);
    Scr_Error(COM_ERR_3622, scrContext, v8);
  }
  if ( Scr_GetNumParam(scrContext) > 2 && Scr_GetType(scrContext, 2u) )
    String = Scr_GetString(scrContext, 2u);
  if ( Scr_GetNumParam(scrContext) > 3 && Scr_GetType(scrContext, 3u) )
  {
    Float = Scr_GetFloat(scrContext, 3u);
    v10 = *(float *)&Float;
  }
  else
  {
    v10 = actorBox.halfSize.v[0];
  }
  if ( Scr_GetNumParam(scrContext) > 4 && Scr_GetType(scrContext, 4u) )
  {
    v11 = Scr_GetFloat(scrContext, 4u);
    v12 = *(float *)&v11 * 0.5;
  }
  else
  {
    v12 = actorBox.halfSize.v[2];
  }
  if ( v12 < v10 )
    Scr_Error(COM_ERR_3623, scrContext, "Cannot create capsule with radius larger than half the height");
  if ( Scr_GetNumParam(scrContext) > 5 && Scr_GetType(scrContext, 5u) == VAR_POINTER )
  {
    Entity = GScr_GetEntity(5u);
    EntityIndex = G_GetEntityIndex(Entity);
    if ( !G_IsEntityInUse(EntityIndex) )
      Scr_Error(COM_ERR_3624, scrContext, "ERROR: Cannot set owner that is not in use.");
    ownerNum = Entity->s.number;
  }
  else
  {
    ownerNum = 2047;
  }
  freezeControls = Scr_GetNumParam(scrContext) > 6 && Scr_GetType(scrContext, 6u) && Scr_GetInt(scrContext, 6u);
  if ( Scr_GetNumParam(scrContext) > 7 && Scr_GetType(scrContext, 7u) )
    bLegacyAgent = Scr_GetInt(scrContext, 7u) != 0;
  bounds.midPoint.v[0] = vec3_origin.v[0];
  bounds.midPoint.v[1] = vec3_origin.v[1];
  bounds.midPoint.v[2] = v12 + 0.0;
  bounds.halfSize.v[0] = v10;
  bounds.halfSize.v[1] = v10;
  bounds.halfSize.v[2] = v12;
  Agent_Spawn(v6, &vectorValue, &angles, String, &bounds, ownerNum, freezeControls, bLegacyAgent);
}

/*
==============
ScrAgentCmd_BeginMelee
==============
*/
void ScrAgentCmd_BeginMelee(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3663, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_ClaimNode
==============
*/
void ScrAgentCmd_ClaimNode(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3654, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_DoAnimLerp
==============
*/
void ScrAgentCmd_DoAnimLerp(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3667, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_DoAnimRelative
==============
*/
void ScrAgentCmd_DoAnimRelative(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3671, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_DoTrajectory
==============
*/
void ScrAgentCmd_DoTrajectory(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3665, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_GetGoalPos
==============
*/
void ScrAgentCmd_GetGoalPos(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3634, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_GetLookaheadDir
==============
*/
void ScrAgentCmd_GetLookaheadDir(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3629, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_GetMaxTurnSpeed
==============
*/
void ScrAgentCmd_GetMaxTurnSpeed(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3659, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_GetPathGoalPos
==============
*/
void ScrAgentCmd_GetPathGoalPos(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3631, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_IsStuck
==============
*/
void ScrAgentCmd_IsStuck(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3676, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_RelinquishClaimedNode
==============
*/
void ScrAgentCmd_RelinquishClaimedNode(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3656, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_RequestStopSoonNotify
==============
*/
void ScrAgentCmd_RequestStopSoonNotify(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3640, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetAnimMode
==============
*/
void ScrAgentCmd_SetAnimMode(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3647, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetAnimScale
==============
*/
void ScrAgentCmd_SetAnimScale(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3639, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetClipMode
==============
*/
void ScrAgentCmd_SetClipMode(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3652, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetGoalEntity
==============
*/
void ScrAgentCmd_SetGoalEntity(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3636, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetGoalNode
==============
*/
void ScrAgentCmd_SetGoalNode(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3635, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetGoalPos
==============
*/
void ScrAgentCmd_SetGoalPos(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3632, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetGoalRadius
==============
*/
void ScrAgentCmd_SetGoalRadius(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3637, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetMaxTurnSpeed
==============
*/
void ScrAgentCmd_SetMaxTurnSpeed(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3660, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetOrientMode
==============
*/
void ScrAgentCmd_SetOrientMode(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3643, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetPhysicsMode
==============
*/
void ScrAgentCmd_SetPhysicsMode(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3650, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetScripted
==============
*/
void ScrAgentCmd_SetScripted(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3669, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetUnitType
==============
*/
void ScrAgentCmd_SetUnitType(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3675, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetViewHeight
==============
*/
void ScrAgentCmd_SetViewHeight(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3661, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetWallRunCost
==============
*/
void ScrAgentCmd_SetWallRunCost(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3672, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_SetWaypoint
==============
*/
void ScrAgentCmd_SetWaypoint(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3638, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
ScrAgentCmd_UseModelCollisionBounds
==============
*/
void ScrAgentCmd_UseModelCollisionBounds(scrContext_t *scrContext, scr_entref_t entref)
{
  Scr_Error(COM_ERR_3658, scrContext, "Legacy agent script commands no longer supported");
}

/*
==============
Scr_GetMaxAgents
==============
*/
void Scr_GetMaxAgents(scrContext_t *scrContext)
{
  int AgentCount; 

  AgentCount = SV_GameMP_GetAgentCount();
  Scr_AddInt(scrContext, AgentCount);
}

