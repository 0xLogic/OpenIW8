/*
==============
bdLoginTaskUmbrellaLegacyLogin::pump
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::pump(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?pump@bdLoginTaskUmbrellaLegacyLogin@@UEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus(bdLoginTaskUmbrellaLegacyLogin *this, const char *messageInfo, const bdLoginTaskUmbrellaLegacyLogin::UmbrellaLegacyLoginStatusCode *code)
{
  ?updateUmbrellaLegacyLoginStatus@bdLoginTaskUmbrellaLegacyLogin@@IEAAXPEBDAEBW4UmbrellaLegacyLoginStatusCode@1@@Z(this, messageInfo, code);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::clearBuffers
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::clearBuffers(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?clearBuffers@bdLoginTaskUmbrellaLegacyLogin@@IEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::cancelRemoteTask
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::cancelRemoteTask(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?cancelRemoteTask@bdLoginTaskUmbrellaLegacyLogin@@IEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::getNewTask
==============
*/

bdReference<bdRemoteTask> *__fastcall bdLoginTaskUmbrellaLegacyLogin::getNewTask(bdLoginTaskUmbrellaLegacyLogin *this, bdReference<bdRemoteTask> *result)
{
  return ?getNewTask@bdLoginTaskUmbrellaLegacyLogin@@IEAA?AV?$bdReference@VbdRemoteTask@@@@XZ(this, result);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::readyForRequest
==============
*/

bool __fastcall bdLoginTaskUmbrellaLegacyLogin::readyForRequest(bdLoginTaskUmbrellaLegacyLogin *this)
{
  return ?readyForRequest@bdLoginTaskUmbrellaLegacyLogin@@IEAA_NXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::startLoginTask
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::startLoginTask(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?startLoginTask@bdLoginTaskUmbrellaLegacyLogin@@IEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::reset
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::reset(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?reset@bdLoginTaskUmbrellaLegacyLogin@@UEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::getFailedTask
==============
*/

bdReference<bdRemoteTask> *__fastcall bdLoginTaskUmbrellaLegacyLogin::getFailedTask(bdLoginTaskUmbrellaLegacyLogin *this, bdReference<bdRemoteTask> *result)
{
  return ?getFailedTask@bdLoginTaskUmbrellaLegacyLogin@@IEBA?AV?$bdReference@VbdRemoteTask@@@@XZ(this, result);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::parseErrorJSON
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::parseErrorJSON(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?parseErrorJSON@bdLoginTaskUmbrellaLegacyLogin@@IEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::bdLoginTaskUmbrellaLegacyLogin
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::bdLoginTaskUmbrellaLegacyLogin(bdLoginTaskUmbrellaLegacyLogin *this, const bdLoginConfig *loginConfig, bdLoginResult *loginResult)
{
  ??0bdLoginTaskUmbrellaLegacyLogin@@QEAA@PEBVbdLoginConfig@@PEAVbdLoginResult@@@Z(this, loginConfig, loginResult);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?processUmbrellaLoginReply@bdLoginTaskUmbrellaLegacyLogin@@IEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::resetHttpInterface
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::resetHttpInterface(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?resetHttpInterface@bdLoginTaskUmbrellaLegacyLogin@@IEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::getTaskCode
==============
*/

bdLoginTaskUmbrellaLegacyLogin::UmbrellaLegacyLoginStatusCode __fastcall bdLoginTaskUmbrellaLegacyLogin::getTaskCode(bdLoginTaskUmbrellaLegacyLogin *this)
{
  return ?getTaskCode@bdLoginTaskUmbrellaLegacyLogin@@QEBA?AW4UmbrellaLegacyLoginStatusCode@1@XZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::createUmbrellaLoginJson
==============
*/

bool __fastcall bdLoginTaskUmbrellaLegacyLogin::createUmbrellaLoginJson(bdLoginTaskUmbrellaLegacyLogin *this, bdJSONSerializer *umbrellaLoginJSON)
{
  return ?createUmbrellaLoginJson@bdLoginTaskUmbrellaLegacyLogin@@IEAA_NAEAVbdJSONSerializer@@@Z(this, umbrellaLoginJSON);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::buildUmbrellaLoginReq
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::buildUmbrellaLoginReq(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?buildUmbrellaLoginReq@bdLoginTaskUmbrellaLegacyLogin@@IEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::pumpRemoteTask
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::pumpRemoteTask(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?pumpRemoteTask@bdLoginTaskUmbrellaLegacyLogin@@IEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::getTaskMessage
==============
*/

const char *__fastcall bdLoginTaskUmbrellaLegacyLogin::getTaskMessage(bdLoginTaskUmbrellaLegacyLogin *this)
{
  return ?getTaskMessage@bdLoginTaskUmbrellaLegacyLogin@@UEBAPEBDXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::~bdLoginTaskUmbrellaLegacyLogin
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::~bdLoginTaskUmbrellaLegacyLogin(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ??1bdLoginTaskUmbrellaLegacyLogin@@UEAA@XZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::abortTask
==============
*/

void __fastcall bdLoginTaskUmbrellaLegacyLogin::abortTask(bdLoginTaskUmbrellaLegacyLogin *this)
{
  ?abortTask@bdLoginTaskUmbrellaLegacyLogin@@UEAAXXZ(this);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::bdLoginTaskUmbrellaLegacyLogin
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::bdLoginTaskUmbrellaLegacyLogin(bdLoginTaskUmbrellaLegacyLogin *this, const bdLoginConfig *loginConfig, bdLoginResult *loginResult)
{
  this->__vftable = (bdLoginTaskUmbrellaLegacyLogin_vtbl *)&bdLoginTask::`vftable';
  bdStopwatch::bdStopwatch(&this->m_taskTimer);
  this->m_loginConfig = loginConfig;
  this->__vftable = (bdLoginTaskUmbrellaLegacyLogin_vtbl *)&bdLoginTaskUmbrellaLegacyLogin::`vftable';
  this->m_loginResult = loginResult;
  this->m_outputObject = NULL;
  this->m_firstPartyTokenStatusCode = FETCHING_FIRST_PARTY_TOKEN;
  this->m_environment = BD_ENVIRONMENT_MAX;
  this->m_remoteTask.m_ptr = NULL;
  this->m_httpInterface = NULL;
  this->m_umbrellaStatusCode = UNINITIALIZED;
  memset_0(this->m_umbrellaStatusMessage, 0, sizeof(this->m_umbrellaStatusMessage));
  memset_0(this->m_authTicketB64, 0, 0x80ui64);
  *(_QWORD *)this->m_ivSeedB64 = 0i64;
  *(_QWORD *)&this->m_ivSeedB64[8] = 0i64;
  *(_QWORD *)&this->m_ivSeedB64[16] = 0i64;
  *(_QWORD *)&this->m_ivSeedB64[24] = 0i64;
  this->m_requestBufferSize = 4096;
  this->m_responseBufferSize = 14336;
  memset_0(this->m_httpRequestBuffer, 0, sizeof(this->m_httpRequestBuffer));
  memset_0(this->m_httpResponseBuffer, 0, this->m_responseBufferSize);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::~bdLoginTaskUmbrellaLegacyLogin
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::~bdLoginTaskUmbrellaLegacyLogin(bdLoginTaskUmbrellaLegacyLogin *this)
{
  bdSingleIdentityJSONDeserializable *m_outputObject; 
  bdHTTP *m_httpInterface; 
  bdHTTP *v4; 
  bdRemoteTask *m_ptr; 
  bdRemoteTask *v6; 
  bdRemoteTask *v7; 

  this->__vftable = (bdLoginTaskUmbrellaLegacyLogin_vtbl *)&bdLoginTaskUmbrellaLegacyLogin::`vftable';
  m_outputObject = this->m_outputObject;
  if ( m_outputObject )
    ((void (__fastcall *)(bdSingleIdentityJSONDeserializable *, __int64))m_outputObject->~bdSingleIdentityJSONDeserializable)(m_outputObject, 1i64);
  this->m_outputObject = NULL;
  m_httpInterface = this->m_httpInterface;
  if ( m_httpInterface )
  {
    m_httpInterface->abortOperation(m_httpInterface);
    v4 = this->m_httpInterface;
    if ( v4 )
      ((void (__fastcall *)(bdHTTP *, __int64))v4->~bdHTTP)(v4, 1i64);
    this->m_httpInterface = NULL;
  }
  m_ptr = this->m_remoteTask.m_ptr;
  if ( m_ptr )
    bdRemoteTask::cancelTask(m_ptr);
  memset_0(this->m_httpRequestBuffer, 0, this->m_requestBufferSize);
  memset_0(this->m_httpResponseBuffer, 0, this->m_responseBufferSize);
  v6 = this->m_remoteTask.m_ptr;
  if ( v6 && _InterlockedExchangeAdd((volatile signed __int32 *)&v6->m_refCount, 0xFFFFFFFF) == 1 )
  {
    v7 = this->m_remoteTask.m_ptr;
    if ( v7 )
      ((void (__fastcall *)(bdRemoteTask *, __int64))v7->~bdReferencable)(v7, 1i64);
    this->m_remoteTask.m_ptr = NULL;
  }
  this->__vftable = (bdLoginTaskUmbrellaLegacyLogin_vtbl *)&bdLoginTask::`vftable';
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::abortTask
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::abortTask(bdLoginTaskUmbrellaLegacyLogin *this)
{
  char *m_umbrellaStatusMessage; 
  bdHTTP *m_httpInterface; 
  bdHTTP *v4; 
  bdRemoteTask *m_ptr; 
  bdLoginTaskUmbrellaLegacyLogin::UmbrellaLegacyLoginStatusCode code; 

  m_umbrellaStatusMessage = this->m_umbrellaStatusMessage;
  bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::abortTask", 0x4Eu, "Aborting Umbrella Legacy Login task, current status: [%s]", this->m_umbrellaStatusMessage);
  bdSnprintf(m_umbrellaStatusMessage, 0x400ui64, "Aborting Umbrella Legacy Login task, current status: [%s]", m_umbrellaStatusMessage);
  code = CONNECTED;
  bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus(this, m_umbrellaStatusMessage, &code);
  m_httpInterface = this->m_httpInterface;
  if ( m_httpInterface )
  {
    m_httpInterface->abortOperation(m_httpInterface);
    v4 = this->m_httpInterface;
    if ( v4 )
      ((void (__fastcall *)(bdHTTP *, __int64))v4->~bdHTTP)(v4, 1i64);
    this->m_httpInterface = NULL;
  }
  m_ptr = this->m_remoteTask.m_ptr;
  if ( m_ptr )
    bdRemoteTask::cancelTask(m_ptr);
  memset_0(this->m_httpRequestBuffer, 0, this->m_requestBufferSize);
  memset_0(this->m_httpResponseBuffer, 0, this->m_responseBufferSize);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::buildUmbrellaLoginReq
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::buildUmbrellaLoginReq(bdLoginTaskUmbrellaLegacyLogin *this)
{
  bdHTTP *v2; 
  bdLoginConfig *m_loginConfig; 
  const char *Region; 
  bdEnvironment Environment; 
  int v6; 
  bool v7; 
  __int64 v8; 
  unsigned __int64 v9; 
  const char *v10; 
  size_t v11; 
  const char *v12; 
  const char *ClientID; 
  char src[32]; 
  char v15[512]; 
  char buf[512]; 

  v2 = bdHTTPUtility::newHTTP(0, 0);
  m_loginConfig = (bdLoginConfig *)this->m_loginConfig;
  this->m_httpInterface = v2;
  Region = bdLoginConfig::getRegion(m_loginConfig);
  Environment = bdLoginResult::getEnvironment(this->m_loginResult);
  v6 = *(unsigned __int8 *)Region - (unsigned __int8)aCn[0];
  if ( !v6 )
  {
    v6 = *((unsigned __int8 *)Region + 1) - (unsigned __int8)aCn[1];
    if ( !v6 )
      v6 = *((unsigned __int8 *)Region + 2) - (unsigned __int8)aCn[2];
  }
  bdHandleAssert(1, "s != BD_NULL", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdplatform\\bdplatformstring\\bdplatformstring.inl", "bdStrlen", 0x110u, "null ptr in bdStrlen");
  v7 = v6 == 0;
  v8 = -1i64;
  v9 = -1i64;
  if ( v7 )
  {
    v10 = "https:
    do
      ++v9;
    while ( aHttpsUmbrellaS[v9] );
  }
  else
  {
    v10 = "https:
    do
      ++v9;
    while ( aHttpsSUmbrella[v9] );
  }
  v11 = 511i64;
  if ( v9 < 0x1FF )
    v11 = v9;
  memcpy_0(v15, v10, v11);
  v15[v11] = 0;
  if ( Environment )
  {
    if ( Environment == BD_ENVIRONMENT_CERT )
    {
      v12 = "cert";
      goto LABEL_17;
    }
    if ( Environment == BD_ENVIRONMENT_PROD )
    {
      v12 = "prod";
      goto LABEL_17;
    }
    bdLogMessage(BD_LOG_WARNING, "warn/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\helpers\\bdloginutils.h", "bdLoginUtils::getUmbrellaUrl", 0xC8u, "Unknown environment (%u): Defaulting to DEV Umbrella URL", Environment);
  }
  v12 = "dev";
LABEL_17:
  bdSnprintf(buf, 0x200ui64, v15, v12);
  ClientID = bdLoginResult::getClientID(this->m_loginResult);
  bdSnprintf(this->m_url, 0x200ui64, "%s/v1.0/tokens/lsg/?client=%s", buf, ClientID);
  bdBase64::encode(this->m_loginResult->m_data, 0x80u, this->m_authTicketB64, 0xADu);
  bdSnprintf(src, 0x20ui64, "%u", this->m_loginResult->m_IVSeed);
  bdHandleAssert(1, "s != BD_NULL", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdplatform\\bdplatformstring\\bdplatformstring.inl", "bdStrlen", 0x110u, "null ptr in bdStrlen");
  do
    ++v8;
  while ( src[v8] );
  bdBase64::encode(src, v8, this->m_ivSeedB64, 0x20u);
  bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::buildUmbrellaLoginReq", 0x9Cu, "Setting state to READY");
  bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
  this->m_umbrellaStatusCode = NOT_CONNECTED;
  bdStrlcpy(this->m_umbrellaStatusMessage, "Built request for Umbrella legacy login", 0x400ui64);
  bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::buildUmbrellaLoginReq", 0x9Eu, "Built request for Umbrella legacy login");
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::cancelRemoteTask
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::cancelRemoteTask(bdLoginTaskUmbrellaLegacyLogin *this)
{
  bdRemoteTask *m_ptr; 

  m_ptr = this->m_remoteTask.m_ptr;
  if ( m_ptr )
    bdRemoteTask::cancelTask(m_ptr);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::clearBuffers
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::clearBuffers(bdLoginTaskUmbrellaLegacyLogin *this)
{
  memset_0(this->m_httpRequestBuffer, 0, this->m_requestBufferSize);
  memset_0(this->m_httpResponseBuffer, 0, this->m_responseBufferSize);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::createUmbrellaLoginJson
==============
*/
bool bdLoginTaskUmbrellaLegacyLogin::createUmbrellaLoginJson(bdLoginTaskUmbrellaLegacyLogin *this, bdJSONSerializer *umbrellaLoginJSON)
{
  bdJSONSerializer::writeBeginObject(umbrellaLoginJSON);
  return bdJSONSerializer::writeString(umbrellaLoginJSON, "ticket", this->m_authTicketB64) && bdJSONSerializer::writeString(umbrellaLoginJSON, "initialVectorSeed", this->m_ivSeedB64) && bdJSONSerializer::writeUInt32(umbrellaLoginJSON, "titleID", this->m_loginResult->m_titleID, 0) && bdJSONSerializer::writeEndObject(umbrellaLoginJSON);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::getFailedTask
==============
*/
bdReference<bdRemoteTask> *bdLoginTaskUmbrellaLegacyLogin::getFailedTask(bdLoginTaskUmbrellaLegacyLogin *this, bdReference<bdRemoteTask> *result)
{
  bdRemoteTask *v3; 
  bdRemoteTask *v4; 
  bdRemoteTask *v5; 

  v3 = (bdRemoteTask *)bdMemory::allocate(0x68ui64);
  if ( v3 )
  {
    bdRemoteTask::bdRemoteTask(v3);
    v5 = v4;
  }
  else
  {
    v5 = NULL;
  }
  result->m_ptr = v5;
  if ( v5 )
    _InterlockedExchangeAdd((volatile signed __int32 *)&v5->m_refCount, 1u);
  result->m_ptr->m_status = BD_FAILED;
  result->m_ptr->m_errorCode = BD_START_TASK_FAILED;
  return result;
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::getNewTask
==============
*/
bdReference<bdRemoteTask> *bdLoginTaskUmbrellaLegacyLogin::getNewTask(bdLoginTaskUmbrellaLegacyLogin *this, bdReference<bdRemoteTask> *result)
{
  bdRemoteTask *v3; 
  bdRemoteTask *v4; 
  bdRemoteTask *v5; 
  bdRandom v7; 
  int v8; 
  __int64 v9; 
  bdReference<bdRemoteTask> *v10; 
  bdRemoteTask *v11; 
  unsigned __int8 in[8]; 

  v9 = -2i64;
  v10 = result;
  v3 = NULL;
  v8 = 0;
  v4 = (bdRemoteTask *)bdMemory::allocate(0x68ui64);
  v11 = v4;
  if ( v4 )
  {
    bdRemoteTask::bdRemoteTask(v4);
    v3 = v5;
  }
  result->m_ptr = v3;
  if ( v3 )
    _InterlockedExchangeAdd((volatile signed __int32 *)&v3->m_refCount, 1u);
  v8 = 1;
  result->m_ptr->m_status = BD_PENDING;
  bdRandom::bdRandom(&v7);
  bdRandom::nextUBytes(&v7, in, 8);
  result->m_ptr->m_transactionID = *(_QWORD *)in;
  bdRandom::~bdRandom(&v7);
  return result;
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::getTaskCode
==============
*/
__int64 bdLoginTaskUmbrellaLegacyLogin::getTaskCode(bdLoginTaskUmbrellaLegacyLogin *this)
{
  return (unsigned int)this->m_umbrellaStatusCode;
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::getTaskMessage
==============
*/
char *bdLoginTaskUmbrellaLegacyLogin::getTaskMessage(bdLoginTaskUmbrellaLegacyLogin *this)
{
  return this->m_umbrellaStatusMessage;
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::parseErrorJSON
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::parseErrorJSON(bdLoginTaskUmbrellaLegacyLogin *this)
{
  char *m_httpResponseBuffer; 
  unsigned int v3; 
  unsigned int v4; 
  unsigned __int64 TransactionID; 
  unsigned int v6; 
  unsigned int v7; 
  bdJSONDeserializer value; 
  __int64 v9; 
  bdJSONDeserializer v10; 
  char v11[128]; 
  char v12[256]; 

  v9 = -2i64;
  m_httpResponseBuffer = this->m_httpResponseBuffer;
  bdJSONDeserializer::bdJSONDeserializer(&v10, this->m_httpResponseBuffer);
  bdJSONDeserializer::bdJSONDeserializer(&value);
  if ( bdJSONDeserializer::getObject(&v10, "error", &value) && value.m_type == BD_JSON_OBJECT )
  {
    v7 = 0;
    if ( value.m_parsed )
    {
      bdJSONDeserializer::getUInt32(&value, "code", &v7);
      bdJSONDeserializer::getString(&value, (const char *const)&stru_143C9A1A4, v11, 0x80u);
      bdJSONDeserializer::getString(&value, "msg", v12, 0x100u);
      v3 = v7;
      v4 = this->m_httpInterface->getLastHTTPStatus(this->m_httpInterface);
      TransactionID = bdRemoteTask::getTransactionID(this->m_remoteTask.m_ptr);
      bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::parseErrorJSON", 0xE8u, "Umbrella legacy request failed. trID: %I64u; HTTP code: %u; Error: %s; Error code: %u; Message: %s", TransactionID, v4, v11, v3, v12);
    }
    this->m_remoteTask.m_ptr->m_errorCode = BD_NO_ERROR;
  }
  else
  {
    v6 = this->m_httpInterface->getLastHTTPStatus(this->m_httpInterface);
    bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::parseErrorJSON", 0xF2u, "Umbrella legacy HTTP request failed with HTTP error code: %u. Response: %s", v6, m_httpResponseBuffer);
    this->m_remoteTask.m_ptr->m_errorCode = BD_SI_ERROR;
  }
  bdJSONDeserializer::~bdJSONDeserializer(&value);
  bdJSONDeserializer::~bdJSONDeserializer(&v10);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply(bdLoginTaskUmbrellaLegacyLogin *this)
{
  unsigned int v3; 
  unsigned int v4; 
  const char *v5; 
  double v7; 
  bdJSONDeserializer v8; 
  bdLoginTaskUmbrellaLegacyLogin::UmbrellaLegacyLoginStatusCode code; 

  bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply", 0xAFu, "Processing bdLogin Umbrella legacy login task reply");
  v3 = this->m_httpInterface->getLastHTTPStatus(this->m_httpInterface);
  v4 = v3;
  if ( v3 == 200 )
  {
    bdJSONDeserializer::bdJSONDeserializer(&v8);
    if ( bdJSONDeserializer::parse(&v8, this->m_httpResponseBuffer) && bdJSONDeserializer::isObject(&v8) )
    {
      bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply", 0xBBu, "Setting state to COMPLETED");
      bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
      this->m_umbrellaStatusCode = DISCONNECTING;
      v5 = "Got successful Umbrella Legacy Login reply";
    }
    else
    {
      bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply", 0xC0u, "Failed to process Umbrella Legacy Login resposne json", 200);
      bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
      this->m_umbrellaStatusCode = CONNECTED;
      v5 = "Failed to parse Umbrella Legacy Login response json";
    }
    bdStrlcpy(this->m_umbrellaStatusMessage, v5, 0x400ui64);
    *(double *)&_XMM0 = bdStopwatch::getElapsedTimeInSeconds(&this->m_taskTimer);
    __asm
    {
      vcvtss2sd xmm1, xmm0, xmm0
      vmovsd  [rsp+78h+var_40], xmm1
    }
    bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x19Fu, "Task finished after %2.1f seconds", v7);
    bdJSONDeserializer::~bdJSONDeserializer(&v8);
  }
  else
  {
    bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply", 0xC6u, "Umbrella Legacy Login task failed with HTTP code [%u]", v3);
    bdSnprintf(this->m_umbrellaStatusMessage, 0x400ui64, "Umbrella login task failed with HTTP code [%u]", v4);
    code = CONNECTED;
    bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus(this, this->m_umbrellaStatusMessage, &code);
  }
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::pump
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::pump(bdLoginTaskUmbrellaLegacyLogin *this)
{
  bdLoginTaskUmbrellaLegacyLogin::UmbrellaLegacyLoginStatusCode m_umbrellaStatusCode; 
  __int32 v4; 
  __int32 v5; 
  double v7; 
  bdLoginTaskUmbrellaLegacyLogin::UmbrellaLegacyLoginStatusCode code; 

  m_umbrellaStatusCode = this->m_umbrellaStatusCode;
  if ( m_umbrellaStatusCode )
  {
    v4 = m_umbrellaStatusCode - 1;
    if ( v4 )
    {
      v5 = v4 - 1;
      if ( v5 )
      {
        if ( v5 == 1 )
        {
          bdLoginTaskUmbrellaLegacyLogin::processUmbrellaLoginReply(this);
        }
        else
        {
          bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::pump", 0x18Eu, "Pumping Umbrella legacy login request in an unknown state!");
          bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
          this->m_umbrellaStatusCode = CONNECTED;
          bdStrlcpy(this->m_umbrellaStatusMessage, "Pumping Umbrella legacy login request in an unknown state!", 0x400ui64);
          *(double *)&_XMM0 = bdStopwatch::getElapsedTimeInSeconds(&this->m_taskTimer);
          __asm
          {
            vcvtss2sd xmm1, xmm0, xmm0
            vmovsd  [rsp+48h+var_10], xmm1
          }
          bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x19Fu, "Task finished after %2.1f seconds", v7);
        }
      }
      else if ( this->m_remoteTask.m_ptr->getStatus(this->m_remoteTask.m_ptr) == BD_PENDING )
      {
        bdLoginTaskUmbrellaLegacyLogin::pumpRemoteTask(this);
      }
      else
      {
        bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::pump", 0x185u, "Setting state to RECEIVED_REPLY");
        code = WAITING_FOR_REPORT_CONSOLE_DETAILS;
        bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus(this, "Got a reply from legacy login request to Umbrella", &code);
      }
    }
    else
    {
      bdLoginTaskUmbrellaLegacyLogin::startLoginTask(this);
      bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::pump", 0x178u, "Setting state to PENDING");
      bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
      this->m_umbrellaStatusCode = CONNECTING;
      bdStrlcpy(this->m_umbrellaStatusMessage, "Started umbrella legacy login", 0x400ui64);
    }
  }
  else
  {
    bdStopwatch::start(&this->m_taskTimer);
    bdLoginTaskUmbrellaLegacyLogin::buildUmbrellaLoginReq(this);
  }
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::pumpRemoteTask
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::pumpRemoteTask(bdLoginTaskUmbrellaLegacyLogin *this)
{
  bdRemoteTask *m_ptr; 
  int v3; 
  unsigned int v4; 
  unsigned int v5; 
  unsigned __int64 TransactionID; 
  unsigned int v7; 
  unsigned int v8; 
  bdJSONDeserializer value; 
  bdJSONDeserializer v10; 
  __int64 v11; 
  char v12[128]; 
  char v13[256]; 

  v11 = -2i64;
  m_ptr = this->m_remoteTask.m_ptr;
  if ( m_ptr && m_ptr->getStatus(m_ptr) && this->m_remoteTask.m_ptr->getStatus(this->m_remoteTask.m_ptr) != BD_DONE )
  {
    if ( this->m_remoteTask.m_ptr->getStatus(this->m_remoteTask.m_ptr) == BD_CANCELLED && this->m_remoteTask.m_ptr )
    {
      if ( this->m_httpInterface->getStatus(this->m_httpInterface) != (BD_MAX_STATUS|BD_PENDING) )
      {
        bdLogMessage(BD_LOG_WARNING, "warn/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::pumpRemoteTask", 0x145u, "Aborting HTTP operation");
        this->m_httpInterface->abortOperation(this->m_httpInterface);
      }
      bdRemoteTask::cancelTask(this->m_remoteTask.m_ptr);
    }
    v3 = ((__int64 (__fastcall *)(bdHTTP *))this->m_httpInterface->getStatus)(this->m_httpInterface) - 5;
    if ( v3 )
    {
      if ( v3 != 1 )
        return;
      this->m_remoteTask.m_ptr->m_status = BD_FAILED;
      bdJSONDeserializer::bdJSONDeserializer(&v10, this->m_httpResponseBuffer);
      bdJSONDeserializer::bdJSONDeserializer(&value);
      if ( bdJSONDeserializer::getObject(&v10, "error", &value) && value.m_type == BD_JSON_OBJECT )
      {
        v8 = 0;
        if ( value.m_parsed )
        {
          bdJSONDeserializer::getUInt32(&value, "code", &v8);
          bdJSONDeserializer::getString(&value, (const char *const)&stru_143C9A1A4, v12, 0x80u);
          bdJSONDeserializer::getString(&value, "msg", v13, 0x100u);
          v4 = v8;
          v5 = this->m_httpInterface->getLastHTTPStatus(this->m_httpInterface);
          TransactionID = bdRemoteTask::getTransactionID(this->m_remoteTask.m_ptr);
          bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::parseErrorJSON", 0xE8u, "Umbrella legacy request failed. trID: %I64u; HTTP code: %u; Error: %s; Error code: %u; Message: %s", TransactionID, v5, v12, v4, v13);
        }
        this->m_remoteTask.m_ptr->m_errorCode = BD_NO_ERROR;
      }
      else
      {
        v7 = this->m_httpInterface->getLastHTTPStatus(this->m_httpInterface);
        bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::parseErrorJSON", 0xF2u, "Umbrella legacy HTTP request failed with HTTP error code: %u. Response: %s", v7, this->m_httpResponseBuffer);
        this->m_remoteTask.m_ptr->m_errorCode = BD_SI_ERROR;
      }
      bdJSONDeserializer::~bdJSONDeserializer(&value);
    }
    else
    {
      this->m_remoteTask.m_ptr->m_status = BD_DONE;
      if ( !this->m_outputObject )
      {
LABEL_21:
        this->m_outputObject = NULL;
        return;
      }
      bdJSONDeserializer::bdJSONDeserializer(&v10, this->m_httpResponseBuffer);
      this->m_outputObject->deserializeFromJSON(this->m_outputObject, &v10);
    }
    bdJSONDeserializer::~bdJSONDeserializer(&v10);
    goto LABEL_21;
  }
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::readyForRequest
==============
*/
_BOOL8 bdLoginTaskUmbrellaLegacyLogin::readyForRequest(bdLoginTaskUmbrellaLegacyLogin *this)
{
  bdHTTP::bdStatus v1; 
  bool v2; 

  v1 = this->m_httpInterface->getStatus(this->m_httpInterface);
  v2 = v1 != BD_FAILED;
  if ( v1 == BD_FAILED )
    bdLogMessage(BD_LOG_ERROR, (const char *const)&other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::readyForRequest", 0x47u, "Only one Umbrella legacy request can happen at a time.");
  return v2;
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::reset
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::reset(bdLoginTaskUmbrellaLegacyLogin *this)
{
  bdHTTP *m_httpInterface; 
  bdHTTP *v3; 
  bdRemoteTask *m_ptr; 
  bdRemoteTask *v5; 
  bdRemoteTask *v6; 

  m_httpInterface = this->m_httpInterface;
  if ( m_httpInterface )
  {
    m_httpInterface->abortOperation(m_httpInterface);
    v3 = this->m_httpInterface;
    if ( v3 )
      ((void (__fastcall *)(bdHTTP *, __int64))v3->~bdHTTP)(v3, 1i64);
    this->m_httpInterface = NULL;
  }
  m_ptr = this->m_remoteTask.m_ptr;
  if ( m_ptr )
    bdRemoteTask::cancelTask(m_ptr);
  memset_0(this->m_httpRequestBuffer, 0, this->m_requestBufferSize);
  memset_0(this->m_httpResponseBuffer, 0, this->m_responseBufferSize);
  v5 = this->m_remoteTask.m_ptr;
  if ( v5 )
  {
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)&v5->m_refCount, 0xFFFFFFFF) == 1 )
    {
      v6 = this->m_remoteTask.m_ptr;
      if ( v6 )
        ((void (__fastcall *)(bdRemoteTask *, __int64))v6->~bdReferencable)(v6, 1i64);
    }
  }
  this->m_remoteTask.m_ptr = NULL;
  this->m_umbrellaStatusCode = UNINITIALIZED;
  memset_0(this->m_umbrellaStatusMessage, 0, sizeof(this->m_umbrellaStatusMessage));
  memset_0(this->m_authTicketB64, 0, 0x80ui64);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::resetHttpInterface
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::resetHttpInterface(bdLoginTaskUmbrellaLegacyLogin *this)
{
  bdHTTP *m_httpInterface; 
  bdHTTP *v3; 

  m_httpInterface = this->m_httpInterface;
  if ( m_httpInterface )
  {
    m_httpInterface->abortOperation(m_httpInterface);
    v3 = this->m_httpInterface;
    if ( v3 )
      ((void (__fastcall *)(bdHTTP *, __int64))v3->~bdHTTP)(v3, 1i64);
    this->m_httpInterface = NULL;
  }
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::startLoginTask
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::startLoginTask(bdLoginTaskUmbrellaLegacyLogin *this)
{
  __int64 v3; 
  bdHTTP::bdStatus v4; 
  bool v5; 
  bdRemoteTask *v7; 
  __int64 v8; 
  __int64 v9; 
  bdRemoteTask *v10; 
  __int64 v11; 
  bdHTTP *m_httpInterface; 
  unsigned int v13; 
  bdHTTP *v14; 
  bool (__fastcall *setHeader)(bdHTTP *, const char *, const unsigned __int64); 
  unsigned __int64 v16; 
  unsigned __int64 v18; 
  bdRemoteTask *v20; 
  __int64 v21; 
  double v23; 
  unsigned __int64 TransactionID; 
  double v25; 
  double v26; 
  unsigned __int64 v27; 
  bdRandom v28[2]; 
  bdReference<bdRemoteTask> v29; 
  bdReference<bdRemoteTask> other; 
  bdReference<bdRemoteTask> v31; 
  bdRemoteTask *v32; 
  __int64 v33; 
  bdJSONSerializer v34; 
  unsigned __int8 in[8]; 

  v33 = -2i64;
  v3 = 0i64;
  v4 = this->m_httpInterface->getStatus(this->m_httpInterface);
  v5 = v4 != BD_FAILED;
  if ( v4 == BD_FAILED )
    bdLogMessage(BD_LOG_ERROR, (const char *const)&::other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::readyForRequest", 0x47u, "Only one Umbrella legacy request can happen at a time.");
  if ( !v5 )
  {
    bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
    this->m_umbrellaStatusCode = CONNECTED;
    bdStrlcpy(this->m_umbrellaStatusMessage, "Another Umbrella Login request is already in process", 0x400ui64);
    *(double *)&_XMM0 = bdStopwatch::getElapsedTimeInSeconds(&this->m_taskTimer);
    __asm
    {
      vcvtss2sd xmm1, xmm0, xmm0
      vmovsd  [rsp+1C0h+var_188], xmm1
    }
    bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x19Fu, "Task finished after %2.1f seconds", v23);
    bdLogMessage(BD_LOG_ERROR, (const char *const)&::other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::startLoginTask", 0xFDu, "Another Umbrella Login request is already in process");
    v7 = (bdRemoteTask *)bdMemory::allocate(0x68ui64);
    v29.m_ptr = v7;
    if ( v7 )
    {
      bdRemoteTask::bdRemoteTask(v7);
      v9 = v8;
    }
    else
    {
      v9 = 0i64;
    }
    other.m_ptr = (bdRemoteTask *)v9;
    if ( v9 )
      _InterlockedExchangeAdd((volatile signed __int32 *)(v9 + 8), 1u);
    *(_DWORD *)(v9 + 28) = 3;
    *(_DWORD *)(v9 + 80) = 5;
    bdReference<bdRemoteTask>::operator=(&this->m_remoteTask, &other);
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v9 + 8), 0xFFFFFFFF) == 1 )
      (**(void (__fastcall ***)(__int64, __int64))v9)(v9, 1i64);
  }
  memset_0(this->m_httpRequestBuffer, 0, this->m_requestBufferSize);
  memset_0(this->m_httpResponseBuffer, 0, this->m_responseBufferSize);
  bdJSONSerializer::bdJSONSerializer(&v34);
  bdJSONSerializer::setBuffer(&v34, this->m_httpRequestBuffer, this->m_requestBufferSize);
  bdJSONSerializer::writeBeginObject(&v34);
  if ( bdJSONSerializer::writeString(&v34, "ticket", this->m_authTicketB64) && bdJSONSerializer::writeString(&v34, "initialVectorSeed", this->m_ivSeedB64) && bdJSONSerializer::writeUInt32(&v34, "titleID", this->m_loginResult->m_titleID, 0) && bdJSONSerializer::writeEndObject(&v34) )
  {
    v10 = (bdRemoteTask *)bdMemory::allocate(0x68ui64);
    v32 = v10;
    if ( v10 )
    {
      bdRemoteTask::bdRemoteTask(v10);
      v3 = v11;
    }
    v31.m_ptr = (bdRemoteTask *)v3;
    if ( v3 )
      _InterlockedExchangeAdd((volatile signed __int32 *)(v3 + 8), 1u);
    *(_DWORD *)(v3 + 28) = 1;
    bdRandom::bdRandom(&v28[1]);
    bdRandom::nextUBytes(&v28[1], in, 8);
    *(_QWORD *)(v3 + 72) = *(_QWORD *)in;
    bdRandom::~bdRandom(&v28[1]);
    bdReference<bdRemoteTask>::operator=(&this->m_remoteTask, &v31);
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v3 + 8), 0xFFFFFFFF) == 1 )
      (**(void (__fastcall ***)(__int64, __int64))v3)(v3, 1i64);
    this->m_outputObject = &this->m_loginResult->m_umbrellaAccount;
    if ( ((unsigned __int8 (__fastcall *)(bdHTTP *, __int64, char *))this->m_httpInterface->initRequest)(this->m_httpInterface, 3i64, this->m_url) && (m_httpInterface = this->m_httpInterface, v13 = bdJSONSerializer::length(&v34), bdHTTP::setUploadData(m_httpInterface, this->m_httpRequestBuffer, v13)) && bdHTTP::setDownloadBuffer(this->m_httpInterface, this->m_httpResponseBuffer, this->m_responseBufferSize) && (v14 = this->m_httpInterface, setHeader = v14->setHeader, v16 = bdRemoteTask::getTransactionID(this->m_remoteTask.m_ptr), setHeader(v14, "X-TransactionID", v16)) && this->m_httpInterface->setHeader(this->m_httpInterface, "Content-Type", "application/json") && this->m_httpInterface->setHeader(this->m_httpInterface, "Accept", "application/json") )
    {
      this->m_httpInterface->sendRequest(this->m_httpInterface);
      if ( this->m_remoteTask.m_ptr->getStatus(this->m_remoteTask.m_ptr) == BD_PENDING )
      {
        bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::startLoginTask", 0x123u, "Setting state to PENDING");
        bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
        this->m_umbrellaStatusCode = CONNECTING;
        bdStrlcpy(this->m_umbrellaStatusMessage, "Sent legacy login request to Umbrella", 0x400ui64);
        TransactionID = bdRemoteTask::getTransactionID(this->m_remoteTask.m_ptr);
        bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::startLoginTask", 0x127u, "Started call to Umbrella authentication. TransactionID: (%I64u)", TransactionID);
      }
      else
      {
        bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
        this->m_umbrellaStatusCode = CONNECTED;
        bdStrlcpy(this->m_umbrellaStatusMessage, "Got into unexpected state starting the Umbrella legacy login request", 0x400ui64);
        *(double *)&_XMM0 = bdStopwatch::getElapsedTimeInSeconds(&this->m_taskTimer);
        __asm
        {
          vcvtss2sd xmm1, xmm0, xmm0
          vmovsd  [rsp+1C0h+var_188], xmm1
        }
        bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x19Fu, "Task finished after %2.1f seconds", v25);
        v18 = bdRemoteTask::getTransactionID(this->m_remoteTask.m_ptr);
        bdLogMessage(BD_LOG_ERROR, (const char *const)&::other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::startLoginTask", 0x12Eu, "Got into unexpected state starting the Umbrella legacy login request. TransactionID: (%I64u)", v18);
      }
    }
    else
    {
      bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
      this->m_umbrellaStatusCode = CONNECTED;
      bdStrlcpy(this->m_umbrellaStatusMessage, "Encountered error while attempting to build request for Legacy Umbrella Login", 0x400ui64);
      *(double *)&_XMM0 = bdStopwatch::getElapsedTimeInSeconds(&this->m_taskTimer);
      __asm
      {
        vcvtss2sd xmm1, xmm0, xmm0
        vmovsd  [rsp+1C0h+var_188], xmm1
      }
      bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x19Fu, "Task finished after %2.1f seconds", v26);
      bdLogMessage(BD_LOG_ERROR, (const char *const)&::other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::startLoginTask", 0x11Du, "Encountered error while attempting to build request for Legacy Umbrella Login");
    }
  }
  else
  {
    bdLogMessage(BD_LOG_ERROR, (const char *const)&::other, "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::startLoginTask", 0x133u, "Failed to serialize JSON for Umbrella Legacy Login request");
    v20 = (bdRemoteTask *)bdMemory::allocate(0x68ui64);
    v32 = v20;
    if ( v20 )
    {
      bdRemoteTask::bdRemoteTask(v20);
      v3 = v21;
    }
    v29.m_ptr = (bdRemoteTask *)v3;
    if ( v3 )
      _InterlockedExchangeAdd((volatile signed __int32 *)(v3 + 8), 1u);
    *(_DWORD *)(v3 + 28) = 3;
    *(_DWORD *)(v3 + 80) = 5;
    bdReference<bdRemoteTask>::operator=(&this->m_remoteTask, &v29);
    if ( _InterlockedExchangeAdd((volatile signed __int32 *)(v3 + 8), 0xFFFFFFFF) == 1 )
      (**(void (__fastcall ***)(__int64, __int64))v3)(v3, 1i64);
    bdHandleAssert(1, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
    this->m_umbrellaStatusCode = CONNECTED;
    bdStrlcpy(this->m_umbrellaStatusMessage, "Failed to serialize JSON for Umbrella Legacy Login request", 0x400ui64);
    *(double *)&_XMM0 = bdStopwatch::getElapsedTimeInSeconds(&this->m_taskTimer);
    __asm
    {
      vcvtss2sd xmm1, xmm0, xmm0
      vmovsd  [rsp+1C0h+var_188], xmm1
    }
    bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x19Fu, "Task finished after %2.1f seconds", v27);
  }
  bdJSONSerializer::~bdJSONSerializer(&v34);
}

/*
==============
bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus
==============
*/
void bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus(bdLoginTaskUmbrellaLegacyLogin *this, const char *messageInfo, const bdLoginTaskUmbrellaLegacyLogin::UmbrellaLegacyLoginStatusCode *code)
{
  double v8; 

  bdHandleAssert(messageInfo != NULL, "(messageInfo != BD_NULL)", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x197u, "Must provide valid message to update Umbrella legacy login task status!");
  this->m_umbrellaStatusCode = *code;
  bdStrlcpy(this->m_umbrellaStatusMessage, messageInfo, 0x400ui64);
  if ( (unsigned int)(*code - 4) <= 1 )
  {
    *(double *)&_XMM0 = bdStopwatch::getElapsedTimeInSeconds(&this->m_taskTimer);
    __asm
    {
      vcvtss2sd xmm1, xmm0, xmm0
      vmovsd  [rsp+48h+var_10], xmm1
    }
    bdLogMessage(BD_LOG_INFO, "info/", "bdLogin", "c:\\workspace\\iw8\\code_source\\libs\\demonwareclient\\bdlobby\\bdlogin\\bdlogintask\\bdlogintaskumbrellalegacylogin.cpp", "bdLoginTaskUmbrellaLegacyLogin::updateUmbrellaLegacyLoginStatus", 0x19Fu, "Task finished after %2.1f seconds", v8);
  }
}

