/*
==============
ApplicationViewProxy::OnPointerMoved
==============
*/

void __fastcall ApplicationViewProxy::OnPointerMoved(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  ?OnPointerMoved@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVPointerEventArgs@345@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::OnPointerWheelChanged
==============
*/

void __fastcall ApplicationViewProxy::OnPointerWheelChanged(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  ?OnPointerWheelChanged@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVPointerEventArgs@345@@Z(this, sender, args);
}

/*
==============
XB3LaunchDataFileNameCreate
==============
*/

bool __fastcall XB3LaunchDataFileNameCreate(char *buffer, const unsigned __int64 bufferSize)
{
  return ?XB3LaunchDataFileNameCreate@@YA_NPEAD_K@Z(buffer, bufferSize);
}

/*
==============
ApplicationViewProxy::OnPointerReleased
==============
*/

void __fastcall ApplicationViewProxy::OnPointerReleased(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  ?OnPointerReleased@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVPointerEventArgs@345@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::OnSuspending
==============
*/

void __fastcall ApplicationViewProxy::OnSuspending(ApplicationViewProxy *this, Platform::Object *sender, Windows::ApplicationModel::SuspendingEventArgs *args)
{
  ?OnSuspending@ApplicationViewProxy@@IE$AAAXPE$AAVObject@Platform@@PE$AAVSuspendingEventArgs@ApplicationModel@Windows@@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::OnPointerExited
==============
*/

void __fastcall ApplicationViewProxy::OnPointerExited(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  ?OnPointerExited@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVPointerEventArgs@345@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::ParsePLM
==============
*/

void __fastcall ApplicationViewProxy::ParsePLM(ApplicationViewProxy *this)
{
  ?ParsePLM@ApplicationViewProxy@@AE$AAAXXZ(this);
}

/*
==============
FILETIME_to_TIMESTAMP
==============
*/

int __fastcall FILETIME_to_TIMESTAMP(const _FILETIME *ft)
{
  return ?FILETIME_to_TIMESTAMP@@YAJAEBU_FILETIME@@@Z(ft);
}

/*
==============
ApplicationViewProxy::ParseApplicationArgs
==============
*/

void __fastcall ApplicationViewProxy::ParseApplicationArgs(ApplicationViewProxy *this, Windows::ApplicationModel::Activation::IActivatedEventArgs *args)
{
  ?ParseApplicationArgs@ApplicationViewProxy@@AE$AAAXPE$AAUIActivatedEventArgs@Activation@ApplicationModel@Windows@@@Z(this, args);
}

/*
==============
ApplicationViewProxy::ProcessEvents
==============
*/

Windows::UI::Core::CoreDispatcher *__fastcall ApplicationViewProxy::ProcessEvents(ApplicationViewProxy *this)
{
  return ?ProcessEvents@ApplicationViewProxy@@AE$AAAPE$AAVCoreDispatcher@Core@UI@Windows@@XZ(this);
}

/*
==============
ApplicationViewProxy::ApplicationViewProxy
==============
*/

void __fastcall ApplicationViewProxy::ApplicationViewProxy(ApplicationViewProxy *this)
{
  ??0ApplicationViewProxy@@QE$AAA@XZ(this);
}

/*
==============
ApplicationViewProxy::WaitForPLM
==============
*/

void __fastcall ApplicationViewProxy::WaitForPLM(ApplicationViewProxy *this)
{
  ?WaitForPLM@ApplicationViewProxy@@AE$AAAXXZ(this);
}

/*
==============
XB3LaunchDataValidateTimeStamp
==============
*/

bool __fastcall XB3LaunchDataValidateTimeStamp(const int timeStamp)
{
  return ?XB3LaunchDataValidateTimeStamp@@YA_NJ@Z(timeStamp);
}

/*
==============
ApplicationViewProxy::GetViewSource
==============
*/

void __fastcall ApplicationViewProxy::GetViewSource(ApplicationViewProxy *this)
{
  ?GetViewSource@ApplicationViewProxy@@AE$AAAXXZ(this);
}

/*
==============
ApplicationViewProxy::OnWindowClosed
==============
*/

void __fastcall ApplicationViewProxy::OnWindowClosed(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::CoreWindowEventArgs *args)
{
  ?OnWindowClosed@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVCoreWindowEventArgs@345@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::ParseGameModeFromURI
==============
*/

bool __fastcall ApplicationViewProxy::ParseGameModeFromURI(ApplicationViewProxy *this, const char *uri)
{
  return ?ParseGameModeFromURI@ApplicationViewProxy@@AE$AAA_NPEBD@Z(this, uri);
}

/*
==============
ApplicationViewProxy::Restart
==============
*/

void __fastcall ApplicationViewProxy::Restart(ApplicationViewProxy *this, int __formal)
{
  ?Restart@ApplicationViewProxy@@AE$AAAXH@Z(this, __formal);
}

/*
==============
ApplicationViewProxy::ParsePayloadFromCrossLaunch
==============
*/

bool __fastcall ApplicationViewProxy::ParsePayloadFromCrossLaunch(ApplicationViewProxy *this, const char *uri)
{
  return ?ParsePayloadFromCrossLaunch@ApplicationViewProxy@@AE$AAA_NPEBD@Z(this, uri);
}

/*
==============
ApplicationViewProxy::OnWindowActivatedChanged
==============
*/

void __fastcall ApplicationViewProxy::OnWindowActivatedChanged(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::WindowActivatedEventArgs *args)
{
  ?OnWindowActivatedChanged@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVWindowActivatedEventArgs@345@@Z(this, sender, args);
}

/*
==============
XB3LaunchDataFileWrite
==============
*/

bool __fastcall XB3LaunchDataFileWrite(const XB3LaunchData *launchData)
{
  return ?XB3LaunchDataFileWrite@@YA_NAEBUXB3LaunchData@@@Z(launchData);
}

/*
==============
ApplicationViewProxy::OnCharacterReceived
==============
*/

void __fastcall ApplicationViewProxy::OnCharacterReceived(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::CharacterReceivedEventArgs *args)
{
  ?OnCharacterReceived@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVCharacterReceivedEventArgs@345@@Z(this, sender, args);
}

/*
==============
XuidFromXboxUserId
==============
*/

unsigned __int64 __fastcall XuidFromXboxUserId(Platform::String *aXboxUserId)
{
  return ?XuidFromXboxUserId@@YA_KPE$AAVString@Platform@@@Z(aXboxUserId);
}

/*
==============
XB3LaunchDataFileRead
==============
*/

bool __fastcall XB3LaunchDataFileRead(XB3LaunchData *launchData)
{
  return ?XB3LaunchDataFileRead@@YA_NPEAUXB3LaunchData@@@Z(launchData);
}

/*
==============
ApplicationViewProxy::OnResuming
==============
*/

void __fastcall ApplicationViewProxy::OnResuming(ApplicationViewProxy *this, Platform::Object *sender, Platform::Object *args)
{
  ?OnResuming@ApplicationViewProxy@@IE$AAAXPE$AAVObject@Platform@@0@Z(this, sender, args);
}

/*
==============
XB3LaunchDataFromProtocolActivation
==============
*/

bool __fastcall XB3LaunchDataFromProtocolActivation(XB3LaunchData *launchData)
{
  return ?XB3LaunchDataFromProtocolActivation@@YA_NAEAUXB3LaunchData@@@Z(launchData);
}

/*
==============
ApplicationViewProxy::OnVisibilityChanged
==============
*/

void __fastcall ApplicationViewProxy::OnVisibilityChanged(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::VisibilityChangedEventArgs *args)
{
  ?OnVisibilityChanged@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVVisibilityChangedEventArgs@345@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::OnResourceAvailabilityChanged
==============
*/

void __fastcall ApplicationViewProxy::OnResourceAvailabilityChanged(ApplicationViewProxy *this, Platform::Object *sender, Platform::Object *args)
{
  ?OnResourceAvailabilityChanged@ApplicationViewProxy@@IE$AAAXPE$AAVObject@Platform@@0@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::DetermineExecutableName
==============
*/

void __fastcall ApplicationViewProxy::DetermineExecutableName(ApplicationViewProxy *this)
{
  ?DetermineExecutableName@ApplicationViewProxy@@AE$AAAXXZ(this);
}

/*
==============
ApplicationViewProxy::OnKeyDown
==============
*/

void __fastcall ApplicationViewProxy::OnKeyDown(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::KeyEventArgs *args)
{
  ?OnKeyDown@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVKeyEventArgs@345@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::ProcessLaunchData
==============
*/

void __fastcall ApplicationViewProxy::ProcessLaunchData(ApplicationViewProxy *this, Windows::ApplicationModel::Activation::IActivatedEventArgs *args)
{
  ?ProcessLaunchData@ApplicationViewProxy@@AE$AAAXPE$AAUIActivatedEventArgs@Activation@ApplicationModel@Windows@@@Z(this, args);
}

/*
==============
ApplicationViewProxy::OnPointerPressed
==============
*/

void __fastcall ApplicationViewProxy::OnPointerPressed(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  ?OnPointerPressed@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVPointerEventArgs@345@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::OnAcceleratorKeyActivated
==============
*/

void __fastcall ApplicationViewProxy::OnAcceleratorKeyActivated(ApplicationViewProxy *this, Windows::UI::Core::CoreDispatcher *sender, Windows::UI::Core::AcceleratorKeyEventArgs *args)
{
  ?OnAcceleratorKeyActivated@ApplicationViewProxy@@IE$AAAXPE$AAVCoreDispatcher@Core@UI@Windows@@PE$AAVAcceleratorKeyEventArgs@345@@Z(this, sender, args);
}

/*
==============
ApplicationViewProxy::OnKeyUp
==============
*/

void __fastcall ApplicationViewProxy::OnKeyUp(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::KeyEventArgs *args)
{
  ?OnKeyUp@ApplicationViewProxy@@IE$AAAXPE$AAVCoreWindow@Core@UI@Windows@@PE$AAVKeyEventArgs@345@@Z(this, sender, args);
}

/*
==============
TimerDeltaInMsec
==============
*/

unsigned __int64 __fastcall TimerDeltaInMsec(const _FILETIME startTick)
{
  return ?TimerDeltaInMsec@@YA?B_KU_FILETIME@@@Z(startTick);
}

/*
==============
ApplicationViewProxy::OnActivated
==============
*/

void __fastcall ApplicationViewProxy::OnActivated(ApplicationViewProxy *this, Windows::ApplicationModel::Core::CoreApplicationView *applicationView, Windows::ApplicationModel::Activation::IActivatedEventArgs *args)
{
  ?OnActivated@ApplicationViewProxy@@IE$AAAXPE$AAVCoreApplicationView@Core@ApplicationModel@Windows@@PE$AAUIActivatedEventArgs@Activation@45@@Z(this, applicationView, args);
}

/*
==============
ApplicationViewProxy::ApplicationViewProxy
==============
*/
void ApplicationViewProxy::ApplicationViewProxy(ApplicationViewProxy *this)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v3; 
  HSTRING v4; 
  Platform::String *m_commandLineParams; 
  int v6; 
  HSTRING_HEADER hstringHeader; 
  HSTRING string; 
  HSTRING newString; 

  Platform::Object::Object(&this->Platform::Object);
  this->__IApplicationViewProxyPublicNonVirtuals::Platform::Object::__vftable = (ApplicationViewProxy_vtbl *)&ApplicationViewProxy::`vftable'{for `__IApplicationViewProxyPublicNonVirtuals'};
  this->Windows::ApplicationModel::Core::IFrameworkView::Platform::Object::__vftable = (Windows::ApplicationModel::Core::IFrameworkView_vtbl *)&ApplicationViewProxy::`vftable'{for `Windows::ApplicationModel::Core::IFrameworkView'};
  this->Platform::Object::__vftable = (Platform::Object_vtbl *)&ApplicationViewProxy::`vftable'{for `Platform::Object'};
  this->Platform::Details::IWeakReferenceSource::__abi_IUnknown::__vftable = (Platform::Details::IWeakReferenceSource_vtbl *)&ApplicationViewProxy::`vftable'{for `__abi_IUnknown'};
  this->Platform::Details::IWeakReferenceSource::Platform::Object::__vftable = (Platform::Object_vtbl *)&ApplicationViewProxy::`vftable'{for `Platform::Object's `Platform::Details::IWeakReferenceSource'};
  this->__abi_reference_count.__pUnkMarshal = (__abi_IUnknown *volatile)-1i64;
  if ( __abi_module )
    __abi_module->__abi_IncrementObjectCount(__abi_module);
  this->m_launchData.sessionHandleId._Mypair._Myval2._Mysize = 0i64;
  this->m_launchData.sessionHandleId._Mypair._Myval2._Myres = 7i64;
  this->m_launchData.sessionHandleId._Mypair._Myval2._Bx._Buf[0] = 0;
  this->m_activationComplete = 0;
  *(_WORD *)&this->m_validAchievementProperty = 0;
  this->m_hasCrosslaunch = 0;
  this->m_assumedPartyJoin = 0;
  m_pViewEx = this->m_pViewEx;
  if ( m_pViewEx )
  {
    m_pViewEx->__abi_Release(m_pViewEx);
    this->m_pViewEx = NULL;
  }
  v3 = WindowsCreateStringReference_0(&LocaleName, 0, &hstringHeader, &string);
  if ( v3 < 0 )
    __abi_WinRTraiseException(v3);
  v4 = string;
  m_commandLineParams = this->m_commandLineParams;
  if ( m_commandLineParams != (Platform::String *)string )
  {
    if ( m_commandLineParams )
      WindowsDeleteString_0((HSTRING)m_commandLineParams);
    this->m_commandLineParams = NULL;
    if ( v4 )
    {
      v6 = WindowsDuplicateString_0(v4, &newString);
      if ( v6 < 0 )
        __abi_WinRTraiseException(v6);
      this->m_commandLineParams = (Platform::String *)newString;
    }
  }
}

/*
==============
CheckPLMAsync
==============
*/
void CheckPLMAsync()
{
  Windows::Xbox::System::User *v0; 
  Windows::Xbox::System::User *v1; 
  Windows::Xbox::System::User *v2; 
  Concurrency::task_options *v3; 
  Concurrency::task_options *v4; 
  Windows::Foundation::IAsyncOperation<Windows::Xbox::Storage::ConnectedStorageSpace _> *StorageSpaceForUserAsync; 
  Concurrency::task<void> *v6; 
  volatile signed __int32 *v7; 
  std::_Ref_count_base *Rep; 
  CheckPLMAsync::__l18::<lambda_e9a953c6b27ce72a5b4fd77db5f9690f> v9; 
  volatile signed __int32 *v10; 
  Concurrency::task<Windows::Xbox::Storage::ConnectedStorageSpace _> v11; 
  Concurrency::task_options v12; 
  Windows::Xbox::System::User *v13; 

  if ( g_PLMTestStatus == ePLMTestIsPending )
  {
    if ( g_appContextRecommendedUser )
    {
      g_appContextRecommendedUser->__abi_Release(g_appContextRecommendedUser);
      g_appContextRecommendedUser = NULL;
    }
    v13 = NULL;
    v0 = Windows::Xbox::ApplicationModel::Core::CoreApplicationContext::CurrentUser::get();
    v1 = v0;
    v2 = g_appContextRecommendedUser;
    if ( v0 != g_appContextRecommendedUser )
    {
      if ( v0 )
      {
        v0->__abi_AddRef(v0);
        v2 = g_appContextRecommendedUser;
      }
      if ( v2 )
        v2->__abi_Release(v2);
      v2 = v1;
      g_appContextRecommendedUser = v1;
    }
    if ( v1 )
    {
      v1->__abi_Release(v1);
      v2 = g_appContextRecommendedUser;
    }
    if ( v2 )
    {
      v2->__abi_AddRef(v2);
      v13 = v2;
    }
    if ( v13 )
    {
      Concurrency::task_options::task_options(&v12);
      v4 = v3;
      StorageSpaceForUserAsync = Users_GetStorageSpaceForUserAsync(v13);
      v6 = (Concurrency::task<void> *)Concurrency::create_task<Windows::Foundation::IAsyncOperation<Windows::Xbox::Storage::ConnectedStorageSpace __gc *> __gc *>(&v11, StorageSpaceForUserAsync, v4);
      Concurrency::task_Windows::Xbox::Storage::ConnectedStorageSpace___::then__lambda_e9a953c6b27ce72a5b4fd77db5f9690f___(v6, &v9);
      v7 = v10;
      if ( v10 )
      {
        if ( _InterlockedExchangeAdd(v10 + 2, 0xFFFFFFFF) == 1 )
        {
          (**(void (__fastcall ***)(volatile signed __int32 *))v7)(v7);
          if ( _InterlockedExchangeAdd(v7 + 3, 0xFFFFFFFF) == 1 )
            (*(void (__fastcall **)(volatile signed __int32 *))(*(_QWORD *)v7 + 8i64))(v7);
        }
      }
      Rep = v11._M_Impl._Rep;
      if ( v11._M_Impl._Rep )
      {
        if ( _InterlockedExchangeAdd((volatile signed __int32 *)&v11._M_Impl._Rep->_Uses, 0xFFFFFFFF) == 1 )
        {
          Rep->_Destroy(Rep);
          if ( _InterlockedExchangeAdd((volatile signed __int32 *)&Rep->_Weaks, 0xFFFFFFFF) == 1 )
            Rep->_Delete_this(Rep);
        }
      }
      if ( StorageSpaceForUserAsync )
        StorageSpaceForUserAsync->__abi_Release(StorageSpaceForUserAsync);
      v13->__abi_Release(v13);
    }
    else
    {
      BootPrintf("CheckPLMAsync: Failed because CurrentUser was nullptr!");
      g_PLMTestStatus = ePLMTestError;
    }
  }
  else
  {
    BootPrintf("CheckPLMAsync skipped because we already had a pending test!");
  }
}

/*
==============
ApplicationViewProxy::DetermineExecutableName
==============
*/
void ApplicationViewProxy::DetermineExecutableName(ApplicationViewProxy *this)
{
  char *m_executable; 
  DWORD ModuleFileNameA; 
  __int64 v3; 
  int ActivationFactoryByPCWSTR; 
  int v5; 
  HSTRING v6; 
  int v7; 
  HSTRING v8; 
  const wchar_t *StringRawBuffer_0; 
  Platform::Guid pGuid; 
  HSTRING string; 
  void *ppActivationFactory; 
  HSTRING newString; 
  __int64 v14; 

  m_executable = this->m_executable;
  memset_0(this->m_executable, 0, sizeof(this->m_executable));
  ModuleFileNameA = GetModuleFileNameA(NULL, m_executable, 0x400u);
  if ( !ModuleFileNameA )
    goto LABEL_5;
  v3 = -1i64;
  do
    ++v3;
  while ( m_executable[v3] );
  if ( !v3 )
LABEL_5:
    BootError(eBootErrorStartup, "%s: Failed to find valid application/executable name (%d)!", "ApplicationViewProxy::DetermineExecutableName", ModuleFileNameA);
  pGuid.__vftable = (Platform::Object_vtbl *)0x49DF5E1D0AACF7A4i64;
  *(_DWORD *)&pGuid.__d = 1794847872;
  *(_DWORD *)&pGuid.__h = -782320536;
  ppActivationFactory = NULL;
  ActivationFactoryByPCWSTR = __winRT::__getActivationFactoryByPCWSTR(L"Windows.ApplicationModel.Core.CoreApplication", &pGuid, &ppActivationFactory);
  if ( ActivationFactoryByPCWSTR < 0 )
    __abi_WinRTraiseException(ActivationFactoryByPCWSTR);
  string = NULL;
  v5 = (*(__int64 (__fastcall **)(void *, HSTRING *))(*(_QWORD *)ppActivationFactory + 48i64))(ppActivationFactory, &string);
  if ( v5 < 0 )
    __abi_WinRTraiseException(v5);
  v6 = string;
  if ( string )
  {
    v7 = WindowsDuplicateString_0(string, &newString);
    if ( v7 < 0 )
      __abi_WinRTraiseException(v7);
    v8 = newString;
    v6 = string;
  }
  else
  {
    v8 = NULL;
  }
  WindowsDeleteString_0(v6);
  v14 = 0i64;
  WindowsDeleteString_0(NULL);
  v14 = 0i64;
  WindowsDeleteString_0(NULL);
  if ( ppActivationFactory )
    (*(void (__fastcall **)(void *))(*(_QWORD *)ppActivationFactory + 16i64))(ppActivationFactory);
  newString = v8;
  string = NULL;
  WindowsDeleteString_0(NULL);
  StringRawBuffer_0 = WindowsGetStringRawBuffer_0(v8, NULL);
  BootPrintf("Executable \"%s\" (appId \"%S\").", m_executable, StringRawBuffer_0);
  WindowsDeleteString_0(v8);
}

/*
==============
FILETIME_to_TIMESTAMP
==============
*/
__int64 FILETIME_to_TIMESTAMP(const _FILETIME *ft)
{
  unsigned __int64 v1; 
  unsigned __int64 v2; 

  v1 = ft->dwLowDateTime + ((unsigned __int64)ft->dwHighDateTime << 32);
  if ( v1 < 0x1C0274CB7249680i64 && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\xb3\\xb3_application.cpp", 1135, ASSERT_TYPE_ASSERT, "(timeSeconds > offset)", (const char *)&queryFormat, "timeSeconds > offset") )
    __debugbreak();
  v2 = v1 / 0x989680 - 12614400000i64;
  if ( v2 >= 0x7FFFFFFF && CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\xb3\\xb3_application.cpp", 1136, ASSERT_TYPE_ASSERT, "(timeSeconds - offset < 2147483647L)", (const char *)&queryFormat, "timeSeconds - offset < LONG_MAX") )
    __debugbreak();
  return (unsigned int)v2;
}

/*
==============
ApplicationViewProxy::GetViewSource
==============
*/
void ApplicationViewProxy::GetViewSource(ApplicationViewProxy *this)
{
  IW8::IFrameworkViewEx *ApplicationView; 
  IW8::IFrameworkViewEx *v3; 
  IW8::IFrameworkViewEx *m_pViewEx; 

  ApplicationView = GetApplicationView();
  v3 = ApplicationView;
  if ( ApplicationView )
  {
    if ( ApplicationView != this->m_pViewEx )
    {
      ApplicationView->__abi_AddRef(ApplicationView);
      m_pViewEx = this->m_pViewEx;
      if ( m_pViewEx )
        m_pViewEx->__abi_Release(m_pViewEx);
      this->m_pViewEx = v3;
    }
    v3->__abi_Release(v3);
  }
  else
  {
    BootError(eBootErrorAppView, "%s: Failed to obtain IW7::IFrameworkViewEx from EXE \"%s\"!", "ApplicationViewProxy::GetViewSource", this->m_executable);
  }
}

/*
==============
ApplicationViewProxy::OnAcceleratorKeyActivated
==============
*/
void ApplicationViewProxy::OnAcceleratorKeyActivated(ApplicationViewProxy *this, Windows::UI::Core::CoreDispatcher *sender, Windows::UI::Core::AcceleratorKeyEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnAcceleratorKeyActivated(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnActivated
==============
*/
void ApplicationViewProxy::OnActivated(ApplicationViewProxy *this, Windows::ApplicationModel::Core::CoreApplicationView *applicationView, Windows::ApplicationModel::Activation::IActivatedEventArgs *args)
{
  bool v6; 
  int v7; 
  int v8; 
  EGameMode mode; 
  Windows::UI::Core::CoreWindow *v10; 
  Windows::UI::Core::CoreWindow *v11; 
  int v12; 
  IW8::IFrameworkViewEx *v13; 
  IW8::IFrameworkViewEx *v14; 
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v16; 
  int v17; 
  int v18; 
  int v19; 
  int v20; 
  int v21; 
  Windows::UI::Core::CoreWindow *v22; 
  Windows::UI::Core::CoreWindow *v23; 
  int v24; 
  int v25; 
  _FILETIME SystemTimeAsFileTime; 
  __int64 v27; 
  __int64 v28; 
  void *v29; 
  int v30; 

  v27 = -2i64;
  v6 = this->m_pViewEx != NULL;
  ApplicationViewProxy::DetermineExecutableName(this);
  ApplicationViewProxy::ParseApplicationArgs(this, args);
  LODWORD(v28) = 0;
  v7 = args->__abi_get_Kind(args, (Windows::ApplicationModel::Activation::ActivationKind *)&v28);
  if ( v7 < 0 )
    __abi_WinRTraiseException(v7);
  if ( (_DWORD)v28 == 4 )
    goto LABEL_5;
  LODWORD(v29) = 0;
  v8 = args->__abi_get_Kind(args, (Windows::ApplicationModel::Activation::ActivationKind *)&v29);
  if ( v8 < 0 )
    __abi_WinRTraiseException(v8);
  if ( !(_DWORD)v29 )
  {
LABEL_5:
    mode = this->m_launchData.mode;
    if ( (unsigned int)(mode - 4) <= 1 )
      BootReportErrorArgs(mode == eErrorModeHandleAtBoot, this->m_launchData.startupText);
  }
  if ( BootIsServicingError() )
  {
    v10 = Windows::UI::Core::CoreWindow::GetForCurrentThread();
    v11 = v10;
    v29 = v10;
    v28 = 0i64;
    if ( v10 )
    {
      v12 = v10->__abi_Activate(v10);
      if ( v12 < 0 )
        __abi_WinRTraiseException(v12);
      BootPrintf("%s: called current thread Activate() ONLY to service error.", "ApplicationViewProxy::OnActivated");
      this->m_activationComplete = 1;
      v11->__abi_Release(v11);
    }
    else
    {
      BootPrintf("%s: could not call current thread Activate() while servicing error.", "ApplicationViewProxy::OnActivated");
    }
  }
  else
  {
    if ( !this->m_validRestartLaunchDataFromFile && !this->m_validAchievementProperty && !this->m_hasCrosslaunch )
    {
      ApplicationViewProxy::WaitForPLM(this);
      if ( !this->m_validRestartLaunchDataFromFile && g_PLMTestStatus == ePLMTestComplete && PLM_IsValid(&s_PLMDataBootstrap) )
        this->m_launchData.mode = s_PLMDataBootstrap.gameMode;
    }
    if ( this->m_pViewEx )
      goto LABEL_28;
    BootPrintf("%s: loading Framework View....", "ApplicationViewProxy::OnActivated");
    v13 = GetApplicationView();
    v14 = v13;
    v29 = v13;
    v28 = 0i64;
    if ( v13 )
    {
      if ( v13 != this->m_pViewEx )
      {
        v13->__abi_AddRef(v13);
        m_pViewEx = this->m_pViewEx;
        if ( m_pViewEx )
          m_pViewEx->__abi_Release(m_pViewEx);
        this->m_pViewEx = v14;
      }
      v14->__abi_Release(v14);
    }
    else
    {
      BootError(eBootErrorAppView, "%s: Failed to obtain IW7::IFrameworkViewEx from EXE \"%s\"!", "ApplicationViewProxy::GetViewSource", this->m_executable);
    }
    BootPrintf("%s: successfully loaded Framework View.", "ApplicationViewProxy::OnActivated");
    if ( this->m_pViewEx )
    {
LABEL_28:
      v30 = 0;
      v16 = args->__abi_get_Kind(args, (Windows::ApplicationModel::Activation::ActivationKind *)&v30);
      if ( v16 < 0 )
        __abi_WinRTraiseException(v16);
      if ( v30 )
      {
        v25 = 0;
        v19 = args->__abi_get_Kind(args, (Windows::ApplicationModel::Activation::ActivationKind *)&v25);
        if ( v19 < 0 )
          __abi_WinRTraiseException(v19);
        if ( v25 == 4 )
        {
          v20 = this->m_pViewEx->__abi_SetLaunchData(this->m_pViewEx, (unsigned __int64)&this->m_launchData, v6);
          if ( v20 < 0 )
            __abi_WinRTraiseException(v20);
        }
      }
      else if ( (unsigned int)(this->m_launchData.mode - 4) <= 1 )
      {
        v18 = this->m_pViewEx->__abi_SetLaunchData(this->m_pViewEx, (unsigned __int64)&this->m_launchData, v6);
        if ( v18 < 0 )
          __abi_WinRTraiseException(v18);
      }
      else
      {
        GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
        while ( g_PLMTestStatus == ePLMTestIsPending )
        {
          if ( TimerDeltaInMsec(SystemTimeAsFileTime) > 0x2710 )
            break;
          Sleep(0);
        }
        if ( g_PLMTestStatus == ePLMTestComplete && PLM_IsValid(&s_PLMDataBootstrap) )
        {
          v17 = this->m_pViewEx->__abi_SetPLMData(this->m_pViewEx, (unsigned __int64)&s_PLMDataBootstrap);
          if ( v17 < 0 )
            __abi_WinRTraiseException(v17);
        }
      }
      v21 = this->m_pViewEx->__abi_OnActivated(this->m_pViewEx, applicationView, args);
      if ( v21 < 0 )
        __abi_WinRTraiseException(v21);
    }
    v22 = Windows::UI::Core::CoreWindow::GetForCurrentThread();
    v23 = v22;
    v29 = v22;
    v28 = 0i64;
    if ( v22 )
    {
      v24 = v22->__abi_Activate(v22);
      if ( v24 < 0 )
        __abi_WinRTraiseException(v24);
      BootPrintf("%s: called current thread Activate().", "ApplicationViewProxy::OnActivated");
      this->m_activationComplete = 1;
      v23->__abi_Release(v23);
    }
    else
    {
      BootError(eBootErrorStartup, "%s: could not call current thread Activate(), NULL window !", "ApplicationViewProxy::OnActivated");
    }
  }
}

/*
==============
ApplicationViewProxy::OnCharacterReceived
==============
*/
void ApplicationViewProxy::OnCharacterReceived(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::CharacterReceivedEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnCharacterReceived(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnKeyDown
==============
*/
void ApplicationViewProxy::OnKeyDown(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::KeyEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnKeyDown(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnKeyUp
==============
*/
void ApplicationViewProxy::OnKeyUp(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::KeyEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnKeyUp(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnPointerExited
==============
*/
void ApplicationViewProxy::OnPointerExited(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnPointerExited(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnPointerMoved
==============
*/
void ApplicationViewProxy::OnPointerMoved(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnPointerMoved(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnPointerPressed
==============
*/
void ApplicationViewProxy::OnPointerPressed(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnPointerPressed(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnPointerReleased
==============
*/
void ApplicationViewProxy::OnPointerReleased(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnPointerReleased(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnPointerWheelChanged
==============
*/
void ApplicationViewProxy::OnPointerWheelChanged(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::PointerEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnPointerWheelChanged(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnResourceAvailabilityChanged
==============
*/
void ApplicationViewProxy::OnResourceAvailabilityChanged(ApplicationViewProxy *this, Platform::Object *sender, Platform::Object *args)
{
  Windows::UI::Core::CoreDispatcher *m_dispatcher; 
  ApplicationViewProxy::OnResourceAvailabilityChanged::__l2::<lambda_1277043a827c07a3770b2c86c1b17067> *v7; 
  __int64 v8; 
  __int64 v9; 
  int v10; 
  __int64 v11; 
  __int64 v12; 
  __int64 v13[8]; 
  ApplicationViewProxy::OnResourceAvailabilityChanged::__l2::<lambda_1277043a827c07a3770b2c86c1b17067> *v14; 

  if ( sender )
    sender->__abi_AddRef(sender);
  if ( args )
    args->__abi_AddRef(args);
  if ( !BootIsServicingError() )
  {
    m_dispatcher = this->m_dispatcher;
    if ( m_dispatcher )
    {
      v7 = (ApplicationViewProxy::OnResourceAvailabilityChanged::__l2::<lambda_1277043a827c07a3770b2c86c1b17067> *)Platform::Details::Heap::Allocate(0x18ui64, 0x130ui64);
      v14 = v7;
      this->__abi_AddRef(this);
      v13[0] = (__int64)this;
      if ( sender )
        sender->__abi_AddRef(sender);
      v13[1] = (__int64)sender;
      if ( args )
        args->__abi_AddRef(args);
      v13[2] = (__int64)args;
      Windows::UI::Core::DispatchedHandler::DispatchedHandler__lambda_1277043a827c07a3770b2c86c1b17067___(v7, (Platform::CallbackContext)v13, 2);
      v9 = v8;
      v14 = NULL;
      v10 = ((__int64 (__fastcall *)(Windows::UI::Core::CoreDispatcher *, _QWORD, __int64, ApplicationViewProxy::OnResourceAvailabilityChanged::__l2::<lambda_1277043a827c07a3770b2c86c1b17067> **, __int64, __int64))m_dispatcher->__abi_RunAsync)(m_dispatcher, 0i64, v8, &v14, -2i64, v8);
      if ( v10 < 0 )
        __abi_WinRTraiseException(v10);
      v11 = (__int64)v14;
      v12 = (__int64)v14;
      if ( v14 )
      {
        ((void (__fastcall *)(ApplicationViewProxy::OnResourceAvailabilityChanged::__l2::<lambda_1277043a827c07a3770b2c86c1b17067> *))v14->__this->__vftable)(v14);
        v11 = (__int64)v14;
      }
      if ( v11 )
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 16i64))(v11);
      if ( v12 )
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v12 + 16i64))(v12);
      if ( v9 )
        (*(void (__fastcall **)(__int64))(*(_QWORD *)v9 + 16i64))(v9);
    }
  }
  if ( sender )
    sender->__abi_Release(sender);
  if ( args )
    args->__abi_Release(args);
}

/*
==============
ApplicationViewProxy::OnResuming
==============
*/
void ApplicationViewProxy::OnResuming(ApplicationViewProxy *this, Platform::Object *sender, Platform::Object *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  BootPrintf("ApplicationViewProxy::OnResuming");
  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnResuming(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnSuspending
==============
*/
void ApplicationViewProxy::OnSuspending(ApplicationViewProxy *this, Platform::Object *sender, Windows::ApplicationModel::SuspendingEventArgs *args)
{
  int v6; 
  __int64 v7; 
  __int64 v8; 
  int v9; 
  __int64 v10; 
  __int64 v11; 
  int v12; 
  int v13; 
  __int64 v14; 
  __int64 v15; 
  __int64 v16; 
  __int64 v17; 
  __int64 v18; 

  v16 = -2i64;
  BootPrintf("ApplicationViewProxy::OnSuspending");
  if ( !BootIsServicingError() && this->m_pViewEx )
  {
    v18 = 0i64;
    v6 = args->__abi_get_SuspendingOperation(args, (Windows::ApplicationModel::SuspendingOperation **)&v18);
    if ( v6 < 0 )
      __abi_WinRTraiseException(v6);
    v7 = v18;
    v8 = v18;
    if ( v18 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v18 + 8i64))(v18);
      v7 = v18;
    }
    if ( v7 )
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 16i64))(v7);
    v15 = v8;
    v14 = 0i64;
    v9 = (*(__int64 (__fastcall **)(__int64, __int64 *))(*(_QWORD *)v8 + 48i64))(v8, &v14);
    if ( v9 < 0 )
      __abi_WinRTraiseException(v9);
    v10 = v14;
    v11 = v14;
    if ( v14 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v14 + 8i64))(v14);
      v10 = v14;
    }
    if ( v10 )
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v10 + 16i64))(v10);
    v17 = v11;
    v15 = 0i64;
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v8 + 16i64))(v8);
    v12 = this->m_pViewEx->__abi_OnSuspending(this->m_pViewEx, sender, args);
    if ( v12 < 0 )
      __abi_WinRTraiseException(v12);
    v13 = (*(__int64 (__fastcall **)(__int64))(*(_QWORD *)v11 + 48i64))(v11);
    if ( v13 < 0 )
      __abi_WinRTraiseException(v13);
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v11 + 16i64))(v11);
  }
}

/*
==============
ApplicationViewProxy::OnVisibilityChanged
==============
*/
void ApplicationViewProxy::OnVisibilityChanged(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::VisibilityChangedEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 
  int v8; 
  bool v9; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnVisibilityChanged(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
    v8 = args->__abi_get_Visible(args, &v9);
    if ( v8 < 0 )
      __abi_WinRTraiseException(v8);
    SD_OnVisibilityChanged(v9);
  }
}

/*
==============
ApplicationViewProxy::OnWindowActivatedChanged
==============
*/
void ApplicationViewProxy::OnWindowActivatedChanged(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::WindowActivatedEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnWindowActivatedChanged(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::OnWindowClosed
==============
*/
void ApplicationViewProxy::OnWindowClosed(ApplicationViewProxy *this, Windows::UI::Core::CoreWindow *sender, Windows::UI::Core::CoreWindowEventArgs *args)
{
  IW8::IFrameworkViewEx *m_pViewEx; 
  int v7; 

  if ( !BootIsServicingError() )
  {
    m_pViewEx = this->m_pViewEx;
    if ( m_pViewEx )
    {
      v7 = m_pViewEx->__abi_OnWindowClosed(m_pViewEx, sender, args);
      if ( v7 < 0 )
        __abi_WinRTraiseException(v7);
    }
  }
}

/*
==============
ApplicationViewProxy::ParseApplicationArgs
==============
*/
void ApplicationViewProxy::ParseApplicationArgs(ApplicationViewProxy *this, Windows::ApplicationModel::Activation::IActivatedEventArgs *args)
{
  int v4; 
  __int64 v5; 
  __int64 v6; 
  HSTRING v7; 
  int v8; 
  PCWSTR StringRawBuffer_0; 
  int v10; 
  int v11; 
  HSTRING v12; 
  int v13; 
  HSTRING v14; 
  int v15; 
  HSTRING v16; 
  const wchar_t *v17; 
  HSTRING v18; 
  HSTRING v19; 
  Platform::String *m_commandLineParams; 
  int v21; 
  EPLMTestStatus v22; 
  PCWSTR v23; 
  const wchar_t *v24; 
  const wchar_t *v25; 
  Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs_vtbl *v26; 
  Platform::Object *v27; 
  int v28; 
  Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs *v29; 
  HSTRING v30; 
  int v31; 
  __int64 v32; 
  Windows::Foundation::Uri *v33; 
  HSTRING v34; 
  PCWSTR v35; 
  Windows::Foundation::Uri *v36; 
  int v37; 
  HSTRING v38; 
  int v39; 
  HSTRING v40; 
  PCWSTR v41; 
  Windows::Foundation::Uri *v42; 
  HSTRING v43; 
  HSTRING v44; 
  int v45; 
  const wchar_t *v46; 
  __int64 v47; 
  rsize_t v48; 
  __int64 v49; 
  HSTRING v50; 
  int v51; 
  HSTRING v52; 
  int v53; 
  HSTRING v54; 
  HSTRING v55; 
  const wchar_t *v56; 
  __int64 v57; 
  bool v58; 
  char *v59; 
  const char *v60; 
  char *v61; 
  _BYTE *v62; 
  bool v63; 
  int v64; 
  HSTRING v65; 
  HSTRING v66; 
  HSTRING v67; 
  HSTRING v68; 
  HSTRING v69; 
  HSTRING v70; 
  __int64 v71; 
  __int64 v72; 
  HSTRING newString; 
  HSTRING v74; 
  HSTRING v75; 
  HSTRING v76[11]; 
  HSTRING string; 
  HSTRING __valueArg; 
  __int64 v79; 

  string = (HSTRING)args;
  v76[1] = (HSTRING)-2i64;
  LODWORD(__valueArg) = 0;
  v4 = args->__abi_get_Kind(args, (Windows::ApplicationModel::Activation::ActivationKind *)&__valueArg);
  if ( v4 < 0 )
    __abi_WinRTraiseException(v4);
  v79 = 0i64;
  Platform::Box<enum Windows::ApplicationModel::Activation::ActivationKind>::Box<enum Windows::ApplicationModel::Activation::ActivationKind>(NULL, (Windows::ApplicationModel::Activation::ActivationKind)__valueArg);
  v6 = v5;
  v79 = v5;
  if ( v5 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v5 + 8i64))(v5);
  if ( v6 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 16i64))(v6);
  v79 = v6;
  v7 = NULL;
  v69 = NULL;
  if ( v6 )
  {
    v8 = (**(__int64 (__fastcall ***)(__int64, void *, __int64 *))v6)(v6, &_uuidof__AVEnum_Platform__, (__int64 *)&v69);
    if ( v8 < 0 )
      __abi_WinRTraiseException(v8);
    v7 = v69;
  }
  v65 = v7;
  v67 = (HSTRING)Platform::Enum::ToString(v7);
  StringRawBuffer_0 = WindowsGetStringRawBuffer_0(v67, NULL);
  BootPrintf("ParseApplicationArgs(%ws)", StringRawBuffer_0);
  WindowsDeleteString_0(v67);
  if ( v7 )
    (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v7 + 16i64))(v7);
  if ( v6 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v6 + 16i64))(v6);
  *(_WORD *)&this->m_hasAchievement = 0;
  this->m_hasLaunchArgs = 0;
  LODWORD(v79) = 0;
  v10 = args->__abi_get_Kind(args, (Windows::ApplicationModel::Activation::ActivationKind *)&v79);
  if ( v10 < 0 )
    __abi_WinRTraiseException(v10);
  if ( !(_DWORD)v79 )
  {
    BootPrintf("ActivationKind::Launch");
    memset_0(&this->m_launchData, 0, sizeof(this->m_launchData));
    v70 = NULL;
    v11 = args->__abi_QueryInterface(args, &_uuidof__AVLaunchActivatedEventArgs_Activation_ApplicationModel_Windows__, (void **)&v70);
    if ( v11 < 0 )
      __abi_WinRTraiseException(v11);
    v12 = v70;
    string = v70;
    if ( v70 )
      (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v70 + 8i64))(v70);
    v68 = v12;
    if ( v12 )
      (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v12 + 16i64))(v12);
    v65 = NULL;
    string = NULL;
    v13 = (*(__int64 (__fastcall **)(HSTRING, HSTRING *))(*(_QWORD *)v12 + 48i64))(v12, &string);
    if ( v13 < 0 )
      __abi_WinRTraiseException(v13);
    v14 = string;
    if ( string )
    {
      v15 = WindowsDuplicateString_0(string, &newString);
      if ( v15 < 0 )
        __abi_WinRTraiseException(v15);
      v16 = newString;
      v14 = string;
    }
    else
    {
      v16 = NULL;
    }
    WindowsDeleteString_0(v14);
    v67 = v16;
    v17 = WindowsGetStringRawBuffer_0(v16, NULL);
    Platform::String::String(NULL, v17);
    v19 = v18;
    v65 = v18;
    m_commandLineParams = this->m_commandLineParams;
    if ( m_commandLineParams != (Platform::String *)v18 )
    {
      if ( m_commandLineParams )
        WindowsDeleteString_0((HSTRING)m_commandLineParams);
      this->m_commandLineParams = NULL;
      if ( v19 )
      {
        v21 = WindowsDuplicateString_0(v19, &v74);
        if ( v21 < 0 )
          __abi_WinRTraiseException(v21);
        this->m_commandLineParams = (Platform::String *)v74;
      }
    }
    WindowsDeleteString_0(v19);
    WindowsDeleteString_0(v16);
    ApplicationViewProxy::WaitForPLM(this);
    v22 = g_PLMTestStatus;
    g_PLMTestStatus = ePLMTestError;
    if ( _Platform_WindowsGetStringLen((HSTRING)this->m_commandLineParams) )
    {
      v23 = WindowsGetStringRawBuffer_0((HSTRING)this->m_commandLineParams, NULL);
      v24 = v23;
      v25 = L"null";
      if ( v23 )
        v25 = v23;
      BootPrintf("LaunchActivatedEventArgs \"%S\" passed through by shim.\n", v25);
      if ( wcsstr_0(v24, L"+set usePLM 1") )
        g_PLMTestStatus = v22;
    }
    ApplicationViewProxy::ProcessLaunchData(this, args);
    v26 = *(Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs_vtbl **)v12;
    v27 = (Platform::Object *)v12;
LABEL_109:
    v26->__abi_Release(v27);
    return;
  }
  v64 = 0;
  v28 = args->__abi_get_Kind(args, (Windows::ApplicationModel::Activation::ActivationKind *)&v64);
  if ( v28 < 0 )
    __abi_WinRTraiseException(v28);
  if ( v64 == 4 )
  {
    BootPrintf("ActivationKind::Protocol");
    v29 = NULL;
    v72 = 0i64;
    v30 = NULL;
    __valueArg = NULL;
    v71 = 0i64;
    v31 = args->__abi_QueryInterface(args, &_uuidof__AUIProtocolActivatedEventArgs_Activation_ApplicationModel_Windows__, (void **)&v71);
    v32 = v71;
    if ( v31 )
      v32 = 0i64;
    v79 = v32;
    if ( v32 )
    {
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v32 + 8i64))(v32);
      v29 = (Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs *)v32;
      v72 = v32;
    }
    if ( v32 )
      (*(void (__fastcall **)(__int64))(*(_QWORD *)v32 + 16i64))(v32);
    if ( v29 )
    {
      v33 = Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs::Uri::get(v29);
      v79 = (__int64)v33;
      v34 = (HSTRING)Windows::Foundation::IUriRuntimeClass::RawUri::get(v33);
      v68 = v34;
      v35 = WindowsGetStringRawBuffer_0(v34, NULL);
      BootPrintf("ActivationKind::Protocol params (RawUri: [%ws])", v35);
      WindowsDeleteString_0(v34);
      if ( v33 )
        v33->__abi_Release(v33);
      v36 = Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs::Uri::get(v29);
      v79 = (__int64)v36;
      v66 = NULL;
      v37 = v36->__abi_get_DisplayUri(v36, (Platform::String **)&v66);
      if ( v37 < 0 )
        __abi_WinRTraiseException(v37);
      v38 = v66;
      if ( v66 )
      {
        v39 = WindowsDuplicateString_0(v66, &v75);
        if ( v39 < 0 )
          __abi_WinRTraiseException(v39);
        v40 = v75;
        v38 = v66;
      }
      else
      {
        v40 = NULL;
      }
      WindowsDeleteString_0(v38);
      v68 = v40;
      v41 = WindowsGetStringRawBuffer_0(v40, NULL);
      BootPrintf("ActivationKind::Protocol params (DisplayUri: [%ws])", v41);
      WindowsDeleteString_0(v40);
      v36->__abi_Release(v36);
    }
    else
    {
      BootError(eBootErrorStartup, "NULL ProtocolActivatedEventArgs!");
    }
    v42 = Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs::Uri::get(v29);
    v79 = (__int64)v42;
    v43 = (HSTRING)Windows::Foundation::IUriRuntimeClass::RawUri::get(v42);
    v44 = v43;
    v68 = v43;
    if ( v43 )
    {
      __valueArg = NULL;
      v45 = WindowsDuplicateString_0(v43, v76);
      if ( v45 < 0 )
        __abi_WinRTraiseException(v45);
      v30 = v76[0];
      __valueArg = v76[0];
    }
    WindowsDeleteString_0(v44);
    if ( v42 )
      v42->__abi_Release(v42);
    v46 = WindowsGetStringRawBuffer_0(v30, NULL);
    if ( !v46 )
      BootError(eBootErrorStartup, "NULL URI in ProtocolActivatedEventArgs!");
    v47 = -1i64;
    v48 = -1i64;
    do
      ++v48;
    while ( v46[v48] );
    wcsncpy_s(s_uri, 0x800ui64, v46, v48);
    memset_0(this->m_uri, 0, sizeof(this->m_uri));
    WideCharToMultiByte(0xFDE9u, 0, s_uri, -1, this->m_uri, 2048, NULL, NULL);
    LOBYTE(v49) = 1;
    v50 = (HSTRING)__abi_details::__abi_ObjectToString(v29, v49);
    string = v50;
    if ( v50 )
    {
      v51 = WindowsDuplicateString_0(v50, &v67);
      if ( v51 < 0 )
        __abi_WinRTraiseException(v51);
      v52 = v67;
      v50 = string;
    }
    else
    {
      v52 = NULL;
    }
    WindowsDeleteString_0(v50);
    string = v52;
    if ( v52 )
    {
      v53 = WindowsDuplicateString_0(v52, &v65);
      if ( v53 < 0 )
        __abi_WinRTraiseException(v53);
      v54 = v65;
    }
    else
    {
      v54 = NULL;
    }
    v79 = (__int64)v54;
    string = v54;
    WindowsDeleteString_0(v52);
    v55 = string;
    v56 = WindowsGetStringRawBuffer_0(string, NULL);
    BootPrintf("ProtocolActivatedEventArgs \"%S\" ", v56);
    BootPrintf(" URI: \"%S\" ", s_uri);
    v57 = -1i64;
    do
      ++v57;
    while ( s_uri[v57] );
    BootPrintHex(s_uri, 2 * v57);
    BootPrintf(" 8bit: \"%s\" ", this->m_uri);
    if ( this == (ApplicationViewProxy *)-40i64 )
    {
      BootPrintf("ActivationKind::Protocol has NULL URI, assuming internal error.");
      v58 = 0;
      goto LABEL_90;
    }
    v59 = strstr_0(this->m_uri, "mode");
    if ( !v59 )
    {
      BootPrintf("ActivationKind::Protocol has no achievement URI (mode), possible Restart or Party join.");
      v58 = 0;
LABEL_89:
      v55 = string;
LABEL_90:
      this->m_hasAchievement = v58;
      if ( v58 )
      {
LABEL_107:
        WindowsDeleteString_0(v55);
        WindowsDeleteString_0(__valueArg);
        if ( !v29 )
          return;
        v26 = v29->Platform::Object::__vftable;
        v27 = v29;
        goto LABEL_109;
      }
      memset_0(this->m_crosslaunchPayload, 0, sizeof(this->m_crosslaunchPayload));
      if ( this == (ApplicationViewProxy *)-40i64 )
      {
        BootPrintf("ActivationKind::Protocol has NULL URI, assuming internal error.");
      }
      else if ( strstr_0(this->m_uri, "?") )
      {
        BootPrintf("ActivationKind::Protocol contains query in URI (?query), not valid crosslaunch URI.");
      }
      else
      {
        v61 = strstr_0(this->m_uri, "#");
        if ( v61 )
        {
          v62 = v61 + 1;
          do
            ++v47;
          while ( v62[v47] );
          if ( (unsigned int)(v47 - 1) > 0x7CE )
          {
            BootPrintf("ActivationKind::Protocol has excessive/zero URI #payload (%d), ignored.", (unsigned int)v47);
          }
          else
          {
            memcpy_0(this->m_crosslaunchPayload, v62, (unsigned int)v47);
            if ( (_DWORD)v47 == XB3SetCrossLaunchPayload(this->m_crosslaunchPayload, v47) )
            {
              v63 = 1;
              goto LABEL_105;
            }
            BootPrintf("ActivationKind::Protocol URI #payload rejected, invalid.");
          }
        }
        else
        {
          BootPrintf("ActivationKind::Protocol has no crosslaunch URI (#payload), possible Restart or Party join.");
        }
      }
      v63 = 0;
LABEL_105:
      this->m_hasCrosslaunch = v63;
      if ( !v63 )
        ApplicationViewProxy::ProcessLaunchData(this, args);
      goto LABEL_107;
    }
    v60 = v59 + 5;
    if ( strstr_0(v59 + 5, "none") )
    {
      BootPrintf("ActivationKind::Protocol has SP achievement URI.");
LABEL_87:
      this->m_launchData.mode = eFirstGameMode;
      goto LABEL_88;
    }
    if ( strstr_0(v60, "sp") )
    {
      BootPrintf("ActivationKind::Protocol has SP achievement URI.");
      this->m_launchData.mode = eGameModeSinglePlayer;
    }
    else if ( strstr_0(v60, "mp") )
    {
      BootPrintf("ActivationKind::Protocol has MP achievement URI.");
      this->m_launchData.mode = eGameModeMultiPlayer;
    }
    else
    {
      if ( !strstr_0(v60, "cp") )
      {
        BootPrintf("ActivationKind::Protocol has unknown deep-link property in URI, assuming broken Achievement launch!");
        goto LABEL_87;
      }
      BootPrintf("ActivationKind::Protocol has CP achievement URI.");
      this->m_launchData.mode = eGameModeCoop;
    }
LABEL_88:
    this->m_launchData.timestamp = 1;
    this->m_launchData.skipMovies = 0;
    this->m_validAchievementProperty = 1;
    v58 = 1;
    goto LABEL_89;
  }
}

/*
==============
ApplicationViewProxy::ParseGameModeFromURI
==============
*/
bool ApplicationViewProxy::ParseGameModeFromURI(ApplicationViewProxy *this, const char *uri)
{
  bool result; 
  char *v4; 
  const char *v5; 

  if ( !uri )
  {
    BootPrintf("ActivationKind::Protocol has NULL URI, assuming internal error.");
    return 0;
  }
  v4 = strstr_0(uri, "mode");
  if ( !v4 )
  {
    BootPrintf("ActivationKind::Protocol has no achievement URI (mode), possible Restart or Party join.");
    return 0;
  }
  v5 = v4 + 5;
  if ( strstr_0(v4 + 5, "none") )
  {
    BootPrintf("ActivationKind::Protocol has SP achievement URI.");
LABEL_14:
    this->m_launchData.mode = eFirstGameMode;
    goto LABEL_15;
  }
  if ( strstr_0(v5, "sp") )
  {
    BootPrintf("ActivationKind::Protocol has SP achievement URI.");
    this->m_launchData.mode = eGameModeSinglePlayer;
  }
  else if ( strstr_0(v5, "mp") )
  {
    BootPrintf("ActivationKind::Protocol has MP achievement URI.");
    this->m_launchData.mode = eGameModeMultiPlayer;
  }
  else
  {
    if ( !strstr_0(v5, "cp") )
    {
      BootPrintf("ActivationKind::Protocol has unknown deep-link property in URI, assuming broken Achievement launch!");
      goto LABEL_14;
    }
    BootPrintf("ActivationKind::Protocol has CP achievement URI.");
    this->m_launchData.mode = eGameModeCoop;
  }
LABEL_15:
  result = 1;
  this->m_launchData.timestamp = 1;
  this->m_launchData.skipMovies = 0;
  this->m_validAchievementProperty = 1;
  return result;
}

/*
==============
ApplicationViewProxy::ParsePLM
==============
*/
void ApplicationViewProxy::ParsePLM(ApplicationViewProxy *this)
{
  ApplicationViewProxy::WaitForPLM(this);
  if ( !this->m_validRestartLaunchDataFromFile && g_PLMTestStatus == ePLMTestComplete && PLM_IsValid(&s_PLMDataBootstrap) )
    this->m_launchData.mode = s_PLMDataBootstrap.gameMode;
}

/*
==============
ApplicationViewProxy::ParsePayloadFromCrossLaunch
==============
*/
char ApplicationViewProxy::ParsePayloadFromCrossLaunch(ApplicationViewProxy *this, const char *uri)
{
  char *m_crosslaunchPayload; 
  char *v5; 
  _BYTE *v6; 
  __int64 v7; 

  m_crosslaunchPayload = this->m_crosslaunchPayload;
  memset_0(this->m_crosslaunchPayload, 0, sizeof(this->m_crosslaunchPayload));
  if ( uri )
  {
    if ( strstr_0(uri, "?") )
    {
      BootPrintf("ActivationKind::Protocol contains query in URI (?query), not valid crosslaunch URI.");
      return 0;
    }
    else
    {
      v5 = strstr_0(uri, "#");
      if ( v5 )
      {
        v6 = v5 + 1;
        v7 = -1i64;
        do
          ++v7;
        while ( v6[v7] );
        if ( (unsigned int)(v7 - 1) > 0x7CE )
        {
          BootPrintf("ActivationKind::Protocol has excessive/zero URI #payload (%d), ignored.", (unsigned int)v7);
          return 0;
        }
        else
        {
          memcpy_0(m_crosslaunchPayload, v6, (unsigned int)v7);
          if ( (_DWORD)v7 == XB3SetCrossLaunchPayload(m_crosslaunchPayload, v7) )
          {
            return 1;
          }
          else
          {
            BootPrintf("ActivationKind::Protocol URI #payload rejected, invalid.");
            return 0;
          }
        }
      }
      else
      {
        BootPrintf("ActivationKind::Protocol has no crosslaunch URI (#payload), possible Restart or Party join.");
        return 0;
      }
    }
  }
  else
  {
    BootPrintf("ActivationKind::Protocol has NULL URI, assuming internal error.");
    return 0;
  }
}

/*
==============
ApplicationViewProxy::ProcessEvents
==============
*/
Windows::UI::Core::CoreDispatcher *ApplicationViewProxy::ProcessEvents(ApplicationViewProxy *this)
{
  Windows::UI::Core::CoreWindow *v1; 
  int v2; 
  __int64 v3; 
  __int64 v4; 
  int v5; 
  __int64 v7; 
  Windows::UI::Core::CoreWindow *v8; 
  __int64 v9; 

  Sys_ProfBeginNamedEvent(0xFF800080, "ProcessEvents");
  v1 = Windows::UI::Core::CoreWindow::GetForCurrentThread();
  v8 = v1;
  v7 = 0i64;
  v2 = v1->__abi_get_Dispatcher(v1, (Windows::UI::Core::CoreDispatcher **)&v7);
  if ( v2 < 0 )
    __abi_WinRTraiseException(v2);
  v3 = v7;
  v4 = v7;
  if ( v7 )
  {
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v7 + 8i64))(v7);
    v3 = v7;
  }
  if ( v3 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v3 + 16i64))(v3);
  v9 = v4;
  v8 = NULL;
  v1->__abi_Release(v1);
  if ( v4 )
  {
    v5 = (*(__int64 (__fastcall **)(__int64, __int64))(*(_QWORD *)v4 + 56i64))(v4, 3i64);
    if ( v5 < 0 )
      __abi_WinRTraiseException(v5);
  }
  Sys_ProfEndNamedEvent();
  v9 = 0i64;
  return (Windows::UI::Core::CoreDispatcher *)v4;
}

/*
==============
ApplicationViewProxy::ProcessLaunchData
==============
*/
void ApplicationViewProxy::ProcessLaunchData(ApplicationViewProxy *this, Windows::ApplicationModel::Activation::IActivatedEventArgs *args)
{
  XB3LaunchData *p_m_launchData; 
  bool v5; 
  int v6; 
  unsigned int v7; 
  int timestamp; 
  int v9; 
  int v10; 
  int v11; 
  Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs *v12; 
  Windows::ApplicationModel::Activation::IProtocolActivatedEventArgs *v13; 
  _FILETIME SystemTimeAsFileTime; 

  p_m_launchData = &this->m_launchData;
  v5 = XB3LaunchDataFileRead(&this->m_launchData);
  LODWORD(v13) = 0;
  v6 = args->__abi_get_Kind(args, (Windows::ApplicationModel::Activation::ActivationKind *)&v13);
  if ( v6 < 0 )
    __abi_WinRTraiseException(v6);
  if ( !v5 && (_DWORD)v13 == 4 )
  {
    BootPrintf("ActivationKind::Protocol w/o LaunchData file, assuming MP invite... ");
    XB3LaunchDataFromProtocolActivation(p_m_launchData);
  }
  BootPrintf("Successfully finished obtaining launch data.");
  v7 = remove("T:\\boot.iw8launchdata");
  if ( v7 )
  {
    BootPrintf("Failed to remove launchData file \"%s\", error(%d) ", "T:\\boot.iw8launchdata", v7);
    BootPrintf("Failed on XB3LaunchDataFileRemove( \"%s\")... !", "T:\\boot.iw8launchdata");
  }
  else
  {
    BootPrintf("Removed launchData file \"%s\" .", "T:\\boot.iw8launchdata");
  }
  BootReportLaunchData(p_m_launchData);
  timestamp = this->m_launchData.timestamp;
  if ( timestamp )
  {
    GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
    v9 = FILETIME_to_TIMESTAMP(&SystemTimeAsFileTime);
    if ( v9 >= timestamp )
    {
      v10 = v9 - timestamp;
      if ( v10 <= 60 )
      {
        this->m_validRestartLaunchDataFromFile = 1;
        goto LABEL_17;
      }
      BootPrintf("Launchdata expired (%lld seconds), ignored!", (unsigned int)v10);
    }
    else
    {
      BootPrintf("Launchdata more current than current FILETIME, ignored!");
    }
  }
  if ( (_DWORD)v13 == 4 )
  {
    BootPrintf("ActivationKind::Protocol with stale LaunchData file, assuming MP invite... ");
    XB3LaunchDataFromProtocolActivation(p_m_launchData);
  }
  else
  {
    this->m_validRestartLaunchDataFromFile = 0;
  }
LABEL_17:
  if ( this->m_launchData.fromInviteToActivitySession || this->m_launchData.fromJoinActivitySession )
  {
    v13 = NULL;
    v11 = args->__abi_QueryInterface(args, &_uuidof__AUIProtocolActivatedEventArgs_Activation_ApplicationModel_Windows__, (void **)&v13);
    v12 = v13;
    if ( v11 )
      v12 = NULL;
    SystemTimeAsFileTime = (_FILETIME)v12;
    InviteJoinHSM_xb3::HandleIncomingInvitation(&g_invitationHSM, p_m_launchData, v12);
    if ( v12 )
      v12->__abi_Release(v12);
  }
}

/*
==============
ApplicationViewProxy::Restart
==============
*/
void ApplicationViewProxy::Restart(ApplicationViewProxy *this, __int64 __formal)
{
  BootPrintf("ApplicationViewProxy::Restart", __formal);
}

/*
==============
TimerDeltaInMsec
==============
*/
unsigned __int64 TimerDeltaInMsec(const _FILETIME startTick)
{
  unsigned int dwLowDateTime; 
  unsigned __int64 v2; 
  unsigned __int64 v3; 
  unsigned int dwHighDateTime; 
  _FILETIME SystemTimeAsFileTime; 

  dwHighDateTime = startTick.dwHighDateTime;
  dwLowDateTime = startTick.dwLowDateTime;
  GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
  v2 = dwLowDateTime + ((unsigned __int64)dwHighDateTime << 32);
  v3 = SystemTimeAsFileTime.dwLowDateTime + ((unsigned __int64)SystemTimeAsFileTime.dwHighDateTime << 32);
  if ( v2 <= v3 )
    return (v3 - v2) / 0x2710;
  else
    return 0i64;
}

/*
==============
ApplicationViewProxy::WaitForPLM
==============
*/
void ApplicationViewProxy::WaitForPLM(ApplicationViewProxy *this)
{
  unsigned int dwLowDateTime; 
  unsigned __int64 v2; 
  unsigned __int64 v3; 
  unsigned __int64 v4; 
  unsigned int v5; 
  unsigned __int64 v6; 
  unsigned __int64 v7; 
  unsigned __int64 v8; 
  unsigned int dwHighDateTime; 
  _FILETIME v10; 
  _FILETIME SystemTimeAsFileTime; 
  _FILETIME v12; 

  BootPrintf("Launching blocking check for PLM and invites....");
  GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
  if ( g_PLMTestStatus == ePLMTestIsPending )
  {
    while ( 1 )
    {
      dwLowDateTime = SystemTimeAsFileTime.dwLowDateTime;
      dwHighDateTime = SystemTimeAsFileTime.dwHighDateTime;
      GetSystemTimeAsFileTime(&v10);
      v2 = dwLowDateTime + ((unsigned __int64)dwHighDateTime << 32);
      v3 = v10.dwLowDateTime + ((unsigned __int64)v10.dwHighDateTime << 32);
      if ( v2 <= v3 )
      {
        v4 = v3 - v2;
        if ( v4 >= 0x5F60810 )
          break;
      }
      Sleep(0);
      if ( g_PLMTestStatus != ePLMTestIsPending )
        goto LABEL_7;
    }
    BootPrintf("Abort blocking check for PLM after %5llu msec", v4 / 0x2710);
  }
LABEL_7:
  v5 = SystemTimeAsFileTime.dwLowDateTime;
  v10 = SystemTimeAsFileTime;
  GetSystemTimeAsFileTime(&v12);
  v6 = v5 + ((unsigned __int64)v10.dwHighDateTime << 32);
  v7 = v12.dwLowDateTime + ((unsigned __int64)v12.dwHighDateTime << 32);
  if ( v6 <= v7 )
    v8 = (v7 - v6) / 0x2710;
  else
    v8 = 0i64;
  BootPrintf("Finished blocking check for PLM after %5llu msec", v8);
}

/*
==============
XB3LaunchDataFileNameCreate
==============
*/
char XB3LaunchDataFileNameCreate(char *buffer, const unsigned __int64 bufferSize)
{
  if ( !buffer || !bufferSize )
    return 0;
  memset_0(buffer, 0, bufferSize);
  j__snprintf_s(buffer, bufferSize, 0xFFFFFFFFFFFFFFFFui64, (const char *const)&queryFormat, "T:\\boot.iw8launchdata");
  return 1;
}

/*
==============
XB3LaunchDataFileRead
==============
*/
char XB3LaunchDataFileRead(XB3LaunchData *launchData)
{
  EGameMode v3; 
  FILE *v4; 
  unsigned __int64 v5; 
  int v6; 
  char *v7; 
  __int64 v8; 
  char *v9; 
  const char *v10; 
  const char *v11; 
  const char *v12; 
  char *v13; 
  unsigned __int64 v14; 
  int v15; 
  char *v16; 
  const char *v17; 
  const char *v18; 
  char *v19; 
  const char *v20; 
  const char *v21; 
  bool v22; 
  char *v23; 
  const char *v24; 
  const char *v25; 
  bool v26; 
  char *v27; 
  const char *v28; 
  const char *v29; 
  char *v30; 
  const char *v31; 
  const char *v32; 
  char *v33; 
  const char *v34; 
  char *v35; 
  FILE *Stream; 
  unsigned __int64 v37; 
  char dest[8]; 
  __int64 v39; 
  __int64 v40; 
  __int64 v41; 
  __int64 v42; 
  __int64 v43; 
  __int64 v44; 
  __int64 v45; 
  char Str[2800]; 

  if ( !launchData )
  {
    BootPrintf("Bogus call to  XB3LaunchDataFileRead()\n");
    return 0;
  }
  v3 = eFirstGameMode;
  launchData->timestamp = 0;
  launchData->startupText[0] = 0;
  memset_0(Str, 0, 0xAE1ui64);
  Stream = NULL;
  if ( fopen_s(&Stream, "T:\\boot.iw8launchdata", "rt") || (v4 = Stream) == NULL )
  {
    BootPrintf("Failed to read from LaunchData file \"%s\" !\n", "T:\\boot.iw8launchdata");
    return 0;
  }
  v5 = 0i64;
  while ( 1 )
  {
    v6 = fgetc(v4);
    if ( v6 == -1 )
      break;
    Str[v5++] = v6;
    if ( v5 >= 0xAE0 )
      goto LABEL_10;
  }
  Str[v5] = 0;
LABEL_10:
  fclose(Stream);
  BootPrintf("Successfully read LaunchData from file \"%s\".\n", "T:\\boot.iw8launchdata");
  BootPrintf("\n%s\n\n", Str);
  v7 = strstr_0(Str, "startuptext=");
  if ( v7 )
  {
    *v7 = 0;
    Core_strcpy_truncate(launchData->startupText, 0x7D0ui64, v7 + 12);
    v8 = -1i64;
    do
      ++v8;
    while ( launchData->startupText[v8] );
    if ( v8 && launchData->startupText[v8 - 1] == 10 )
      launchData->startupText[v8 - 1] = 0;
  }
  *(_QWORD *)dest = 0i64;
  v39 = 0i64;
  v40 = 0i64;
  v41 = 0i64;
  v42 = 0i64;
  v43 = 0i64;
  v44 = 0i64;
  v45 = 0i64;
  v9 = strstr_0(Str, "timestamp=");
  v10 = "null";
  v11 = "null";
  if ( v9 )
  {
    v12 = v9 + 10;
    if ( *v12 != 10 )
      v11 = v12;
  }
  v13 = strstr_0(v11, "\n");
  if ( !v13 )
  {
    BootPrintf("Invalid LaunchData file, ignored!");
LABEL_31:
    v15 = 0;
    goto LABEL_32;
  }
  v14 = v13 - v11;
  if ( v14 >= 0x3F )
  {
    BootPrintf("Invalid LaunchData timestamp line, ignored!");
    goto LABEL_31;
  }
  Core_strncpy(dest, 0x40ui64, v11, v14);
  v15 = atol(dest);
  switch ( v15 )
  {
    case 0x7FFFFFFF:
      BootPrintf("Invalid LaunchData timestamp (positive overflow), ignored!");
      goto LABEL_31;
    case 0x80000000:
      BootPrintf("Invalid LaunchData timestamp (negative overflow), ignored!");
      goto LABEL_31;
    case 0:
      BootPrintf("Invalid Launchdata timestamp \"%s\", ignored!", v11);
      goto LABEL_31;
  }
  if ( v15 < 0 )
  {
    BootPrintf("Invalid LaunchData timestamp (negative time), ignored!");
    goto LABEL_31;
  }
LABEL_32:
  launchData->timestamp = v15;
  v16 = strstr_0(Str, "gamemode=");
  v17 = "null";
  if ( v16 )
  {
    v18 = v16 + 9;
    if ( *v18 != 10 )
      v17 = v18;
  }
  if ( !strncmp(v17, "NoMode", 6ui64) )
    goto LABEL_47;
  if ( !strncmp(v17, "SinglePlayer", 0xCui64) )
  {
    v3 = eGameModeSinglePlayer;
    goto LABEL_47;
  }
  if ( !strncmp(v17, "MultiPlayer", 0xBui64) )
  {
    v3 = eGameModeMultiPlayer;
    goto LABEL_47;
  }
  if ( !strncmp(v17, "Coop", 4ui64) )
  {
    v3 = eGameModeCoop;
    goto LABEL_47;
  }
  if ( strncmp(v17, "SysErrorGame", 0xCui64) )
  {
    if ( !strncmp(v17, "SysErrorBoot", 0xCui64) )
    {
      v3 = eErrorModeHandleAtBoot;
      goto LABEL_47;
    }
    BootError(eBootErrorLaunchData, "Bogus game mode \"%s\" in launch data", v17);
  }
  v3 = eFirstErrorMode;
LABEL_47:
  launchData->mode = v3;
  v19 = strstr_0(Str, "autobuild=");
  v20 = "null";
  if ( v19 )
  {
    v21 = v19 + 10;
    if ( *v21 != 10 )
      v20 = v21;
  }
  if ( !strncmp(v20, "true", 4ui64) )
  {
    v22 = 1;
  }
  else
  {
    if ( strncmp(v20, "false", 5ui64) )
      BootError(eBootErrorLaunchData, "Bogus boolean key \"%s\" in launch data", v20);
    v22 = 0;
  }
  launchData->isAutobuild = v22;
  v23 = strstr_0(Str, "skipmovies=");
  v24 = "null";
  if ( v23 )
  {
    v25 = v23 + 11;
    if ( *v25 != 10 )
      v24 = v25;
  }
  if ( !strncmp(v24, "true", 4ui64) )
  {
    v26 = 1;
  }
  else
  {
    if ( strncmp(v24, "false", 5ui64) )
      BootError(eBootErrorLaunchData, "Bogus boolean key \"%s\" in launch data", v24);
    v26 = 0;
  }
  launchData->skipMovies = v26;
  v27 = strstr_0(Str, "errorcat=");
  v28 = "null";
  if ( v27 )
  {
    v29 = v27 + 9;
    if ( *v29 != 10 )
      v28 = v29;
  }
  if ( j_sscanf(v28, "%x", &Stream) > 0 )
  {
    v30 = strstr_0(Str, "errorcode=");
    v31 = "null";
    if ( v30 )
    {
      v32 = v30 + 10;
      if ( *v32 != 10 )
        v31 = v32;
    }
    if ( j_sscanf(v31, "%llx", &v37) > 0 )
    {
      v33 = strstr_0(Str, "errortext=");
      if ( v33 )
      {
        v34 = v33 + 10;
        if ( *v34 != 10 )
          v10 = v34;
      }
      v35 = strchr_0(v10, 10);
      if ( v35 )
      {
        if ( (unsigned __int64)(v35 - v10 + 1) < 0x100 )
        {
          launchData->errorCat = (unsigned int)Stream;
          launchData->errorCode = v37;
          Core_strncpy(launchData->errorText, 0x100ui64, v10, v35 - v10);
        }
        else
        {
          BootPrintf("Invalid LaunchData errorText (too long)\n");
        }
        return 1;
      }
      else
      {
        BootPrintf("Invalid LaunchData errorText (missing terminator)\n");
        return 1;
      }
    }
    else
    {
      BootPrintf("Invalid LaunchData codeText '%s'\n", v31);
      return 1;
    }
  }
  else
  {
    BootPrintf("Invalid LaunchData catText '%s'\n", v28);
    return 1;
  }
}

/*
==============
XB3LaunchDataFileWrite
==============
*/
bool XB3LaunchDataFileWrite(const XB3LaunchData *launchData)
{
  bool v2; 
  EGameMode mode; 
  bool v4; 
  const char *v5; 
  unsigned int v6; 
  const char *v7; 
  const char *v8; 
  _iobuf *v9; 
  bool result; 
  FILE *Stream; 
  _FILETIME SystemTimeAsFileTime; 

  Stream = NULL;
  if ( fopen_s(&Stream, "T:\\boot.iw8launchdata", "wt") || !Stream )
  {
    BootPrintf("Failed to write to LaunchData file \"%s\" ", "T:\\boot.iw8launchdata");
    return 0;
  }
  else
  {
    v2 = BootCheckIsAutobuild();
    mode = launchData->mode;
    v4 = v2;
    switch ( mode )
    {
      case eFirstGameMode:
        v5 = "NoMode";
        goto LABEL_10;
      case eGameModeSinglePlayer:
        v5 = "SinglePlayer";
        goto LABEL_10;
      case eGameModeMultiPlayer:
        v5 = "MultiPlayer";
        goto LABEL_10;
      case eGameModeCoop:
        v5 = "Coop";
        goto LABEL_10;
      case eFirstErrorMode:
        v5 = "SysErrorGame";
        goto LABEL_10;
      case eErrorModeHandleAtBoot:
        v5 = "SysErrorBoot";
LABEL_10:
        GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
        v6 = FILETIME_to_TIMESTAMP(&SystemTimeAsFileTime);
        j_fprintf(Stream, "%s%ld\n", "timestamp=", v6);
        j_fprintf(Stream, "%s%s\n", "gamemode=", v5);
        v7 = "false";
        v8 = "false";
        if ( v4 )
          v8 = "true";
        j_fprintf(Stream, "%s%s\n", "autobuild=", v8);
        if ( launchData->skipMovies )
          v7 = "true";
        j_fprintf(Stream, "%s%s\n", "skipmovies=", v7);
        v9 = Stream;
        j_fprintf(Stream, "%s%x\n", "errorcat=", launchData->errorCat);
        j_fprintf(v9, "%s%llx\n", "errorcode=", launchData->errorCode);
        if ( strchr_0(launchData->errorText, 10) )
        {
          if ( CoreAssert_Handler("c:\\workspace\\iw8\\code_source\\src\\xb3\\xb3_application.cpp", 1433, ASSERT_TYPE_ASSERT, "(strchr( r_launchData.errorText, '\\n' ) == nullptr)", (const char *)&queryFormat, "strchr( r_launchData.errorText, '\\n' ) == nullptr") )
            __debugbreak();
        }
        j_fprintf(v9, "%s%s\n", "errortext=", launchData->errorText);
        j_fprintf(Stream, "%s%s", "startuptext=", launchData->startupText);
        fflush(Stream);
        fclose(Stream);
        result = 1;
        break;
      default:
        BootPrintf("Bogus game mode %d", (unsigned int)mode);
        result = 0;
        break;
    }
  }
  return result;
}

/*
==============
XB3LaunchDataFromProtocolActivation
==============
*/
char XB3LaunchDataFromProtocolActivation(XB3LaunchData *launchData)
{
  HSTRING v2; 
  Platform::String *v3; 
  HSTRING v4; 
  HSTRING v5; 
  Windows::Foundation::IUriRuntimeClass *v6; 
  Windows::Foundation::IUriRuntimeClass *v7; 
  int v8; 
  HSTRING v9; 
  int v10; 
  HSTRING v11; 
  int v12; 
  PCWSTR StringRawBuffer_0; 
  __int64 v14; 
  PCWSTR v15; 
  __int64 v16; 
  HSTRING v17; 
  HSTRING v18; 
  HSTRING v19; 
  __int64 v20; 
  HSTRING v21; 
  int v22; 
  int v23; 
  unsigned int v24; 
  HSTRING v25; 
  int v26; 
  int v27; 
  HSTRING v28; 
  HSTRING v29; 
  int v30; 
  HSTRING v31; 
  int v32; 
  HSTRING v33; 
  int v34; 
  int v35; 
  HSTRING v36; 
  int v37; 
  HSTRING v38; 
  int v39; 
  PCWSTR v40; 
  __int64 v41; 
  const wchar_t *v42; 
  unsigned __int64 v43; 
  PCWSTR v44; 
  __int64 v45; 
  wchar_t v46; 
  const wchar_t *v47; 
  unsigned __int64 v48; 
  PCWSTR v49; 
  __int64 v50; 
  unsigned __int64 v51; 
  Windows::Foundation::WwwFormUrlDecoder *v52; 
  __int64 v53; 
  __int64 v54; 
  int v55; 
  int v56; 
  unsigned int v57; 
  __int64 v58; 
  int v59; 
  int v60; 
  HSTRING v61; 
  HSTRING v62; 
  int v63; 
  HSTRING v64; 
  int v65; 
  HSTRING v66; 
  int v67; 
  int v68; 
  HSTRING v69; 
  int v70; 
  HSTRING v71; 
  int v72; 
  PCWSTR v73; 
  __int64 v74; 
  PCWSTR v75; 
  __int64 v76; 
  wchar_t v77; 
  const wchar_t *v78; 
  unsigned __int64 v79; 
  unsigned __int64 v80; 
  PCWSTR v81; 
  __int64 v82; 
  unsigned __int64 v83; 
  HSTRING v85; 
  unsigned int v86; 
  HSTRING v87; 
  XB3LaunchData *v88; 
  HSTRING v89; 
  HSTRING v90; 
  HSTRING v91; 
  INT32 result[2]; 
  HSTRING v93; 
  Windows::Foundation::IUriRuntimeClass *v94; 
  HSTRING v95; 
  HSTRING v96; 
  HSTRING string; 
  HSTRING v98; 
  HSTRING v99; 
  __int64 v100; 
  __int64 v101; 
  __int64 v102; 
  HSTRING newString; 
  HSTRING v104[3]; 
  char v105[256]; 
  char pDestBuffer[272]; 

  v104[1] = (HSTRING)-2i64;
  v88 = launchData;
  v85 = (HSTRING)launchData;
  memset_0(launchData, 0, sizeof(XB3LaunchData));
  launchData->skipMovies = 1;
  launchData->timestamp = 1;
  launchData->mode = eGameModeMultiPlayer;
  BootPrintf("XB3 TODO XB3LaunchDataFromProtocolActivation: Forcing game mode to eGameModeMultiPlayer! This needs to be fixed!");
  v94 = NULL;
  v2 = NULL;
  v93 = NULL;
  Platform::String::String(NULL, s_uri);
  v4 = (HSTRING)v3;
  v96 = (HSTRING)v3;
  Windows::Foundation::Uri::Uri(NULL, v3);
  v6 = (Windows::Foundation::IUriRuntimeClass *)v5;
  v90 = v5;
  if ( v5 )
  {
    (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v5 + 8i64))(v5);
    v94 = v6;
  }
  if ( v6 )
    v6->__abi_Release(v6);
  WindowsDeleteString_0(v4);
  string = NULL;
  v7 = v94;
  v8 = v94->__abi_get_Host(v94, (Platform::String **)&string);
  if ( v8 < 0 )
    __abi_WinRTraiseException(v8);
  v9 = string;
  if ( string )
  {
    v10 = WindowsDuplicateString_0(string, &newString);
    if ( v10 < 0 )
      __abi_WinRTraiseException(v10);
    v11 = newString;
    v9 = string;
  }
  else
  {
    v11 = NULL;
  }
  WindowsDeleteString_0(v9);
  v90 = v11;
  if ( v11 )
  {
    v93 = NULL;
    v12 = WindowsDuplicateString_0(v11, v104);
    if ( v12 < 0 )
      __abi_WinRTraiseException(v12);
    v2 = v104[0];
    v93 = v104[0];
  }
  WindowsDeleteString_0(v11);
  *(_WORD *)&launchData->fromInviteToActivitySession = 0;
  StringRawBuffer_0 = WindowsGetStringRawBuffer_0(v2, NULL);
  v14 = -1i64;
  while ( 1 )
  {
    if ( StringRawBuffer_0[v14 + 1] != aInvitehandleac[v14 + 1] )
    {
LABEL_17:
      v15 = WindowsGetStringRawBuffer_0(v2, NULL);
      v16 = -1i64;
      while ( v15[v16 + 1] == aActivityhandle_0[v16 + 1] )
      {
        v16 += 2i64;
        if ( v16 == 19 )
        {
          BootPrintf("XB3LaunchDataFromProtocolActivation:type activityHandleJoin.\n", 19i64, v15, L"activityHandleJoin", v85);
          launchData->fromJoinActivitySession = 1;
          v17 = NULL;
          v95 = NULL;
          v18 = NULL;
          *(_QWORD *)result = 0i64;
          v52 = Windows::Foundation::IUriRuntimeClass::QueryParsed::get(v7);
          v53 = (__int64)v52;
          v102 = (__int64)v52;
          if ( v52 )
            v52->__abi_AddRef(v52);
          v102 = v53;
          if ( v53 )
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v53 + 16i64))(v53);
          v54 = 0i64;
          v87 = NULL;
          if ( v53 )
          {
            v55 = (**(__int64 (__fastcall ***)(__int64, void *, HSTRING *))v53)(v53, &_uuidof__AU__IVectorView_PE_AAUIWwwFormUrlDecoderEntry_Foundation_Windows___Collections_Foundation_Windows__, &v87);
            if ( v55 < 0 )
              __abi_WinRTraiseException(v55);
            v54 = (__int64)v87;
          }
          v101 = v54;
          v56 = (*(__int64 (__fastcall **)(__int64, unsigned int *))(*(_QWORD *)v54 + 56i64))(v54, &v86);
          if ( v56 < 0 )
            __abi_WinRTraiseException(v56);
          (*(void (__fastcall **)(__int64))(*(_QWORD *)v54 + 16i64))(v54);
          v57 = 0;
          if ( v86 )
          {
            do
            {
              v58 = 0i64;
              v87 = NULL;
              if ( v53 )
              {
                v59 = (**(__int64 (__fastcall ***)(__int64, void *, HSTRING *))v53)(v53, &_uuidof__AU__IVectorView_PE_AAUIWwwFormUrlDecoderEntry_Foundation_Windows___Collections_Foundation_Windows__, &v87);
                if ( v59 < 0 )
                  __abi_WinRTraiseException(v59);
                v58 = (__int64)v87;
              }
              v101 = v58;
              v85 = NULL;
              v60 = (*(__int64 (__fastcall **)(__int64, _QWORD, HSTRING *))(*(_QWORD *)v58 + 48i64))(v58, v57, &v85);
              if ( v60 < 0 )
                __abi_WinRTraiseException(v60);
              v61 = v85;
              v62 = v85;
              if ( v85 )
              {
                (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v85 + 8i64))(v85);
                v61 = v85;
              }
              if ( v61 )
                (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v61 + 16i64))(v61);
              v100 = (__int64)v62;
              if ( v62 )
                (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v62 + 8i64))(v62);
              v100 = (__int64)v62;
              if ( v62 )
                (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v62 + 16i64))(v62);
              (*(void (__fastcall **)(__int64))(*(_QWORD *)v58 + 16i64))(v58);
              v89 = NULL;
              v63 = (*(__int64 (__fastcall **)(HSTRING, HSTRING *))(*(_QWORD *)v62 + 48i64))(v62, &v89);
              if ( v63 < 0 )
                __abi_WinRTraiseException(v63);
              v64 = v89;
              if ( v89 )
              {
                v65 = WindowsDuplicateString_0(v89, &v90);
                if ( v65 < 0 )
                  __abi_WinRTraiseException(v65);
                v66 = v90;
                v64 = v89;
              }
              else
              {
                v66 = NULL;
              }
              WindowsDeleteString_0(v64);
              v87 = v66;
              if ( v17 != v66 )
              {
                if ( v17 )
                  WindowsDeleteString_0(v17);
                v17 = NULL;
                v95 = NULL;
                if ( v66 )
                {
                  v67 = WindowsDuplicateString_0(v66, &v96);
                  if ( v67 < 0 )
                    __abi_WinRTraiseException(v67);
                  v17 = v96;
                  v95 = v96;
                }
              }
              WindowsDeleteString_0(v66);
              v91 = NULL;
              v68 = (*(__int64 (__fastcall **)(HSTRING, HSTRING *))(*(_QWORD *)v62 + 56i64))(v62, &v91);
              if ( v68 < 0 )
                __abi_WinRTraiseException(v68);
              v69 = v91;
              if ( v91 )
              {
                v70 = WindowsDuplicateString_0(v91, &v99);
                if ( v70 < 0 )
                  __abi_WinRTraiseException(v70);
                v71 = v99;
                v69 = v91;
              }
              else
              {
                v71 = NULL;
              }
              WindowsDeleteString_0(v69);
              v87 = v71;
              if ( v18 != v71 )
              {
                if ( v18 )
                  WindowsDeleteString_0(v18);
                v18 = NULL;
                *(_QWORD *)result = 0i64;
                if ( v71 )
                {
                  v72 = WindowsDuplicateString_0(v71, &v98);
                  if ( v72 < 0 )
                    __abi_WinRTraiseException(v72);
                  v18 = v98;
                  *(_QWORD *)result = v98;
                }
              }
              WindowsDeleteString_0(v71);
              memset_0(v105, 0, sizeof(v105));
              memset_0(pDestBuffer, 0, 0x100ui64);
              ConvertPlatformStringToCharArray((Platform::String *)v17, v105, 0x100ui64);
              ConvertPlatformStringToCharArray((Platform::String *)v18, pDestBuffer, 0x100ui64);
              BootPrintf("activityHandleJoin data: entry [%d] name [%s] value [%s].\n", v57, v105, pDestBuffer);
              v73 = WindowsGetStringRawBuffer_0(v17, NULL);
              v74 = -1i64;
              do
              {
                if ( v73[v74 + 1] != aJoinerxuid[v74 + 1] )
                  break;
                v74 += 2i64;
                if ( v74 == 11 )
                {
                  v80 = XuidFromXboxUserId((Platform::String *)v18);
                  v88->myXuid = v80;
                  goto LABEL_151;
                }
              }
              while ( v73[v74] == aJoinerxuid[v74] );
              v75 = WindowsGetStringRawBuffer_0(v17, NULL);
              v76 = 0i64;
              while ( 1 )
              {
                v77 = v75[v76++];
                if ( v77 != aHandle_2[v76 - 1] )
                  break;
                if ( v76 == 7 )
                {
                  v78 = WindowsGetStringRawBuffer_0(v18, NULL);
                  v79 = -1i64;
                  do
                    ++v79;
                  while ( v78[v79] );
                  std::wstring::assign(&v88->sessionHandleId, v78, v79);
                  goto LABEL_151;
                }
              }
              v81 = WindowsGetStringRawBuffer_0(v17, NULL);
              v82 = -1i64;
              while ( v81[v82 + 1] == aJoineexuid[v82 + 1] )
              {
                v82 += 2i64;
                if ( v82 == 11 )
                {
                  v83 = XuidFromXboxUserId((Platform::String *)v18);
                  v88->theirXuid = v83;
                  break;
                }
                if ( v81[v82] != aJoineexuid[v82] )
                  break;
              }
LABEL_151:
              (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v62 + 16i64))(v62);
              ++v57;
            }
            while ( v57 < v86 );
            v7 = v94;
          }
          if ( v53 )
            (*(void (__fastcall **)(__int64))(*(_QWORD *)v53 + 16i64))(v53);
          goto LABEL_155;
        }
        if ( v15[v16] != aActivityhandle_0[v16] )
          goto LABEL_156;
      }
      goto LABEL_156;
    }
    v14 += 2i64;
    if ( v14 == 19 )
      break;
    if ( StringRawBuffer_0[v14] != aInvitehandleac[v14] )
      goto LABEL_17;
  }
  BootPrintf("XB3LaunchDataFromProtocolActivation:type inviteHandleAccept.\n", 19i64, StringRawBuffer_0, L"inviteHandleAccept", v85);
  launchData->fromInviteToActivitySession = 1;
  v17 = NULL;
  v95 = NULL;
  v18 = NULL;
  v87 = NULL;
  v19 = (HSTRING)Windows::Foundation::IUriRuntimeClass::QueryParsed::get(v7);
  v20 = (__int64)v19;
  v90 = v19;
  if ( v19 )
    (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v19 + 8i64))(v19);
  v100 = v20;
  if ( v20 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v20 + 16i64))(v20);
  v21 = NULL;
  v85 = NULL;
  if ( v20 )
  {
    v22 = (**(__int64 (__fastcall ***)(__int64, void *, HSTRING *))v20)(v20, &_uuidof__AU__IVectorView_PE_AAUIWwwFormUrlDecoderEntry_Foundation_Windows___Collections_Foundation_Windows__, &v85);
    if ( v22 < 0 )
      __abi_WinRTraiseException(v22);
    v21 = v85;
  }
  v90 = v21;
  v23 = (*(__int64 (__fastcall **)(HSTRING, unsigned int *))(*(_QWORD *)v21 + 56i64))(v21, &v86);
  if ( v23 < 0 )
    __abi_WinRTraiseException(v23);
  (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v21 + 16i64))(v21);
  v24 = 0;
  if ( v86 )
  {
    do
    {
      v25 = NULL;
      v85 = NULL;
      if ( v20 )
      {
        v26 = (**(__int64 (__fastcall ***)(__int64, void *, HSTRING *))v20)(v20, &_uuidof__AU__IVectorView_PE_AAUIWwwFormUrlDecoderEntry_Foundation_Windows___Collections_Foundation_Windows__, &v85);
        if ( v26 < 0 )
          __abi_WinRTraiseException(v26);
        v25 = v85;
      }
      v101 = (__int64)v25;
      v91 = NULL;
      v27 = (*(__int64 (__fastcall **)(HSTRING, _QWORD, HSTRING *))(*(_QWORD *)v25 + 48i64))(v25, v24, &v91);
      if ( v27 < 0 )
        __abi_WinRTraiseException(v27);
      v28 = v91;
      v29 = v91;
      if ( v91 )
      {
        (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v91 + 8i64))(v91);
        v28 = v91;
      }
      if ( v28 )
        (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v28 + 16i64))(v28);
      v89 = v29;
      if ( v29 )
        (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v29 + 8i64))(v29);
      *(_QWORD *)result = v29;
      if ( v29 )
        (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v29 + 16i64))(v29);
      (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v25 + 16i64))(v25);
      v89 = NULL;
      v30 = (*(__int64 (__fastcall **)(HSTRING, HSTRING *))(*(_QWORD *)v29 + 48i64))(v29, &v89);
      if ( v30 < 0 )
        __abi_WinRTraiseException(v30);
      v31 = v89;
      if ( v89 )
      {
        v32 = WindowsDuplicateString_0(v89, &v98);
        if ( v32 < 0 )
          __abi_WinRTraiseException(v32);
        v33 = v98;
        v31 = v89;
      }
      else
      {
        v33 = NULL;
      }
      WindowsDeleteString_0(v31);
      v85 = v33;
      if ( v17 != v33 )
      {
        if ( v17 )
          WindowsDeleteString_0(v17);
        v17 = NULL;
        v95 = NULL;
        if ( v33 )
        {
          v34 = WindowsDuplicateString_0(v33, &v99);
          if ( v34 < 0 )
            __abi_WinRTraiseException(v34);
          v17 = v99;
          v95 = v99;
        }
      }
      WindowsDeleteString_0(v33);
      v85 = NULL;
      v35 = (*(__int64 (__fastcall **)(HSTRING, HSTRING *))(*(_QWORD *)v29 + 56i64))(v29, &v85);
      if ( v35 < 0 )
        __abi_WinRTraiseException(v35);
      v36 = v85;
      if ( v85 )
      {
        v37 = WindowsDuplicateString_0(v85, &v96);
        if ( v37 < 0 )
          __abi_WinRTraiseException(v37);
        v38 = v96;
        v36 = v85;
      }
      else
      {
        v38 = NULL;
      }
      WindowsDeleteString_0(v36);
      v102 = (__int64)v38;
      if ( v18 != v38 )
      {
        if ( v18 )
          WindowsDeleteString_0(v18);
        v18 = NULL;
        v87 = NULL;
        if ( v38 )
        {
          v39 = WindowsDuplicateString_0(v38, &v90);
          if ( v39 < 0 )
            __abi_WinRTraiseException(v39);
          v18 = v90;
          v87 = v90;
        }
      }
      WindowsDeleteString_0(v38);
      memset_0(pDestBuffer, 0, 0x100ui64);
      memset_0(v105, 0, sizeof(v105));
      ConvertPlatformStringToCharArray((Platform::String *)v17, pDestBuffer, 0x100ui64);
      ConvertPlatformStringToCharArray((Platform::String *)v18, v105, 0x100ui64);
      BootPrintf("inviteHandleAccept data: entry [%d] name [%s] value [%s].\n", v24, pDestBuffer, v105);
      v40 = WindowsGetStringRawBuffer_0(v17, NULL);
      v41 = 0i64;
      while ( v40[v41] == aInvitedxuid[v41] && v40[v41 + 1] == aInvitedxuid[v41 + 1] )
      {
        v41 += 2i64;
        if ( v41 == 12 )
        {
          result[0] = 0;
          WindowsCompareStringOrdinal_0(v18, NULL, result);
          if ( result[0] )
          {
            v42 = WindowsGetStringRawBuffer_0(v18, NULL);
            v43 = _wcstoui64(v42, NULL, 10);
            if ( v43 == -1i64 )
              v43 = 0i64;
            v88->myXuid = v43;
          }
          else
          {
            v88->myXuid = 0i64;
          }
          goto LABEL_86;
        }
      }
      v44 = WindowsGetStringRawBuffer_0(v17, NULL);
      v45 = 0i64;
      while ( 1 )
      {
        v46 = v44[v45++];
        if ( v46 != aHandle_2[v45 - 1] )
          break;
        if ( v45 == 7 )
        {
          v47 = WindowsGetStringRawBuffer_0(v18, NULL);
          v48 = -1i64;
          do
            ++v48;
          while ( v47[v48] );
          std::wstring::assign(&v88->sessionHandleId, v47, v48);
          goto LABEL_86;
        }
      }
      v49 = WindowsGetStringRawBuffer_0(v17, NULL);
      v50 = -1i64;
      while ( v49[v50 + 1] == aSenderxuid[v50 + 1] )
      {
        v50 += 2i64;
        if ( v50 == 11 )
        {
          v51 = XuidFromXboxUserId((Platform::String *)v18);
          v88->theirXuid = v51;
          break;
        }
        if ( v49[v50] != aSenderxuid[v50] )
          break;
      }
LABEL_86:
      (*(void (__fastcall **)(HSTRING))(*(_QWORD *)v29 + 16i64))(v29);
      ++v24;
    }
    while ( v24 < v86 );
    v7 = v94;
  }
  if ( v20 )
    (*(void (__fastcall **)(__int64))(*(_QWORD *)v20 + 16i64))(v20);
LABEL_155:
  WindowsDeleteString_0(v18);
  WindowsDeleteString_0(v17);
  v2 = v93;
LABEL_156:
  WindowsDeleteString_0(v2);
  v7->__abi_Release(v7);
  return 1;
}

/*
==============
XB3LaunchDataValidateTimeStamp
==============
*/
char XB3LaunchDataValidateTimeStamp(const int timeStamp)
{
  int v2; 
  int v4; 
  _FILETIME SystemTimeAsFileTime; 

  if ( !timeStamp )
    return 0;
  GetSystemTimeAsFileTime(&SystemTimeAsFileTime);
  v2 = FILETIME_to_TIMESTAMP(&SystemTimeAsFileTime);
  if ( v2 < timeStamp )
  {
    BootPrintf("Launchdata more current than current FILETIME, ignored!");
    return 0;
  }
  v4 = v2 - timeStamp;
  if ( v4 <= 60 )
    return 1;
  BootPrintf("Launchdata expired (%lld seconds), ignored!", (unsigned int)v4);
  return 0;
}

/*
==============
XuidFromXboxUserId
==============
*/
unsigned __int64 XuidFromXboxUserId(Platform::String *aXboxUserId)
{
  unsigned __int64 v2; 
  const wchar_t *StringRawBuffer_0; 
  INT32 result; 

  result = 0;
  WindowsCompareStringOrdinal_0((HSTRING)aXboxUserId, NULL, &result);
  if ( !result )
    return 0i64;
  StringRawBuffer_0 = WindowsGetStringRawBuffer_0((HSTRING)aXboxUserId, NULL);
  v2 = _wcstoui64(StringRawBuffer_0, NULL, 10);
  if ( v2 == -1i64 )
    return 0i64;
  return v2;
}

